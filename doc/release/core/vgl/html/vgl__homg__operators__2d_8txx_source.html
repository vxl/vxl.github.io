<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>core/vgl/algo/vgl_homg_operators_2d.txx Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">core/vgl/algo/vgl_homg_operators_2d.txx</div>  </div>
</div>
<div class="contents">
<a href="vgl__homg__operators__2d_8txx.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is core/vgl/algo/vgl_homg_operators_2d.txx</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef vgl_homg_operators_2d_txx_</span>
<a name="l00003"></a><a class="code" href="vgl__homg__operators__2d_8txx.html#a3e47ca1855a60a232517b1b6b4ce7d7b">00003</a> <span class="preprocessor"></span><span class="preprocessor">#define vgl_homg_operators_2d_txx_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="comment">//:</span>
<a name="l00005"></a>00005 <span class="comment">// \file</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;<a class="code" href="vgl__homg__operators__2d_8h.html" title="2D homogeneous operations">vgl_homg_operators_2d.h</a>&quot;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;vcl_iostream.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;vcl_limits.h&gt;</span> <span class="comment">// for infinity</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;vcl_cassert.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;vcl_cmath.h&gt;</span> <span class="comment">// for vcl_sqrt()</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__line__2d_8h.html" title="line in projective 2D space">vgl/vgl_homg_line_2d.h</a>&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__point__2d_8h.html" title="point in projective 2D space">vgl/vgl_homg_point_2d.h</a>&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;<a class="code" href="vgl__point__2d_8h.html" title="a point in 2D nonhomogeneous space">vgl/vgl_point_2d.h</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;<a class="code" href="vgl__conic_8h.html" title="A quadratic plane curve.">vgl/vgl_conic.h</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;<a class="code" href="vgl__box__2d_8h.html" title="Contains class to represent a cartesian 2D bounding box.">vgl/vgl_box_2d.h</a>&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg_8h.html" title="General purpose support class for vgl_homg_ classes.">vgl/vgl_homg.h</a>&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;vnl/vnl_vector_fixed.h&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;vnl/vnl_matrix.h&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;vnl/vnl_matrix_fixed.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;vnl/vnl_math.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;vnl/algo/vnl_scatter_3x3.h&gt;</span> <span class="comment">// used in most_orthogonal_vector()</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;vnl/algo/vnl_real_eigensystem.h&gt;</span> <span class="comment">// used for conic intersection</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;vnl/vnl_diag_matrix.h&gt;</span>  <span class="comment">// used for conic intersection</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00031"></a>00031 <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> cross(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p1,
<a name="l00032"></a>00032                                         <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p2)
<a name="l00033"></a>00033 {
<a name="l00034"></a>00034   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> (p1.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() - p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(),
<a name="l00035"></a>00035                               p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() - p1.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>(),
<a name="l00036"></a>00036                               p1.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() - p1.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>());
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00040"></a>00040 <span class="keyword">inline</span> <span class="keyword">static</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> cross(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; l1,
<a name="l00041"></a>00041                                          <span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; l2)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> (l1.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>() * l2.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>() - l1.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>() * l2.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>(),
<a name="l00044"></a>00044                                l1.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>() * l2.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>() - l1.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>() * l2.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(),
<a name="l00045"></a>00045                                l1.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>() * l2.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>() - l1.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>() * l2.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>());
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00049"></a>00049 <span class="keyword">inline</span> <span class="keyword">static</span> T <a class="code" href="vgl__homg__operators__3d_8txx.html#a399c075004b82438b08784ba9a9de36a">dot</a>(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00050"></a>00050                     <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052   <span class="keywordflow">return</span> l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() + l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() + l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00058"></a><a class="code" href="classvgl__homg__operators__2d.html#ad191ac31db355a92291f4c81af2f2608">00058</a> vnl_vector_fixed&lt;T,3&gt; <a class="code" href="classvgl__homg__operators__2d.html#ad191ac31db355a92291f4c81af2f2608" title="get a vnl_vector_fixed representation of a homogeneous object.">vgl_homg_operators_2d&lt;T&gt;::get_vector</a>(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060   <span class="keywordflow">return</span> vnl_vector_fixed&lt;T,3&gt;(p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(),p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(),p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>());
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00064"></a><a class="code" href="classvgl__homg__operators__2d.html#acf5a2692b51db586f1ab3885724b0887">00064</a> vnl_vector_fixed&lt;T,3&gt; <a class="code" href="classvgl__homg__operators__2d.html#ad191ac31db355a92291f4c81af2f2608" title="get a vnl_vector_fixed representation of a homogeneous object.">vgl_homg_operators_2d&lt;T&gt;::get_vector</a>(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l)
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066   <span class="keywordflow">return</span> vnl_vector_fixed&lt;T,3&gt;(l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>(),l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>(),l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>());
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00070"></a><a class="code" href="classvgl__homg__operators__2d.html#aa83880a5589570266e7db40d2ced156b">00070</a> vnl_vector_fixed&lt;T,6&gt; <a class="code" href="classvgl__homg__operators__2d.html#ad191ac31db355a92291f4c81af2f2608" title="get a vnl_vector_fixed representation of a homogeneous object.">vgl_homg_operators_2d&lt;T&gt;::get_vector</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   vnl_vector_fixed&lt;T,6&gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00073"></a>00073   v.put(0,c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>());
<a name="l00074"></a>00074   v.put(1,c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>());
<a name="l00075"></a>00075   v.put(2,c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>());
<a name="l00076"></a>00076   v.put(3,c.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>());
<a name="l00077"></a>00077   v.put(4,c.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>());
<a name="l00078"></a>00078   v.put(5,c.<a class="code" href="classvgl__conic.html#abd1ab7e73359f1ccc4b2a64f3e043a03" title="Returns the coefficient of .">f</a>());
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00084"></a>00084 <span class="comment">//: Normalize vgl_homg_point_2d&lt;T&gt; to unit magnitude</span>
<a name="l00085"></a>00085 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00086"></a><a class="code" href="classvgl__homg__operators__2d.html#a00e75edf19c5e7fc653e9bccb6ba7420">00086</a> <span class="keywordtype">void</span> <a class="code" href="classvgl__homg__operators__2d.html#a00e75edf19c5e7fc653e9bccb6ba7420" title="Normalize vgl_homg_point_2d&lt;T&gt; to unit magnitude.">vgl_homg_operators_2d&lt;T&gt;::unitize</a>(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; a)
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088   <span class="keywordtype">double</span> norm = vcl_sqrt (a.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()*a.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() + a.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()*a.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() + a.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*a.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>());
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="keywordflow">if</span> (norm == 0.0) {
<a name="l00091"></a>00091     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vgl_homg_operators_2d&lt;T&gt;::unitize() -- Zero length vector\n&quot;</span>;
<a name="l00092"></a>00092     <span class="keywordflow">return</span>;
<a name="l00093"></a>00093   }
<a name="l00094"></a>00094   norm = 1.0/norm;
<a name="l00095"></a>00095   a.<a class="code" href="classvgl__homg__point__2d.html#ad09a7a39599211ec304cfcaa3e98ff17" title="Set x,y,w.">set</a>(T(a.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()*norm), T(a.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()*norm), T(a.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*norm));
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="comment">//  DISTANCE MEASUREMENTS IN EUCLIDEAN COORDINATES</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00101"></a>00101 T
<a name="l00102"></a><a class="code" href="classvgl__homg__operators__2d.html#acbd245e575f8f7eb6bc4b30702ea2e4a">00102</a> <a class="code" href="classvgl__homg__operators__2d.html#acbd245e575f8f7eb6bc4b30702ea2e4a" title="Get the 2D distance between the two points.">vgl_homg_operators_2d&lt;T&gt;::distance</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; point1,
<a name="l00103"></a>00103                                    <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; point2)
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105   <span class="keywordflow">return</span> vcl_sqrt(<a class="code" href="classvgl__homg__operators__2d.html" title="2D homogeneous operations.">vgl_homg_operators_2d&lt;T&gt;::distance_squared</a>(point1,point2));
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00109"></a>00109 T
<a name="l00110"></a><a class="code" href="classvgl__homg__operators__2d.html#a85246601d0347ab7d46a9ac6d8b4ddb5">00110</a> <a class="code" href="classvgl__homg__operators__2d.html#a85246601d0347ab7d46a9ac6d8b4ddb5" title="Get the square of the 2D distance between the two points.">vgl_homg_operators_2d&lt;T&gt;::distance_squared</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p1,
<a name="l00111"></a>00111                                            <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p2)
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113   <span class="keywordflow">if</span> (p1 == p2) <span class="keywordflow">return</span> T(0); <span class="comment">// quick return if possible</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() == 0 || p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() == 0) {
<a name="l00116"></a>00116     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vgl_homg_operators_2d&lt;T&gt;::distance_squared() -- point at infinity\n&quot;</span>;
<a name="l00117"></a>00117     <span class="keywordflow">return</span> vcl_numeric_limits&lt;T&gt;::infinity();
<a name="l00118"></a>00118   }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="keywordflow">return</span> vnl_math_sqr (p1.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() / p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() - p2.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() / p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()) +
<a name="l00121"></a>00121          vnl_math_sqr (p1.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() / p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() - p2.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() / p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>());
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 <span class="comment">//: Get the square of the perpendicular distance to a line.</span>
<a name="l00125"></a>00125 <span class="comment">// This is just the homogeneous form of the familiar</span>
<a name="l00126"></a>00126 <span class="comment">// \f$ \frac{a x + b y + c}{\sqrt{a^2+b^2}} \f$ :</span>
<a name="l00127"></a>00127 <span class="comment">// \f[ d = \frac{(l^\top p)}{p_z\sqrt{l_x^2 + l_y^2}} \f]</span>
<a name="l00128"></a>00128 <span class="comment">// If either the point or the line are at infinity an error message is</span>
<a name="l00129"></a>00129 <span class="comment">// printed and vgl_homg::infinity is returned.</span>
<a name="l00130"></a>00130 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00131"></a>00131 T
<a name="l00132"></a><a class="code" href="classvgl__homg__operators__2d.html#ab32305558e374360c026cd35305d316d">00132</a> <a class="code" href="classvgl__homg__operators__2d.html#ab32305558e374360c026cd35305d316d" title="Get the square of the perpendicular distance to a line.">vgl_homg_operators_2d&lt;T&gt;::perp_dist_squared</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; point,
<a name="l00133"></a>00133                                             <span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line)
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135   <span class="keywordflow">if</span> ((line.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()==0 &amp;&amp; line.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()== 0) || point.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()==0) {
<a name="l00136"></a>00136     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vgl_homg_operators_2d&lt;T&gt;::perp_dist_squared() -- line or point at infinity\n&quot;</span>;
<a name="l00137"></a>00137     <span class="keywordflow">return</span> <a class="code" href="classvgl__homg.html" title="General purpose support class for vgl_homg_ classes.">vgl_homg&lt;T&gt;::infinity</a>;
<a name="l00138"></a>00138   }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140   T numerator = vnl_math_sqr (<a class="code" href="vgl__homg__operators__3d_8txx.html#a399c075004b82438b08784ba9a9de36a">dot</a>(line,point) / point.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>());
<a name="l00141"></a>00141   <span class="keywordflow">if</span> (numerator == 0) <span class="keywordflow">return</span> T(0); <span class="comment">// efficiency</span>
<a name="l00142"></a>00142   T denominator = line.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*line.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>() + line.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*line.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>();
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="keywordflow">return</span> numerator / denominator;
<a name="l00145"></a>00145 }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 <span class="comment">//  ANGLES</span>
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00150"></a>00150 <span class="comment">//: Get the anticlockwise angle between a line and the \a x axis.</span>
<a name="l00151"></a>00151 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00152"></a>00152 <span class="keywordtype">double</span>
<a name="l00153"></a><a class="code" href="classvgl__homg__operators__2d.html#a9a948324f27d9853a3773b774d8377f4">00153</a> <a class="code" href="classvgl__homg__operators__2d.html#a9a948324f27d9853a3773b774d8377f4" title="Get the anticlockwise angle between a line and the x axis.">vgl_homg_operators_2d&lt;T&gt;::line_angle</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line)
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155   <span class="keywordflow">return</span> vcl_atan2 (line.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>(), line.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>());
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00159"></a>00159 <span class="comment">//: Get the 0 to pi/2 angle between two lines</span>
<a name="l00160"></a>00160 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00161"></a>00161 <span class="keywordtype">double</span>
<a name="l00162"></a><a class="code" href="classvgl__homg__operators__2d.html#a4ceee6fe4dcc04382fcf1ce4dc13e83d">00162</a> <a class="code" href="classvgl__homg__operators__2d.html#a4ceee6fe4dcc04382fcf1ce4dc13e83d" title="Get the 0 to pi/2 angle between two lines.">vgl_homg_operators_2d&lt;T&gt;::abs_angle</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line1,
<a name="l00163"></a>00163                                     <span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line2)
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165   <span class="keywordtype">double</span> angle1 = line_angle(line1);
<a name="l00166"></a>00166   <span class="keywordtype">double</span> angle2 = line_angle(line2);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   <span class="keywordtype">double</span> diff = angle2 - angle1;
<a name="l00169"></a>00169   <span class="keywordflow">if</span> (diff &gt;  vnl_math::pi_over_2) diff -= vnl_math::pi;
<a name="l00170"></a>00170   <span class="keywordflow">if</span> (diff &lt; -vnl_math::pi_over_2) diff += vnl_math::pi;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="keywordflow">return</span> vcl_fabs(diff);
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00176"></a>00176 <span class="comment">//</span>
<a name="l00177"></a>00177 <span class="comment">//: Get the angle between two lines, a number between -PI and PI.</span>
<a name="l00178"></a>00178 <span class="comment">// Although homogeneous coordinates are</span>
<a name="l00179"></a>00179 <span class="comment">// only defined up to scale, here it is assumed that a line with homogeneous</span>
<a name="l00180"></a>00180 <span class="comment">// coordinates (m) is at 180 degrees to a line (-m), and this is why the term</span>
<a name="l00181"></a>00181 <span class="comment">// &quot;oriented_line&quot; is used.  However, the overall scale (apart from sign) is</span>
<a name="l00182"></a>00182 <span class="comment">// not significant.</span>
<a name="l00183"></a>00183 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00184"></a>00184 <span class="keywordtype">double</span>
<a name="l00185"></a><a class="code" href="classvgl__homg__operators__2d.html#a45920a25e4bc46de74964d12a9682c0d">00185</a> <a class="code" href="classvgl__homg__operators__2d.html#a45920a25e4bc46de74964d12a9682c0d" title="Get the angle between two lines, a number between -PI and PI.">vgl_homg_operators_2d&lt;T&gt;::angle_between_oriented_lines</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line1,
<a name="l00186"></a>00186                                                        <span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line2)
<a name="l00187"></a>00187 {
<a name="l00188"></a>00188   <span class="keywordflow">return</span> vcl_fmod(line_angle(line2)-line_angle(line1), 2*vnl_math::pi);
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">//  JOINS/INTERSECTIONS</span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00194"></a>00194 <span class="comment">//</span>
<a name="l00195"></a>00195 <span class="comment">//: Get the line through two points (the cross-product).</span>
<a name="l00196"></a>00196 <span class="comment">//</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00199"></a>00199 <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>
<a name="l00200"></a><a class="code" href="classvgl__homg__operators__2d.html#a8a57e38cb87a234c7e68047ac6c70fd7">00200</a> <a class="code" href="classvgl__homg__operators__2d.html#a8a57e38cb87a234c7e68047ac6c70fd7" title="Get the line through two points (the cross-product).">vgl_homg_operators_2d&lt;T&gt;::join</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p1,
<a name="l00201"></a>00201                                <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p2)
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203   <span class="keywordflow">return</span> cross(p1,p2);
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00207"></a>00207 <span class="comment">//</span>
<a name="l00208"></a>00208 <span class="comment">//: Get the line through two points (the cross-product).</span>
<a name="l00209"></a>00209 <span class="comment">// In this case, we assume that the points are oriented, and ensure the</span>
<a name="l00210"></a>00210 <span class="comment">// cross is computed with positive point omegas.</span>
<a name="l00211"></a>00211 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00212"></a>00212 <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>
<a name="l00213"></a><a class="code" href="classvgl__homg__operators__2d.html#a2b327cfdba4081372b3f9ef68b99d692">00213</a> <a class="code" href="classvgl__homg__operators__2d.html#a2b327cfdba4081372b3f9ef68b99d692" title="Get the line through two points (the cross-product).">vgl_homg_operators_2d&lt;T&gt;::join_oriented</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp;p1,
<a name="l00214"></a>00214                                         <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp;p2)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216   <span class="keywordtype">int</span> s1 = p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() &lt; 0;
<a name="l00217"></a>00217   <span class="keywordtype">int</span> s2 = p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() &lt; 0;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="keywordflow">if</span> (s1 ^ s2)
<a name="l00220"></a>00220     <span class="keywordflow">return</span> cross(p2,p1);
<a name="l00221"></a>00221   <span class="keywordflow">else</span>
<a name="l00222"></a>00222     <span class="keywordflow">return</span> cross(p1,p2);
<a name="l00223"></a>00223 }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00226"></a>00226 <span class="comment">//</span>
<a name="l00227"></a>00227 <span class="comment">//: Get the intersection point of two lines (the cross-product).</span>
<a name="l00228"></a>00228 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00229"></a>00229 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00230"></a><a class="code" href="classvgl__homg__operators__2d.html#a4a861961fb5d39005d442ca8754029b0">00230</a> <a class="code" href="classvgl__homg__operators__2d.html#a4a861961fb5d39005d442ca8754029b0" title="Get the intersection point of two lines (the cross-product).">vgl_homg_operators_2d&lt;T&gt;::intersection</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; l1,
<a name="l00231"></a>00231                                        <span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; l2)
<a name="l00232"></a>00232 {
<a name="l00233"></a>00233   <span class="keywordflow">return</span> cross(l1,l2);
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00237"></a>00237 <span class="comment">//</span>
<a name="l00238"></a>00238 <span class="comment">//: Get the perpendicular line to line which passes through point.</span>
<a name="l00239"></a>00239 <span class="comment">// Params are line \f$(a,b,c)\f$ and point \f$(x,y,1)\f$.</span>
<a name="l00240"></a>00240 <span class="comment">// Then the cross product of \f$(x,y,1)\f$ and the line&#39;s direction \f$(a,b,0)\f$,</span>
<a name="l00241"></a>00241 <span class="comment">// called \f$(p,q,r)\f$ satisfies</span>
<a name="l00242"></a>00242 <span class="comment">// - \f$ap+bq=0\f$ (perpendicular condition) and</span>
<a name="l00243"></a>00243 <span class="comment">// - \f$px+qy+r=0\f$ (incidence condition).</span>
<a name="l00244"></a>00244 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00245"></a>00245 <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>
<a name="l00246"></a><a class="code" href="classvgl__homg__operators__2d.html#a9c98ee30d310ab1bd0ea9083cf591333">00246</a> <a class="code" href="classvgl__homg__operators__2d.html#a9c98ee30d310ab1bd0ea9083cf591333" title="Get the perpendicular line to line which passes through point.">vgl_homg_operators_2d&lt;T&gt;::perp_line_through_point</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; l,
<a name="l00247"></a>00247                                                   <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p)
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249   <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> d(l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>(), l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>(), 0);
<a name="l00250"></a>00250   <span class="keywordflow">return</span> cross(d, p);
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00254"></a>00254 <span class="comment">//</span>
<a name="l00255"></a>00255 <span class="comment">//: Get the perpendicular projection of point onto line.</span>
<a name="l00256"></a>00256 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00257"></a>00257 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00258"></a><a class="code" href="classvgl__homg__operators__2d.html#a8a883f3b99ccf110f0d649f9e5ac19e7">00258</a> <a class="code" href="classvgl__homg__operators__2d.html#a8a883f3b99ccf110f0d649f9e5ac19e7" title="Get the perpendicular projection of point onto line.">vgl_homg_operators_2d&lt;T&gt;::perp_projection</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>&amp; line,
<a name="l00259"></a>00259                                           <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; point)
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261   <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> perpline = perp_line_through_point (line, point);
<a name="l00262"></a>00262   <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> answer = cross(line, perpline);
<a name="l00263"></a>00263   <span class="keywordflow">return</span> answer;
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">//: Return the midpoint of the line joining two homogeneous points</span>
<a name="l00267"></a>00267 <span class="comment">//  When one of the points is at infinity, that point is returned.</span>
<a name="l00268"></a>00268 <span class="comment">//  When both points are at infinity, the invalid point (0,0,0) is returned.</span>
<a name="l00269"></a>00269 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00270"></a>00270 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00271"></a><a class="code" href="classvgl__homg__operators__2d.html#a9e89b90bdd45bcf7de9a9243333ff957">00271</a> <a class="code" href="classvgl__homg__operators__2d.html#a9e89b90bdd45bcf7de9a9243333ff957" title="Return the midpoint of the line joining two homogeneous points.">vgl_homg_operators_2d&lt;T&gt;::midpoint</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p1,
<a name="l00272"></a>00272                                    <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; p2)
<a name="l00273"></a>00273 {
<a name="l00274"></a>00274   T x = p1.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() + p2.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>() * p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00275"></a>00275   T y = p1.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() + p2.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>() * p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00276"></a>00276   T w = p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() * p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() + p2.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() * p1.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00277"></a>00277 
<a name="l00278"></a>00278   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(x,y,w);
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">//  FITTING</span>
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">// - Kanatani sect 2.2.2.</span>
<a name="l00284"></a>00284 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00285"></a>00285 vnl_vector_fixed&lt;T,3&gt;
<a name="l00286"></a><a class="code" href="classvgl__homg__operators__2d.html#aff11fe6f2db6482ac7e0d42550b70b4c">00286</a> <a class="code" href="classvgl__homg__operators__2d.html#aff11fe6f2db6482ac7e0d42550b70b4c" title="compute most orthogonal vector with vnl_symmetric_eigensystem.">vgl_homg_operators_2d&lt;T&gt;::most_orthogonal_vector</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> &gt;&amp; inpoints)
<a name="l00287"></a>00287 {
<a name="l00288"></a>00288   vnl_scatter_3x3&lt;T&gt; scatter_matrix;
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   <span class="keywordflow">for</span> (<span class="keyword">typename</span> vcl_vector&lt;<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> &gt;::const_iterator i = inpoints.begin();
<a name="l00291"></a>00291        i != inpoints.end(); ++i)
<a name="l00292"></a>00292     scatter_matrix.add_outer_product(get_vector(*i));
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <span class="keywordflow">return</span> scatter_matrix.minimum_eigenvector();
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="preprocessor">#include &lt;vnl/algo/vnl_svd.h&gt;</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00300"></a>00300 vnl_vector_fixed&lt;T,3&gt;
<a name="l00301"></a><a class="code" href="classvgl__homg__operators__2d.html#a00a5a09b2ece62bfd064472244037a32">00301</a> <a class="code" href="classvgl__homg__operators__2d.html#a00a5a09b2ece62bfd064472244037a32" title="compute most orthogonal vector with SVD.">vgl_homg_operators_2d&lt;T&gt;::most_orthogonal_vector_svd</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> &gt;&amp; lines)
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303   vnl_matrix&lt;T&gt; D(lines.size(), 3);
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="keyword">typename</span> vcl_vector&lt;vgl_homg_line_2d&lt;T&gt; &gt;::const_iterator i = lines.begin();
<a name="l00306"></a>00306   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; i != lines.end(); ++i,++j)
<a name="l00307"></a>00307     D.set_row(j, get_vector(*i).as_ref());
<a name="l00308"></a>00308 
<a name="l00309"></a>00309   vnl_svd&lt;T&gt; svd(D);
<a name="l00310"></a>00310 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00311"></a>00311 <span class="preprocessor"></span>  vcl_cout &lt;&lt; <span class="stringliteral">&quot;[movrank &quot;</span> &lt;&lt; svd.W() &lt;&lt; <span class="charliteral">&#39;]&#39;</span>;
<a name="l00312"></a>00312 <span class="preprocessor">#endif</span>
<a name="l00313"></a>00313 <span class="preprocessor"></span>
<a name="l00314"></a>00314   <span class="keywordflow">return</span> svd.nullvector();
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 <span class="comment">//: Intersect a set of 2D lines to find the least-square point of intersection.</span>
<a name="l00318"></a>00318 <span class="comment">// This finds the point $\bf x$ that minimizes $\|\tt L \bf x\|$, where $\tt L$</span>
<a name="l00319"></a>00319 <span class="comment">// is the matrix whose rows are the lines. The implementation uses either</span>
<a name="l00320"></a>00320 <span class="comment">// vnl_scatter_3x3 (default) or vnl_svd (when at compile time</span>
<a name="l00321"></a>00321 <span class="comment">// VGL_HOMG_OPERATORS_2D_LINES_TO_POINT_USE_SVD has been set) to accumulate and</span>
<a name="l00322"></a>00322 <span class="comment">// compute the nullspace of $\tt L^\top \tt L$.</span>
<a name="l00323"></a>00323 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00324"></a>00324 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00325"></a><a class="code" href="classvgl__homg__operators__2d.html#aa3aab81c8da4e1af19bbcf4d967c9c65">00325</a> <a class="code" href="classvgl__homg__operators__2d.html#aa3aab81c8da4e1af19bbcf4d967c9c65" title="Intersect a set of 2D lines to find the least-square point of intersection.">vgl_homg_operators_2d&lt;T&gt;::lines_to_point</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> &gt;&amp; lines)
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327   <span class="comment">// ho_triveccam_aspect_lines_to_point</span>
<a name="l00328"></a>00328   assert(lines.size() &gt;= 2);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330 <span class="preprocessor">#ifdef VGL_HOMG_OPERATORS_2D_LINES_TO_POINT_USE_SVD</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span>  vnl_vector_fixed&lt;T,3&gt; mov = most_orthogonal_vector_svd(lines);
<a name="l00332"></a>00332 <span class="preprocessor">#else</span>
<a name="l00333"></a>00333 <span class="preprocessor"></span>  vnl_vector_fixed&lt;T,3&gt; mov = most_orthogonal_vector(lines);
<a name="l00334"></a>00334 <span class="preprocessor">#endif</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(mov[0], mov[1], mov[2]);
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="comment">//  MISCELLANEOUS</span>
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00341"></a>00341 <span class="comment">//: Calculates the crossratio of four collinear points p1, p2, p3 and p4.</span>
<a name="l00342"></a>00342 <span class="comment">// This number is projectively invariant, and it is the coordinate of p4</span>
<a name="l00343"></a>00343 <span class="comment">// in the reference frame where p2 is the origin (coordinate 0), p3 is</span>
<a name="l00344"></a>00344 <span class="comment">// the unity (coordinate 1) and p1 is the point at infinity.</span>
<a name="l00345"></a>00345 <span class="comment">// This cross ratio is often denoted as ((p1, p2; p3, p4)) (which also</span>
<a name="l00346"></a>00346 <span class="comment">// equals ((p3, p4; p1, p2)) or ((p2, p1; p4, p3)) or ((p4, p3; p2, p1)) )</span>
<a name="l00347"></a>00347 <span class="comment">// and is calculated as</span>
<a name="l00348"></a>00348 <span class="comment">// \verbatim</span>
<a name="l00349"></a>00349 <span class="comment">//                      p1 - p3   p2 - p3      (p1-p3)(p2-p4)</span>
<a name="l00350"></a>00350 <span class="comment">//                      ------- : --------  =  --------------</span>
<a name="l00351"></a>00351 <span class="comment">//                      p1 - p4   p2 - p4      (p1-p4)(p2-p3)</span>
<a name="l00352"></a>00352 <span class="comment">// \endverbatim</span>
<a name="l00353"></a>00353 <span class="comment">//</span>
<a name="l00354"></a>00354 <span class="comment">// In principle, any single nonhomogeneous coordinate from the four points</span>
<a name="l00355"></a>00355 <span class="comment">// can be used as parameters for cross_ratio (but of course the same for all</span>
<a name="l00356"></a>00356 <span class="comment">// points). The most reliable answer will be obtained when the coordinate with</span>
<a name="l00357"></a>00357 <span class="comment">// the largest spacing is used, i.e., the one with smallest slope.</span>
<a name="l00358"></a>00358 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00359"></a><a class="code" href="classvgl__homg__operators__2d.html#aa1669bb2a1a6caa636b404026ff9addf">00359</a> <span class="keywordtype">double</span> <a class="code" href="classvgl__homg__operators__2d.html#aa1669bb2a1a6caa636b404026ff9addf" title="cross ratio of four collinear points.">vgl_homg_operators_2d&lt;T&gt;::cross_ratio</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; a,
<a name="l00360"></a>00360                                              <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; b,
<a name="l00361"></a>00361                                              <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; c,
<a name="l00362"></a>00362                                              <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; d)
<a name="l00363"></a>00363 {
<a name="l00364"></a>00364   <span class="keywordtype">double</span> x1 = a.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y1 = a.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w1 = a.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00365"></a>00365   <span class="keywordtype">double</span> x2 = b.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y2 = b.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w2 = b.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00366"></a>00366   <span class="keywordtype">double</span> x3 = c.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y3 = c.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w3 = c.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00367"></a>00367   <span class="keywordtype">double</span> x4 = d.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y4 = d.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w4 = d.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00368"></a>00368   <span class="keywordtype">double</span> x = x1 - x2; <span class="keywordflow">if</span> (x&lt;0) x = -x; <span class="comment">// assuming a != b ;-)</span>
<a name="l00369"></a>00369   <span class="keywordtype">double</span> y = y1 - y2; <span class="keywordflow">if</span> (y&lt;0) y = -y;
<a name="l00370"></a>00370   <span class="keywordtype">double</span> n = (x&gt;y) ? (x1*w3-x3*w1)*(x2*w4-x4*w2) : (y1*w3-y3*w1)*(y2*w4-y4*w2);
<a name="l00371"></a>00371   <span class="keywordtype">double</span> m = (x&gt;y) ? (x1*w4-x4*w1)*(x2*w3-x3*w2) : (y1*w4-y4*w1)*(y2*w3-y3*w2);
<a name="l00372"></a>00372   <span class="keywordflow">if</span> (n == 0 &amp;&amp; m == 0)
<a name="l00373"></a>00373     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;cross ratio not defined: three of the given points coincide\n&quot;</span>;
<a name="l00374"></a>00374   <span class="keywordflow">return</span> n/m;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="comment">//: Conjugate point of three given collinear points.</span>
<a name="l00378"></a>00378 <span class="comment">// If cross ratio cr is given (default: -1), the generalized conjugate point</span>
<a name="l00379"></a>00379 <span class="comment">// returned is such that ((x1,x2;x3,answer)) = cr.</span>
<a name="l00380"></a>00380 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00381"></a>00381 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00382"></a><a class="code" href="classvgl__homg__operators__2d.html#a194e02bc5cd9a162662fa6e859249665">00382</a> <a class="code" href="classvgl__homg__operators__2d.html#a194e02bc5cd9a162662fa6e859249665" title="Conjugate point of three given collinear points.">vgl_homg_operators_2d&lt;T&gt;::conjugate</a>(<span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; a,
<a name="l00383"></a>00383                                     <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; b,
<a name="l00384"></a>00384                                     <span class="keyword">const</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>&amp; c,
<a name="l00385"></a>00385                                     <span class="keywordtype">double</span> cr)
<a name="l00386"></a>00386 <span class="comment">// Default for cr is -1.</span>
<a name="l00387"></a>00387 {
<a name="l00388"></a>00388   T x1 = a.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y1 = a.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w1 = a.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00389"></a>00389   T x2 = b.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y2 = b.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w2 = b.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00390"></a>00390   T x3 = c.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(), y3 = c.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(), w3 = c.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>();
<a name="l00391"></a>00391   T kx = x1*w3 - x3*w1, mx = x2*w3 - x3*w2, nx = T(kx*w2-cr*mx*w1);
<a name="l00392"></a>00392   T ky = y1*w3 - y3*w1, my = y2*w3 - y3*w2, ny = T(ky*w2-cr*my*w1);
<a name="l00393"></a>00393   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(T(x2*kx-cr*x1*mx)*ny,T(y2*ky-cr*y1*my)*nx,nx*ny);
<a name="l00394"></a>00394 }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="comment">//: returns the vgl_conic which has the given matrix as its matrix</span>
<a name="l00397"></a>00397 <span class="comment">// \verbatim</span>
<a name="l00398"></a>00398 <span class="comment">// [A,B,C,D,E,F] &lt;-   [ A  B/2 D/2 ]</span>
<a name="l00399"></a>00399 <span class="comment">//                    [ B/2 C  E/2 ]</span>
<a name="l00400"></a>00400 <span class="comment">//                    [ D/2 E/2 F  ]</span>
<a name="l00401"></a>00401 <span class="comment">// \endverbatim</span>
<a name="l00402"></a>00402 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00403"></a>00403 <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a>
<a name="l00404"></a><a class="code" href="classvgl__homg__operators__2d.html#a3d7967586606d7b8ad153b2216eb9468">00404</a> <a class="code" href="classvgl__homg__operators__2d.html#a3d7967586606d7b8ad153b2216eb9468" title="returns the vgl_conic which has the given matrix as its matrix.">vgl_homg_operators_2d&lt;T&gt;::vgl_conic_from_matrix</a>(vnl_matrix_fixed&lt;T,3,3&gt; <span class="keyword">const</span>&amp; mat)
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406   <span class="keywordflow">return</span> <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a>(mat[0][0], mat[1][0]+mat[0][1], mat[1][1], mat[0][2]+mat[2][0], mat[1][2]+mat[2][1], mat[2][2]);
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">//: returns 3x3 matrix containing conic coefficients.</span>
<a name="l00410"></a>00410 <span class="comment">// \verbatim</span>
<a name="l00411"></a>00411 <span class="comment">// [A,B,C,D,E,F] -&gt;   [ A  B/2 D/2 ]</span>
<a name="l00412"></a>00412 <span class="comment">//                    [ B/2 C  E/2 ]</span>
<a name="l00413"></a>00413 <span class="comment">//                    [ D/2 E/2 F  ]</span>
<a name="l00414"></a>00414 <span class="comment">// \endverbatim</span>
<a name="l00415"></a>00415 <span class="comment">//</span>
<a name="l00416"></a>00416 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00417"></a>00417 vnl_matrix_fixed&lt;T,3,3&gt;
<a name="l00418"></a><a class="code" href="classvgl__homg__operators__2d.html#a3cc990ef5481137947014535bf58e3ed">00418</a> <a class="code" href="classvgl__homg__operators__2d.html#a3cc990ef5481137947014535bf58e3ed" title="returns 3x3 matrix containing conic coefficients.">vgl_homg_operators_2d&lt;T&gt;::matrix_from_conic</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c)
<a name="l00419"></a>00419 {
<a name="l00420"></a>00420   vnl_matrix_fixed&lt;T,3,3&gt; mat;
<a name="l00421"></a>00421   T A = c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>(), B = c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()/2, C = c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>(), D = c.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>()/2, E = c.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>()/2, F = c.<a class="code" href="classvgl__conic.html#abd1ab7e73359f1ccc4b2a64f3e043a03" title="Returns the coefficient of .">f</a>();
<a name="l00422"></a>00422 
<a name="l00423"></a>00423   mat[0][0] = A; mat[0][1] = B; mat[0][2] = D;
<a name="l00424"></a>00424   mat[1][0] = B; mat[1][1] = C; mat[1][2] = E;
<a name="l00425"></a>00425   mat[2][0] = D; mat[2][1] = E; mat[2][2] = F;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427   <span class="keywordflow">return</span> mat;
<a name="l00428"></a>00428 }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="comment">//-------------------------------------------------------------------------</span>
<a name="l00431"></a>00431 <span class="comment">//: returns 3x3 matrix containing conic coefficients of dual conic.</span>
<a name="l00432"></a>00432 <span class="comment">// I.e., the inverse matrix (up to a scale factor) of the conic matrix.</span>
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00435"></a>00435 vnl_matrix_fixed&lt;T,3,3&gt;
<a name="l00436"></a><a class="code" href="classvgl__homg__operators__2d.html#ab1862660bb5efe3737714f1fecce572f">00436</a> <a class="code" href="classvgl__homg__operators__2d.html#ab1862660bb5efe3737714f1fecce572f" title="returns 3x3 matrix containing conic coefficients of dual conic.">vgl_homg_operators_2d&lt;T&gt;::matrix_from_dual_conic</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438   vnl_matrix_fixed&lt;T,3,3&gt; mat;
<a name="l00439"></a>00439   T A = c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>(), B = c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()/2, C = c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>(), D = c.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>()/2, E = c.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>()/2, F = c.<a class="code" href="classvgl__conic.html#abd1ab7e73359f1ccc4b2a64f3e043a03" title="Returns the coefficient of .">f</a>();
<a name="l00440"></a>00440 
<a name="l00441"></a>00441   mat[0][0] = C*F-E*E; mat[0][1] = E*D-B*F; mat[0][2] = B*E-C*D;
<a name="l00442"></a>00442   mat[1][0] = E*D-B*F; mat[1][1] = A*F-D*D; mat[1][2] = B*D-A*E;
<a name="l00443"></a>00443   mat[2][0] = B*E-C*D; mat[2][1] = B*D-A*E; mat[2][2] = A*C-B*B;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   <span class="keywordflow">return</span> mat;
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 <span class="comment">//:</span>
<a name="l00449"></a>00449 <span class="comment">// This function is called from within intersection(vgl_conic&lt;T&gt;,vgl_conic&lt;T&gt;).</span>
<a name="l00450"></a>00450 <span class="comment">// The two conics passed to this function MUST NOT be degenerate!</span>
<a name="l00451"></a>00451 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00452"></a>00452 vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;
<a name="l00453"></a><a class="code" href="classvgl__homg__operators__2d.html#a4f088354a301d661169bb52d3e5227ce">00453</a> <a class="code" href="classvgl__homg__operators__2d.html#a70551c35db89e5d53063c89f39746fef" title="This function is called from within intersection(vgl_conic&lt;T&gt;,vgl_homg_line_2d&lt;T&gt;).">vgl_homg_operators_2d&lt;T&gt;::do_intersect</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c1,
<a name="l00454"></a>00454                                        <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c2)
<a name="l00455"></a>00455 {
<a name="l00456"></a>00456   <span class="keywordflow">if</span> (c1==c2)
<a name="l00457"></a>00457   {
<a name="l00458"></a>00458     vcl_cerr &lt;&lt; __FILE__
<a name="l00459"></a>00459              &lt;&lt; <span class="stringliteral">&quot;Warning: the intersection of two identical conics is not a finite set of points.\n&quot;</span>
<a name="l00460"></a>00460              &lt;&lt; <span class="stringliteral">&quot;Returning an empty list.\n&quot;</span>;
<a name="l00461"></a>00461     <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;();
<a name="l00462"></a>00462   }
<a name="l00463"></a>00463   T A=c1.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>(),B=c1.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>(),C=c1.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>(),D=c1.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>(),E=c1.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>(),F=c1.<a class="code" href="classvgl__conic.html#abd1ab7e73359f1ccc4b2a64f3e043a03" title="Returns the coefficient of .">f</a>();
<a name="l00464"></a>00464   T a=c2.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>(),b=c2.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>(),c=c2.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>(),d=c2.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>(),e=c2.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>(),f=c2.<a class="code" href="classvgl__conic.html#abd1ab7e73359f1ccc4b2a64f3e043a03" title="Returns the coefficient of .">f</a>();
<a name="l00465"></a>00465   <span class="comment">// Idea: eliminate the coefficient in x^2, solve for x in terms of y, resubstitute in the other equation.</span>
<a name="l00466"></a>00466   T ab=a*B-A*b, ac=a*C-A*c, ad=a*D-A*d, ae=a*E-A*e, af=a*F-A*f, BD=b*D+B*d;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   <span class="comment">// If the quadratic parts of the two conics are identical (up to scale factor),</span>
<a name="l00469"></a>00469   <span class="comment">// the intersection is the same as with a degenerate conic where one part is the line at infinity,</span>
<a name="l00470"></a>00470   <span class="comment">// viz. the conic with as equation the (weighted) difference of the two equations;</span>
<a name="l00471"></a>00471   <span class="keywordflow">if</span> ((ab==0 &amp;&amp; ac==0)
<a name="l00472"></a>00472   <span class="comment">// If the parts without x of the two conics are identical (up to scale factor),</span>
<a name="l00473"></a>00473   <span class="comment">// the intersection is the same as with a degenerate conic consisting of two vertical lines;</span>
<a name="l00474"></a>00474       || (ab==0 &amp;&amp; ad==0)
<a name="l00475"></a>00475   <span class="comment">// And of course similarly for y:</span>
<a name="l00476"></a>00476       || (ab==0 &amp;&amp; ae==0)
<a name="l00477"></a>00477   <span class="comment">// The following fix by Peter Vanroose, 28 december 2010:</span>
<a name="l00478"></a>00478   <span class="comment">// The general idea *does not* work (at least: not easily) if two intersection points have the same y coordinate.</span>
<a name="l00479"></a>00479   <span class="comment">// So make that a special case. It is easily detected, since in that case there is a scale factor lambda</span>
<a name="l00480"></a>00480   <span class="comment">// such that c1-lamda*c2 decomposes into (y-y0)(x+my+n)=0. Which means that lambda=A/a, and the equation satisfies:</span>
<a name="l00481"></a>00481       || (ac*ad*ad+af*ab*ab == ab*ad*ae))
<a name="l00482"></a>00482     <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a>(0,ab,ac,ad,ae,af),c1);
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="comment">// Back to the &quot;general&quot; case:</span>
<a name="l00485"></a>00485   vnl_vector_fixed&lt;T,5&gt; coef;
<a name="l00486"></a>00486   coef(0) = ac*ac-ab*(b*C-B*c);
<a name="l00487"></a>00487   coef(1) = 2*ac*ae-ab*(b*E-B*e)-BD*(a*C+A*c)+2*A*b*C*d+2*a*B*c*D;
<a name="l00488"></a>00488   coef(2) = ae*ae-ab*(b*F-B*f)+ad*(c*D-C*d)-BD*(a*E+A*e)+2*a*B*e*D+2*A*b*E*d+2*ac*af;
<a name="l00489"></a>00489   coef(3) = 2*ae*af-ad*(d*E-D*e)-BD*(a*F+A*f)+2*A*b*d*F+2*a*B*D*f;
<a name="l00490"></a>00490   coef(4) = af*af-ad*(d*F-D*f);
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="comment">// Solutions of the fourth order equation</span>
<a name="l00493"></a>00493   <span class="comment">//   4      3      2</span>
<a name="l00494"></a>00494   <span class="comment">//  y  +  py  +  qy  +  ry  +  s  =  0</span>
<a name="l00495"></a>00495   <span class="comment">// are the eigenvalues of the matrix</span>
<a name="l00496"></a>00496   <span class="comment">// [ -p   -q   -r   -s ]</span>
<a name="l00497"></a>00497   <span class="comment">// [  1    0    0    0 ]</span>
<a name="l00498"></a>00498   <span class="comment">// [  0    1    0    0 ]</span>
<a name="l00499"></a>00499   <span class="comment">// [  0    0    1    0 ]</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="keywordflow">if</span> (coef(0) == 0 &amp;&amp; coef(1) == 0) { <span class="comment">// The equation is actually of 2nd degree</span>
<a name="l00502"></a>00502     <span class="keywordflow">if</span> (coef(2) == 0 &amp;&amp; coef(3) == 0) <span class="keywordflow">return</span> vcl_list&lt;<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> &gt;(); <span class="comment">// no real solutions.</span>
<a name="l00503"></a>00503     T dis = coef(3)*coef(3)-4*coef(2)*coef(4); <span class="comment">// discriminant</span>
<a name="l00504"></a>00504     <span class="keywordflow">if</span> (dis &lt; 0) <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(); <span class="comment">// no real solutions.</span>
<a name="l00505"></a>00505     T y;
<a name="l00506"></a>00506     <span class="keywordflow">if</span> (coef(2) == 0) dis=0, y = - coef(4) / coef(3);
<a name="l00507"></a>00507     <span class="keywordflow">else</span>                     y = - coef(3) / coef(2) / 2;
<a name="l00508"></a>00508     T w = y*ab+ad;
<a name="l00509"></a>00509     T x = -(y*y*ac+y*ae+af);
<a name="l00510"></a>00510     <span class="keywordflow">if</span> (x == 0 &amp;&amp; w == 0) x = w = 1;
<a name="l00511"></a>00511     <span class="keywordflow">if</span> (dis == 0) {<span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(x,y*w,w));}
<a name="l00512"></a>00512     dis = vcl_sqrt(dis) / coef(2) / 2;
<a name="l00513"></a>00513     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; solutions;
<a name="l00514"></a>00514     y -= dis; w = y*ab+ad; x = -(y*y*ac+y*ae+af);
<a name="l00515"></a>00515     <span class="keywordflow">if</span> (x == 0 &amp;&amp; w == 0) x = w = 1;
<a name="l00516"></a>00516     solutions.push_back(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(x,y*w,w));
<a name="l00517"></a>00517     y += 2*dis; w = y*ab+ad; x = -(y*y*ac+y*ae+af);
<a name="l00518"></a>00518     <span class="keywordflow">if</span> (x == 0 &amp;&amp; w == 0) x = w = 1;
<a name="l00519"></a>00519     solutions.push_back(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(x,y*w,w));
<a name="l00520"></a>00520     <span class="keywordflow">return</span> solutions;
<a name="l00521"></a>00521   }
<a name="l00522"></a>00522   <span class="keywordflow">if</span> (coef(0) == 0) { <span class="comment">// The equation is actually of 3rd degree</span>
<a name="l00523"></a>00523     coef /= -coef(1);
<a name="l00524"></a>00524     <span class="keywordtype">double</span> data[]={coef(2),coef(3),coef(4), 1,0,0, 0,1,0};
<a name="l00525"></a>00525     vnl_matrix&lt;double&gt; M(data,3,3);
<a name="l00526"></a>00526     vnl_real_eigensystem eig(M);
<a name="l00527"></a>00527     vnl_diag_matrix&lt;vcl_complex&lt;double&gt; &gt;  polysolutions = eig.D;
<a name="l00528"></a>00528     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; solutions;
<a name="l00529"></a>00529     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;3;++i)
<a name="l00530"></a>00530       <span class="keywordflow">if</span> (vcl_abs(vcl_imag(polysolutions(i))) &lt; 1e-3) {<span class="comment">// only want the real solutions</span>
<a name="l00531"></a>00531         T y = (T)vcl_real(polysolutions(i));
<a name="l00532"></a>00532         T w = y*ab+ad;
<a name="l00533"></a>00533         T x = -(y*y*ac+y*ae+af);
<a name="l00534"></a>00534         <span class="keywordflow">if</span> (x == 0 &amp;&amp; w == 0) x = w = 1;
<a name="l00535"></a>00535         solutions.push_back(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(x,y*w,w));
<a name="l00536"></a>00536       }
<a name="l00537"></a>00537     <span class="keywordflow">return</span> solutions;
<a name="l00538"></a>00538   }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540   coef /= -coef(0);
<a name="l00541"></a>00541   <span class="keywordtype">double</span> data[]={coef(1),coef(2),coef(3),coef(4), 1,0,0,0, 0,1,0,0, 0,0,1,0};
<a name="l00542"></a>00542   vnl_matrix&lt;double&gt; M(data,4,4);
<a name="l00543"></a>00543   vnl_real_eigensystem eig(M);
<a name="l00544"></a>00544 
<a name="l00545"></a>00545   vnl_diag_matrix&lt;vcl_complex&lt;double&gt; &gt;  polysolutions = eig.D;
<a name="l00546"></a>00546 
<a name="l00547"></a>00547   <span class="comment">// Ignore imaginary solutions: place just the real solutions in yvals:</span>
<a name="l00548"></a>00548   vcl_list&lt;T&gt; yvals;
<a name="l00549"></a>00549   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;++i)
<a name="l00550"></a>00550     <span class="keywordflow">if</span> (vcl_abs(vcl_imag(polysolutions(i))) &lt; 1e-7)
<a name="l00551"></a>00551       yvals.push_back((T)vcl_real(polysolutions(i)));
<a name="l00552"></a>00552 
<a name="l00553"></a>00553   <span class="comment">// These are only the solutions of the fourth order equation.</span>
<a name="l00554"></a>00554   <span class="comment">// The solutions of the intersection of the two conics are:</span>
<a name="l00555"></a>00555 
<a name="l00556"></a>00556   vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; solutions;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558   <span class="comment">// Special case: two or more y values of intersection points are identical:</span>
<a name="l00559"></a>00559   <span class="keyword">typename</span> vcl_list&lt;T&gt;::const_iterator it = yvals.begin();
<a name="l00560"></a>00560 <span class="preprocessor">#if 0</span>
<a name="l00561"></a>00561 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (yvals(0) == yvals(1) || yvals(1) == yvals(2) || yvals(2) == yvals(3))
<a name="l00562"></a>00562   {
<a name="l00563"></a>00563   }
<a name="l00564"></a>00564 <span class="preprocessor">#endif</span>
<a name="l00565"></a>00565 <span class="preprocessor"></span>
<a name="l00566"></a>00566   <span class="keywordflow">for</span> (it = yvals.begin(); it != yvals.end(); ++it) {
<a name="l00567"></a>00567     T y = *it;
<a name="l00568"></a>00568     T w = y*ab+ad;
<a name="l00569"></a>00569     T x = -(y*y*ac+y*ae+af);
<a name="l00570"></a>00570     <span class="keywordflow">if</span> (x == 0 &amp;&amp; w == 0) x = w = 1;
<a name="l00571"></a>00571     solutions.push_back(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(x,y*w,w));
<a name="l00572"></a>00572   }
<a name="l00573"></a>00573   <span class="keywordflow">return</span> solutions;
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00576"></a>00576 <span class="comment">//:</span>
<a name="l00577"></a>00577 <span class="comment">// This function is called from within intersection(vgl_conic&lt;T&gt;,vgl_homg_line_2d&lt;T&gt;).</span>
<a name="l00578"></a>00578 <span class="comment">// The conic passed to this function MUST NOT be degenerate!</span>
<a name="l00579"></a>00579 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00580"></a>00580 vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;
<a name="l00581"></a><a class="code" href="classvgl__homg__operators__2d.html#a70551c35db89e5d53063c89f39746fef">00581</a> <a class="code" href="classvgl__homg__operators__2d.html#a70551c35db89e5d53063c89f39746fef" title="This function is called from within intersection(vgl_conic&lt;T&gt;,vgl_homg_line_2d&lt;T&gt;).">vgl_homg_operators_2d&lt;T&gt;::do_intersect</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; q,
<a name="l00582"></a>00582                                        <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l)
<a name="l00583"></a>00583 {
<a name="l00584"></a>00584   T A=q.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>(), B=q.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>(), C=q.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>(), D=q.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>(), E=q.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>(), F=q.<a class="code" href="classvgl__conic.html#abd1ab7e73359f1ccc4b2a64f3e043a03" title="Returns the coefficient of .">f</a>();
<a name="l00585"></a>00585   T a=l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>(), b=l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>(), c=l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>();
<a name="l00586"></a>00586 
<a name="l00587"></a>00587   <span class="keywordflow">if</span> (a==0 &amp;&amp; b==0) { <span class="comment">// line at infinity</span>
<a name="l00588"></a>00588     <span class="keywordflow">if</span> (A==0)
<a name="l00589"></a>00589       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(1,0,0));
<a name="l00590"></a>00590     T d = B*B-4*A*C; <span class="comment">// discriminant</span>
<a name="l00591"></a>00591     <span class="keywordflow">if</span> (d &lt; 0) <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(); <span class="comment">// no solutions</span>
<a name="l00592"></a>00592     <span class="keywordflow">if</span> (d == 0)
<a name="l00593"></a>00593       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,vgl_homg_point_2d&lt;T&gt;(-B,2*A,0));
<a name="l00594"></a>00594     d = vcl_sqrt(d);
<a name="l00595"></a>00595     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>(1, vgl_homg_point_2d&lt;T&gt;(-B+d, 2*A, 0));
<a name="l00596"></a>00596     v.push_back(vgl_homg_point_2d&lt;T&gt;(-B-d, 2*A, 0));
<a name="l00597"></a>00597     <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599   <span class="keywordflow">if</span> (a==0) { <span class="comment">// write y in terms of w and solve for (x,w)</span>
<a name="l00600"></a>00600     T y = -c/b; B = B*y+D;
<a name="l00601"></a>00601     T d = B*B-4*A*(C*y*y+E*y+F); <span class="comment">// discriminant</span>
<a name="l00602"></a>00602     <span class="keywordflow">if</span> (d &lt; 0) <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(); <span class="comment">// no solutions</span>
<a name="l00603"></a>00603     <span class="keywordflow">if</span> (d == 0 &amp;&amp; A == 0)
<a name="l00604"></a>00604       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(1,0,0));
<a name="l00605"></a>00605     <span class="keywordflow">if</span> (d == 0)
<a name="l00606"></a>00606       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,vgl_homg_point_2d&lt;T&gt;(-B,y*2*A,2*A));
<a name="l00607"></a>00607     <span class="keywordflow">if</span> (A == 0) {
<a name="l00608"></a>00608       vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>(1, vgl_homg_point_2d&lt;T&gt;(1,0,0));
<a name="l00609"></a>00609       v.push_back(vgl_homg_point_2d&lt;T&gt;(C*y*y+E*y+F, -y*B, -B));
<a name="l00610"></a>00610       <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00611"></a>00611     }
<a name="l00612"></a>00612     d = vcl_sqrt(d);
<a name="l00613"></a>00613     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>(1, vgl_homg_point_2d&lt;T&gt;(-B+d, y*2*A, 2*A));
<a name="l00614"></a>00614     v.push_back(vgl_homg_point_2d&lt;T&gt;(-B-d, y*2*A, 2*A));
<a name="l00615"></a>00615     <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00616"></a>00616   }
<a name="l00617"></a>00617   b /= -a; c /= -a; <span class="comment">// now x = b*y+c*w.</span>
<a name="l00618"></a>00618   T AA = A*b*b+B*b+C;
<a name="l00619"></a>00619   B = 2*A*b*c+B*c+D*b+E;
<a name="l00620"></a>00620   T d = B*B-4*AA*(A*c*c+D*c+F); <span class="comment">// discriminant</span>
<a name="l00621"></a>00621   <span class="keywordflow">if</span> (d &lt; 0) <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(); <span class="comment">// no solutions</span>
<a name="l00622"></a>00622   <span class="keywordflow">if</span> (d == 0 &amp;&amp; AA == 0)
<a name="l00623"></a>00623     <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(b,1,0));
<a name="l00624"></a>00624   <span class="keywordflow">if</span> (d == 0)
<a name="l00625"></a>00625     <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2,<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(c*2*AA-b*B,-B,2*AA));
<a name="l00626"></a>00626   <span class="keywordflow">if</span> (AA == 0) {
<a name="l00627"></a>00627     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>(1, <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(b,1,0));
<a name="l00628"></a>00628     v.push_back(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(b*A*c*c+b*D*c+b*F-c*B, A*c*c+D*c+F, -B));
<a name="l00629"></a>00629     <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00630"></a>00630   }
<a name="l00631"></a>00631   d = vcl_sqrt(d);
<a name="l00632"></a>00632   vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>(1, <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(c*2*AA-b*B+b*d, -B+d, 2*AA));
<a name="l00633"></a>00633   v.push_back(<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(c*2*AA-b*B-b*d, -B-d, 2*AA));
<a name="l00634"></a>00634   <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00635"></a>00635 }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 <span class="comment">//: Return the (real) intersection points of a conic and a line.</span>
<a name="l00638"></a>00638 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00639"></a>00639 vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;
<a name="l00640"></a><a class="code" href="classvgl__homg__operators__2d.html#ad687a1d57b75f597fbb0800a691c3836">00640</a> <a class="code" href="classvgl__homg__operators__2d.html#a4a861961fb5d39005d442ca8754029b0" title="Get the intersection point of two lines (the cross-product).">vgl_homg_operators_2d&lt;T&gt;::intersection</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c,
<a name="l00641"></a>00641                                        <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l)
<a name="l00642"></a>00642 {
<a name="l00643"></a>00643   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::no_type</a> ||
<a name="l00644"></a>00644       c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_parallel_lines</a> ||
<a name="l00645"></a>00645       c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_intersecting_lines</a> ||
<a name="l00646"></a>00646       c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::imaginary_ellipse</a> ||
<a name="l00647"></a>00647       c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::imaginary_circle</a>)
<a name="l00648"></a>00648     <span class="keywordflow">return</span> vcl_list&lt;<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> &gt;(); <span class="comment">// empty list</span>
<a name="l00649"></a>00649   <span class="comment">// let&#39;s hope the intersection point of the two complex lines is not on the line..</span>
<a name="l00650"></a>00650 
<a name="l00651"></a>00651   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::coincident_lines</a>) {
<a name="l00652"></a>00652     <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> p = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(l, c.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().front());
<a name="l00653"></a>00653     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; list(2, p); <span class="comment">// intersection is *two* coincident points</span>
<a name="l00654"></a>00654     <span class="keywordflow">return</span> list;
<a name="l00655"></a>00655   }
<a name="l00656"></a>00656 
<a name="l00657"></a>00657   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::real_intersecting_lines</a> || c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::real_parallel_lines</a>) {
<a name="l00658"></a>00658     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; list;
<a name="l00659"></a>00659     list.push_back(<a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(l, c.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().front()));
<a name="l00660"></a>00660     list.push_back(<a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(l, c.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().back()));
<a name="l00661"></a>00661     <span class="keywordflow">return</span> list;
<a name="l00662"></a>00662   }
<a name="l00663"></a>00663   <span class="keywordflow">return</span> do_intersect(c, l);
<a name="l00664"></a>00664 }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00667"></a>00667 vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;
<a name="l00668"></a><a class="code" href="classvgl__homg__operators__2d.html#a68a5fad4239dec1bb4241edecd46c7b8">00668</a> <a class="code" href="classvgl__homg__operators__2d.html#a4a861961fb5d39005d442ca8754029b0" title="Get the intersection point of two lines (the cross-product).">vgl_homg_operators_2d&lt;T&gt;::intersection</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c1, <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c2)
<a name="l00669"></a>00669 {
<a name="l00670"></a>00670   <span class="keywordflow">if</span> ((c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_parallel_lines</a> ||
<a name="l00671"></a>00671        c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_intersecting_lines</a>)
<a name="l00672"></a>00672       &amp;&amp; c2.<a class="code" href="classvgl__conic.html#a626f9ec3ad45f4fcab074dd8c2043cbc" title="Returns true if the point pt belongs to the conic.">contains</a>(c1.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>()))
<a name="l00673"></a>00673     <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2, c1.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>()); <span class="comment">// double intersection point</span>
<a name="l00674"></a>00674   <span class="keywordflow">if</span> ((c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_parallel_lines</a> ||
<a name="l00675"></a>00675        c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_intersecting_lines</a>)
<a name="l00676"></a>00676       &amp;&amp; c1.<a class="code" href="classvgl__conic.html#a626f9ec3ad45f4fcab074dd8c2043cbc" title="Returns true if the point pt belongs to the conic.">contains</a>(c2.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>()))
<a name="l00677"></a>00677     <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;(2, c2.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>()); <span class="comment">// double intersection point</span>
<a name="l00678"></a>00678   <span class="keywordflow">if</span> (c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::no_type</a>   ||  c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::no_type</a> ||
<a name="l00679"></a>00679       c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_parallel_lines</a>||c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_parallel_lines</a> ||
<a name="l00680"></a>00680       c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_intersecting_lines</a>||c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>()==<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::complex_intersecting_lines</a> ||
<a name="l00681"></a>00681       c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::imaginary_ellipse</a>|| c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::imaginary_ellipse</a> ||
<a name="l00682"></a>00682       c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::imaginary_circle</a> || c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::imaginary_circle</a>)
<a name="l00683"></a>00683     <span class="keywordflow">return</span> vcl_list&lt;<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> &gt;(); <span class="comment">// empty list</span>
<a name="l00684"></a>00684 
<a name="l00685"></a>00685   <span class="keywordflow">if</span> (c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::coincident_lines</a> ||
<a name="l00686"></a>00686       c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::real_intersecting_lines</a> ||
<a name="l00687"></a>00687       c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::real_parallel_lines</a>) {
<a name="l00688"></a>00688     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; l1=<a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c2,c1.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().front());
<a name="l00689"></a>00689     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; l2=<a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c2,c1.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().back());
<a name="l00690"></a>00690     l1.insert(l1.end(), l2.begin(), l2.end()); <span class="comment">// append l2 to l1</span>
<a name="l00691"></a>00691     <span class="keywordflow">return</span> l1;
<a name="l00692"></a>00692   }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694   <span class="keywordflow">if</span> (c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::coincident_lines</a> ||
<a name="l00695"></a>00695       c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::real_intersecting_lines</a> ||
<a name="l00696"></a>00696       c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::real_parallel_lines</a>) {
<a name="l00697"></a>00697     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; l1=<a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c1,c2.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().front());
<a name="l00698"></a>00698     vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; l2=<a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c1,c2.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>().back());
<a name="l00699"></a>00699     l1.insert(l1.end(), l2.begin(), l2.end()); <span class="comment">// append l2 to l1</span>
<a name="l00700"></a>00700     <span class="keywordflow">return</span> l1;
<a name="l00701"></a>00701   }
<a name="l00702"></a>00702 
<a name="l00703"></a>00703   <span class="keywordflow">return</span> do_intersect(c1, c2);
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 <span class="comment">//: Return the (at most) two tangent lines that pass through p and are tangent to the conic.</span>
<a name="l00707"></a>00707 <span class="comment">// For points on the conic, exactly 1 line is returned: the tangent at that point.</span>
<a name="l00708"></a>00708 <span class="comment">// For points inside the conic, an empty list is returned.</span>
<a name="l00709"></a>00709 <span class="comment">// For points outside the conic, there are always two tangents returned.</span>
<a name="l00710"></a>00710 <span class="comment">// Found by intersecting the dual conic with the dual line.</span>
<a name="l00711"></a>00711 <span class="comment">// If the conic is degenerate, an empty list is returned, unless the point is</span>
<a name="l00712"></a>00712 <span class="comment">// on the conic (in which case the component is returned to which it belongs,</span>
<a name="l00713"></a>00713 <span class="comment">// or even both components in the exclusive case that the point is the centre).</span>
<a name="l00714"></a>00714 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00715"></a>00715 vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt;
<a name="l00716"></a><a class="code" href="classvgl__homg__operators__2d.html#a5cf56a11865ad6a4f4ac8006fb16ac06">00716</a> <a class="code" href="classvgl__homg__operators__2d.html#a5cf56a11865ad6a4f4ac8006fb16ac06" title="Return the (at most) two tangent lines that pass through p and are tangent to the conic...">vgl_homg_operators_2d&lt;T&gt;::tangent_from</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c,
<a name="l00717"></a>00717                                        <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00718"></a>00718 {
<a name="l00719"></a>00719   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a76a623598cd66ac91cf6055107d2b405" title="Returns true if this conic is degenerate, i.e., if it consists of 2 lines.">is_degenerate</a>()) {
<a name="l00720"></a>00720     <span class="keywordflow">if</span> (!c.<a class="code" href="classvgl__conic.html#a626f9ec3ad45f4fcab074dd8c2043cbc" title="Returns true if the point pt belongs to the conic.">contains</a>(p)) <span class="keywordflow">return</span> vcl_list&lt;<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> &gt;();
<a name="l00721"></a>00721     vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = c.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>();
<a name="l00722"></a>00722     <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() == <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::coincident_lines</a> || p == c.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>())
<a name="l00723"></a>00723       <span class="keywordflow">return</span> v;
<a name="l00724"></a>00724     <span class="keywordflow">if</span> (v.size() &gt; 0 &amp;&amp; <a class="code" href="vgl__homg__operators__3d_8txx.html#a399c075004b82438b08784ba9a9de36a">dot</a>(v.front(),p) == 0)
<a name="l00725"></a>00725       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt;(1,v.front());
<a name="l00726"></a>00726     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.size() &gt; 1 &amp;&amp; <a class="code" href="vgl__homg__operators__3d_8txx.html#a399c075004b82438b08784ba9a9de36a">dot</a>(v.back(),p) == 0)
<a name="l00727"></a>00727       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt;(1,v.back());
<a name="l00728"></a>00728     <span class="keywordflow">else</span>
<a name="l00729"></a>00729       <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt;();
<a name="l00730"></a>00730   }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732   <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> C = c.<a class="code" href="classvgl__conic.html#a112284705bdd9285681b6b81f31ae977" title="Returns the dual or tangential representation of this conic.">dual_conic</a>();
<a name="l00733"></a>00733   <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>  <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>(p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(),p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(),p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()); <span class="comment">// dual line</span>
<a name="l00734"></a>00734   vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; dualpts = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(C,l);
<a name="l00735"></a>00735   vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00736"></a>00736   <span class="keyword">typename</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;::iterator it = dualpts.begin();
<a name="l00737"></a>00737   <span class="keywordflow">for</span> (; !(it == dualpts.end()); ++it)
<a name="l00738"></a>00738     v.push_back(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>((*it).x(), (*it).y(), (*it).w()));
<a name="l00739"></a>00739   <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00740"></a>00740 }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742 <span class="comment">//: Return the list of common tangent lines of two conics.</span>
<a name="l00743"></a>00743 <span class="comment">// This is done by finding the intersection points of the two dual conics,</span>
<a name="l00744"></a>00744 <span class="comment">// which are the duals of the common tangent lines.</span>
<a name="l00745"></a>00745 <span class="comment">// If one of the conics is degenerate, an empty list is returned.</span>
<a name="l00746"></a>00746 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00747"></a>00747 vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt;
<a name="l00748"></a><a class="code" href="classvgl__homg__operators__2d.html#a972505950465a86afbe20573080369e7">00748</a> <a class="code" href="classvgl__homg__operators__2d.html#a972505950465a86afbe20573080369e7" title="Return the list of common tangent lines of two conics.">vgl_homg_operators_2d&lt;T&gt;::common_tangents</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c1,
<a name="l00749"></a>00749                                           <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c2)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751   <span class="keywordflow">if</span> ((c1.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() != <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::parabola</a> &amp;&amp; ! c1.<a class="code" href="classvgl__conic.html#a230630620736f8604d14c6c83bb09c83" title="Returns true if a central conic, i.e., an ellipse, circle, or hyperbola.">is_central</a>())  ||
<a name="l00752"></a>00752       (c2.<a class="code" href="classvgl__conic.html#aca7b2d5554f2aaefbb50b955ee708341">type</a>() != <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;::parabola</a> &amp;&amp; ! c2.<a class="code" href="classvgl__conic.html#a230630620736f8604d14c6c83bb09c83" title="Returns true if a central conic, i.e., an ellipse, circle, or hyperbola.">is_central</a>()))
<a name="l00753"></a>00753     <span class="keywordflow">return</span> vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt;();<span class="comment">//empty list: degenerate conic has no dual</span>
<a name="l00754"></a>00754 
<a name="l00755"></a>00755   <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> C1 = c1.<a class="code" href="classvgl__conic.html#a112284705bdd9285681b6b81f31ae977" title="Returns the dual or tangential representation of this conic.">dual_conic</a>();
<a name="l00756"></a>00756   <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> C2 = c2.<a class="code" href="classvgl__conic.html#a112284705bdd9285681b6b81f31ae977" title="Returns the dual or tangential representation of this conic.">dual_conic</a>();
<a name="l00757"></a>00757   vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; dualpts = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(C1,C2);
<a name="l00758"></a>00758   vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt; <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00759"></a>00759   <span class="keyword">typename</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;::iterator it = dualpts.begin();
<a name="l00760"></a>00760   <span class="keywordflow">for</span> (; !(it == dualpts.end()); ++it)
<a name="l00761"></a>00761     v.push_back(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>((*it).x(), (*it).y(), (*it).w()));
<a name="l00762"></a>00762   <span class="keywordflow">return</span> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l00763"></a>00763 }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 <span class="comment">//: Return the point on the conic closest to the given point</span>
<a name="l00766"></a>00766 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00767"></a>00767 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00768"></a><a class="code" href="classvgl__homg__operators__2d.html#afab84b890bf9225e70e354e7600c659f">00768</a> <a class="code" href="classvgl__homg__operators__2d.html#a50b4a9097bc08e0cb905ab6f52e4d620" title="Return the point on the line closest to the given point.">vgl_homg_operators_2d&lt;T&gt;::closest_point</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c,
<a name="l00769"></a>00769                                         <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; pt)
<a name="l00770"></a>00770 {
<a name="l00771"></a>00771   <span class="comment">// First check if the point is on the curve, since this simplifies things:</span>
<a name="l00772"></a>00772   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a626f9ec3ad45f4fcab074dd8c2043cbc" title="Returns true if the point pt belongs to the conic.">contains</a>(pt)) <span class="keywordflow">return</span> pt;
<a name="l00773"></a>00773 
<a name="l00774"></a>00774   <span class="comment">// The nearest point must have a polar line which is orthogonal to its</span>
<a name="l00775"></a>00775   <span class="comment">// connection line with the given point; all points with this property form</span>
<a name="l00776"></a>00776   <span class="comment">// a certain conic  (actually an orthogonal hyperbola) :</span>
<a name="l00777"></a>00777   vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt; candidates; <span class="comment">// all intersection points</span>
<a name="l00778"></a>00778   <span class="keywordflow">if</span> (pt.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() == 0) <span class="comment">// given point is at infinity</span>
<a name="l00779"></a>00779   {
<a name="l00780"></a>00780     <span class="comment">// ==&gt; degenerate hyperbola: line + line at infinity</span>
<a name="l00781"></a>00781     <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>(c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>()*pt.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()*2-c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()*pt.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>(),
<a name="l00782"></a>00782                          -c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>()*pt.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()*2+c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()*pt.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>(),
<a name="l00783"></a>00783                           c.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>()*pt.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()  -c.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>()*pt.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>());
<a name="l00784"></a>00784     candidates = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c, l);
<a name="l00785"></a>00785     <span class="keywordflow">if</span> (candidates.size() == 0)
<a name="l00786"></a>00786       <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(0,0,0); <span class="comment">// this cannot happen</span>
<a name="l00787"></a>00787     <span class="comment">// just return any of the candidates, since distance makes no sense at infinity:</span>
<a name="l00788"></a>00788     <span class="keywordflow">else</span> <span class="keywordflow">return</span> candidates.front();
<a name="l00789"></a>00789   }
<a name="l00790"></a>00790   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()==0 &amp;&amp; c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>()==c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>()) <span class="comment">// the given conic is a circle</span>
<a name="l00791"></a>00791   {
<a name="l00792"></a>00792     <span class="comment">// ==&gt; degenerate hyperbola: line thru centre &amp; point  +  line at infinity</span>
<a name="l00793"></a>00793     <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__homg__point__1d.html#adee43f992edd6c4c8e46fde8cf9a7576" title="Return the point at the centre of gravity of two given points.">centre</a> = c.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>();
<a name="l00794"></a>00794     <span class="keywordflow">if</span> (centre == pt) <span class="comment">// in this case, any point of the circle is all right</span>
<a name="l00795"></a>00795       centre = <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(1,0,0); <span class="comment">// take a horizontal line thru pt</span>
<a name="l00796"></a>00796     candidates = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c, <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>(centre,pt));
<a name="l00797"></a>00797   }
<a name="l00798"></a>00798   <span class="keywordflow">else</span> <span class="comment">// general case:</span>
<a name="l00799"></a>00799   {
<a name="l00800"></a>00800     <a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> conic(pt.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>(),
<a name="l00801"></a>00801                        pt.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*(c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>()-c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>())*2,
<a name="l00802"></a>00802                       -pt.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>(),
<a name="l00803"></a>00803                        pt.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()*c.<a class="code" href="classvgl__conic.html#aff5f99be8c7117551dd74103d1049d4b" title="Returns the coefficient of .">a</a>()*2-pt.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()*c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()+pt.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*c.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>(),
<a name="l00804"></a>00804                       -pt.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()*c.<a class="code" href="classvgl__conic.html#ae23a96a1c06e08856915cd1ca4764b8c" title="Returns the coefficient of .">c</a>()*2+pt.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()*c.<a class="code" href="classvgl__conic.html#a5167d7d58ee5fe70d9f27461e5c19b8d" title="Returns the coefficient of .">b</a>()-pt.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>()*c.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>(),
<a name="l00805"></a>00805                        pt.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()*c.<a class="code" href="classvgl__conic.html#aa2d637a83fa11680b1fb4a8705886b96" title="Returns the coefficient of .">d</a>()  -pt.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()*c.<a class="code" href="classvgl__conic.html#abb116ef4dd748db5d98a04796c4697fd" title="Returns the coefficient of .">e</a>());
<a name="l00806"></a>00806     <span class="comment">// Now it suffices to intersect the hyperbola with the given conic:</span>
<a name="l00807"></a>00807     candidates = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(c, conic);
<a name="l00808"></a>00808   }
<a name="l00809"></a>00809   <span class="keywordflow">if</span> (candidates.size() == 0)
<a name="l00810"></a>00810   {
<a name="l00811"></a>00811     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Warning: vgl_homg_operators_2d&lt;T&gt;::closest_point: no intersection\n&quot;</span>;
<a name="l00812"></a>00812     <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(0,0,0);
<a name="l00813"></a>00813   }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815   <span class="comment">// And find the intersection point closest to the given location:</span>
<a name="l00816"></a>00816   <span class="keyword">typename</span> vcl_list&lt;vgl_homg_point_2d&lt;T&gt; &gt;::iterator it = candidates.begin();
<a name="l00817"></a>00817   <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> p = (*it);
<a name="l00818"></a>00818   T dist = <a class="code" href="classvgl__homg__operators__2d.html#a85246601d0347ab7d46a9ac6d8b4ddb5" title="Get the square of the 2D distance between the two points.">vgl_homg_operators_2d&lt;T&gt;::distance_squared</a>(*it,pt);
<a name="l00819"></a>00819   <span class="keywordflow">for</span> (++it; it != candidates.end(); ++it) {
<a name="l00820"></a>00820     <span class="keywordflow">if</span> ((*it).w() == 0) <span class="keywordflow">continue</span>;
<a name="l00821"></a>00821     T d = <a class="code" href="classvgl__homg__operators__2d.html#a85246601d0347ab7d46a9ac6d8b4ddb5" title="Get the square of the 2D distance between the two points.">vgl_homg_operators_2d&lt;T&gt;::distance_squared</a>(*it,pt);
<a name="l00822"></a>00822     <span class="keywordflow">if</span> (d &lt; dist) { p = (*it); dist = d; }
<a name="l00823"></a>00823   }
<a name="l00824"></a>00824   <span class="keywordflow">return</span> p;
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 <span class="comment">//: Return the point on the conic closest to the given point.</span>
<a name="l00828"></a>00828 <span class="comment">//  Still return a homogeneous point, even if the argument is non-homogeneous.</span>
<a name="l00829"></a>00829 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00830"></a>00830 <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>
<a name="l00831"></a><a class="code" href="classvgl__homg__operators__2d.html#a9bcf31ae85e50fd70156bafbe2d8e1b6">00831</a> <a class="code" href="classvgl__homg__operators__2d.html#a50b4a9097bc08e0cb905ab6f52e4d620" title="Return the point on the line closest to the given point.">vgl_homg_operators_2d&lt;T&gt;::closest_point</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c,
<a name="l00832"></a>00832                                         <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; pt)
<a name="l00833"></a>00833 {
<a name="l00834"></a>00834   <span class="keywordflow">return</span> closest_point(c,<a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(pt));
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 <span class="comment">//: Compute the bounding box of an ellipse</span>
<a name="l00838"></a>00838 <span class="comment">// This is done by finding the tangent lines to the ellipse from the two points</span>
<a name="l00839"></a>00839 <span class="comment">// at infinity (1,0,0) and (0,1,0).</span>
<a name="l00840"></a>00840 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00841"></a>00841 <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>
<a name="l00842"></a><a class="code" href="classvgl__homg__operators__2d.html#ae2709ad4b094d4fc724f9e7ad3db7063">00842</a> <a class="code" href="classvgl__homg__operators__2d.html#ae2709ad4b094d4fc724f9e7ad3db7063" title="Compute the bounding box of an ellipse.">vgl_homg_operators_2d&lt;T&gt;::compute_bounding_box</a>(<a class="code" href="classvgl__conic.html" title="A quadratic plane curve.">vgl_conic&lt;T&gt;</a> <span class="keyword">const</span>&amp; c)
<a name="l00843"></a>00843 {
<a name="l00844"></a>00844   <span class="comment">// Only ellipses have a finite bounding box:</span>
<a name="l00845"></a>00845 
<a name="l00846"></a>00846   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;complex intersecting lines&quot;</span>) { <span class="comment">// a single point:</span>
<a name="l00847"></a>00847     <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> pt = c.<a class="code" href="classvgl__conic.html#aa2e061fcec39f2f1dc3eb83029839f29" title="Returns the centre of the conic, or its point at infinity if a parabola.">centre</a>();
<a name="l00848"></a>00848     <span class="keywordflow">return</span> <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>(<a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(pt), <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(pt));
<a name="l00849"></a>00849   }
<a name="l00850"></a>00850 
<a name="l00851"></a>00851   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;invalid conic&quot;</span> ||
<a name="l00852"></a>00852       c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;imaginary ellipse&quot;</span> ||
<a name="l00853"></a>00853       c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;imaginary circle&quot;</span> ||
<a name="l00854"></a>00854       c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;complex parallel lines&quot;</span>)
<a name="l00855"></a>00855     <span class="keywordflow">return</span> <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>(); <span class="comment">// empty box</span>
<a name="l00856"></a>00856 
<a name="l00857"></a>00857   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;real parallel lines&quot;</span> ||
<a name="l00858"></a>00858       c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() == <span class="stringliteral">&quot;coincident lines&quot;</span>)
<a name="l00859"></a>00859   {
<a name="l00860"></a>00860     <span class="comment">// find out if these lines happen to be horizontal or vertical</span>
<a name="l00861"></a>00861     vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt; l = c.<a class="code" href="classvgl__conic.html#abf89f241ae6728103ce00381274afc86" title="Returns the list of component lines, when degenerate and real components.">components</a>();
<a name="l00862"></a>00862     <span class="keywordflow">if</span> (l.front().a() == 0) <span class="comment">// horizontal lines</span>
<a name="l00863"></a>00863       <span class="keywordflow">return</span> <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>(<a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(T(1e33),-l.front().c()/l.front().b()),
<a name="l00864"></a>00864                            <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(T(-1e33),-l.back().c()/l.back().b()));
<a name="l00865"></a>00865     <span class="keywordflow">if</span> (l.front().b() == 0) <span class="comment">// vertical lines</span>
<a name="l00866"></a>00866       <span class="keywordflow">return</span> <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>(<a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(-l.front().c()/l.front().b(),T(1e33)),
<a name="l00867"></a>00867                            <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(-l.back().c()/l.back().b(),T(-1e33)));
<a name="l00868"></a>00868     <span class="comment">// if not, go to the general case, i.e., return &quot;everything&quot;.</span>
<a name="l00869"></a>00869   }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871   <span class="keywordflow">if</span> (c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() != <span class="stringliteral">&quot;real ellipse&quot;</span> &amp;&amp; c.<a class="code" href="classvgl__conic.html#a91ff49c3993c53fa42a11572c1a9a3b3" title="Returns the type of the conic as a string.">real_type</a>() != <span class="stringliteral">&quot;real circle&quot;</span>)
<a name="l00872"></a>00872     <span class="keywordflow">return</span> <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>(T(-1e33), T(1e33), T(-1e33), T(1e33)); <span class="comment">// everything</span>
<a name="l00873"></a>00873 
<a name="l00874"></a>00874   <span class="comment">// Now for the ellipses:</span>
<a name="l00875"></a>00875 
<a name="l00876"></a>00876   <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> px (1,0,0); <span class="comment">// point at infinity of the X axis</span>
<a name="l00877"></a>00877   <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> py (0,1,0); <span class="comment">// point at infinity of the Y axis</span>
<a name="l00878"></a>00878 
<a name="l00879"></a>00879   vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt; lx = <a class="code" href="classvgl__homg__operators__2d.html#a5cf56a11865ad6a4f4ac8006fb16ac06" title="Return the (at most) two tangent lines that pass through p and are tangent to the conic...">vgl_homg_operators_2d&lt;T&gt;::tangent_from</a>(c, px);
<a name="l00880"></a>00880   vcl_list&lt;vgl_homg_line_2d&lt;T&gt; &gt; ly = <a class="code" href="classvgl__homg__operators__2d.html#a5cf56a11865ad6a4f4ac8006fb16ac06" title="Return the (at most) two tangent lines that pass through p and are tangent to the conic...">vgl_homg_operators_2d&lt;T&gt;::tangent_from</a>(c, py);
<a name="l00881"></a>00881 
<a name="l00882"></a>00882   T y1 = - lx.front().c() / lx.front().b(); <span class="comment">// lx are two horizontal lines</span>
<a name="l00883"></a>00883   T y2 = - lx.back().c() / lx.back().b();
<a name="l00884"></a>00884   <span class="keywordflow">if</span> (y1 &gt; y2) { T t = y1; y1 = y2; y2 = t; }
<a name="l00885"></a>00885   T x1 = - ly.front().c() / ly.front().a(); <span class="comment">// ly are two vertical lines</span>
<a name="l00886"></a>00886   T x2 = - ly.back().c() / ly.back().a();
<a name="l00887"></a>00887   <span class="keywordflow">if</span> (x1 &gt; x2) { T t = x1; x1 = x2; x2 = t; }
<a name="l00888"></a>00888 
<a name="l00889"></a>00889   <span class="keywordflow">return</span> <a class="code" href="classvgl__box__2d.html">vgl_box_2d&lt;T&gt;</a>(x1, x2, y1, y2);
<a name="l00890"></a>00890 }
<a name="l00891"></a>00891 
<a name="l00892"></a>00892 <span class="comment">//: Transform a point through a 3x3 projective transformation matrix</span>
<a name="l00893"></a>00893 <span class="comment">// \relatesalso vgl_homg_point_2d</span>
<a name="l00894"></a>00894 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00895"></a><a class="code" href="vgl__homg__operators__2d_8txx.html#aa5b116e64012964f6d27573a28c90c23">00895</a> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__homg__point__1d.html#a20b5ec39d2d04f2028cacbed2aafb25e" title="Transform a point through a 2x2 projective transformation matrix.">operator*</a>(vnl_matrix_fixed&lt;T,3,3&gt; <span class="keyword">const</span>&amp; m,
<a name="l00896"></a>00896                                <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00897"></a>00897 {
<a name="l00898"></a>00898   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(m(0,0)*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()+m(0,1)*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()+m(0,2)*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>(),
<a name="l00899"></a>00899                               m(1,0)*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()+m(1,1)*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()+m(1,2)*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>(),
<a name="l00900"></a>00900                               m(2,0)*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()+m(2,1)*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()+m(2,2)*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>());
<a name="l00901"></a>00901 }
<a name="l00902"></a>00902 
<a name="l00903"></a>00903 <span class="comment">//: Transform a line through a 3x3 projective transformation matrix</span>
<a name="l00904"></a>00904 <span class="comment">// \relatesalso vgl_homg_line_2d</span>
<a name="l00905"></a>00905 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00906"></a><a class="code" href="vgl__homg__operators__2d_8txx.html#a64e91d4bcb2a2d502244ef601f655a93">00906</a> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <a class="code" href="classvgl__homg__point__1d.html#a20b5ec39d2d04f2028cacbed2aafb25e" title="Transform a point through a 2x2 projective transformation matrix.">operator*</a>(vnl_matrix_fixed&lt;T,3,3&gt; <span class="keyword">const</span>&amp; m,
<a name="l00907"></a>00907                               <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l)
<a name="l00908"></a>00908 {
<a name="l00909"></a>00909   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a>(m(0,0)*l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()+m(0,1)*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()+m(0,2)*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(),
<a name="l00910"></a>00910                              m(1,0)*l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()+m(1,1)*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()+m(1,2)*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(),
<a name="l00911"></a>00911                              m(2,0)*l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()+m(2,1)*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()+m(2,2)*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>());
<a name="l00912"></a>00912 }
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <span class="comment">//: Return the point on the line closest to the given point</span>
<a name="l00915"></a>00915 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00916"></a><a class="code" href="classvgl__homg__operators__2d.html#a50b4a9097bc08e0cb905ab6f52e4d620">00916</a> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__homg__operators__2d.html#a50b4a9097bc08e0cb905ab6f52e4d620" title="Return the point on the line closest to the given point.">vgl_homg_operators_2d&lt;T&gt;::closest_point</a>(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l,
<a name="l00917"></a>00917                                                              <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00918"></a>00918 {
<a name="l00919"></a>00919   <span class="comment">// Return p itself, if p lies on l:</span>
<a name="l00920"></a>00920   <span class="keywordflow">if</span> (l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()+l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()+l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>() == 0) <span class="keywordflow">return</span> p;
<a name="l00921"></a>00921   <span class="comment">// Otherwise, make sure that both l and p are not at infinity:</span>
<a name="l00922"></a>00922   assert(!l.<a class="code" href="classvgl__homg__line__2d.html#a0bc63f0ad3b42ff87138c59553302dbb" title="Return true iff this line is the line at infinity.">ideal</a>()); <span class="comment">// should not be the line at infinity</span>
<a name="l00923"></a>00923   <span class="comment">// Line othogonal to l and through p is  bx-ay+d=0, with d = (a*py-b*px)/pw.</span>
<a name="l00924"></a>00924   <a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> o(l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>(), -l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#ab452fbf6dec9591ff07c0ebb7b05f1e1">w</a>(), l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()-l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>());
<a name="l00925"></a>00925   <span class="comment">// Finally return the intersection point of l with this orthogonal line:</span>
<a name="l00926"></a>00926   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__operators__2d.html#a4a861961fb5d39005d442ca8754029b0" title="Get the intersection point of two lines (the cross-product).">vgl_homg_operators_2d&lt;T&gt;::intersection</a>(l,o);
<a name="l00927"></a>00927 }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929 <span class="preprocessor">#undef VGL_HOMG_OPERATORS_2D_INSTANTIATE</span>
<a name="l00930"></a><a class="code" href="vgl__homg__operators__2d_8txx.html#a951562919019ea219b05766343cf4784">00930</a> <span class="preprocessor"></span><span class="preprocessor">#define VGL_HOMG_OPERATORS_2D_INSTANTIATE(T) \</span>
<a name="l00931"></a>00931 <span class="preprocessor">template class vgl_homg_operators_2d&lt;T &gt;; \</span>
<a name="l00932"></a>00932 <span class="preprocessor">template vgl_homg_point_2d&lt;T &gt; operator*(vnl_matrix_fixed&lt;T,3,3&gt; const&amp; m, vgl_homg_point_2d&lt;T &gt; const&amp; p); \</span>
<a name="l00933"></a>00933 <span class="preprocessor">template vgl_homg_line_2d&lt;T &gt; operator*(vnl_matrix_fixed&lt;T,3,3&gt; const&amp; m, vgl_homg_line_2d&lt;T &gt; const&amp; p)</span>
<a name="l00934"></a>00934 <span class="preprocessor"></span>
<a name="l00935"></a>00935 <span class="preprocessor">#endif // vgl_homg_operators_2d_txx_</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:31:23 for core/vgl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
