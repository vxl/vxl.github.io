<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>core/vgl/vgl_closest_point.txx Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">core/vgl/vgl_closest_point.txx</div>  </div>
</div>
<div class="contents">
<a href="vgl__closest__point_8txx.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is core/vgl/vgl_closest_point.txx</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef vgl_closest_point_txx_</span>
<a name="l00003"></a><a class="code" href="vgl__closest__point_8txx.html#ab143601c851a603eeeab17766e250d29">00003</a> <span class="preprocessor"></span><span class="preprocessor">#define vgl_closest_point_txx_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="comment">//:</span>
<a name="l00005"></a>00005 <span class="comment">// \file</span>
<a name="l00006"></a>00006 <span class="comment">// \author Peter Vanroose, KULeuven, ESAT/PSI</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;<a class="code" href="vgl__closest__point_8h.html" title="Set of closest-point functions.">vgl_closest_point.h</a>&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;<a class="code" href="vgl__distance_8h.html" title="Set of distance functions.">vgl/vgl_distance.h</a>&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;<a class="code" href="vgl__line__2d_8h.html">vgl/vgl_line_2d.h</a>&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__line__2d_8h.html" title="line in projective 2D space">vgl/vgl_homg_line_2d.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;<a class="code" href="vgl__point__2d_8h.html" title="a point in 2D nonhomogeneous space">vgl/vgl_point_2d.h</a>&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;<a class="code" href="vgl__point__3d_8h.html" title="a point in 3D nonhomogeneous space">vgl/vgl_point_3d.h</a>&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__point__2d_8h.html" title="point in projective 2D space">vgl/vgl_homg_point_2d.h</a>&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__point__3d_8h.html" title="point in projective 3D space">vgl/vgl_homg_point_3d.h</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;<a class="code" href="vgl__plane__3d_8h.html" title="a plane in 3D nonhomogeneous space">vgl/vgl_plane_3d.h</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__plane__3d_8h.html" title="homogeneous plane in 3D projective space">vgl/vgl_homg_plane_3d.h</a>&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;<a class="code" href="vgl__homg__line__3d__2__points_8h.html">vgl/vgl_homg_line_3d_2_points.h</a>&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;<a class="code" href="vgl__line__3d__2__points_8h.html" title="non-homogeneous 3D line, represented by 2 points.">vgl/vgl_line_3d_2_points.h</a>&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;<a class="code" href="vgl__line__segment__2d_8h.html">vgl/vgl_line_segment_2d.h</a>&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;<a class="code" href="vgl__line__segment__3d_8h.html" title="line segment in 3D nonhomogeneous space">vgl/vgl_line_segment_3d.h</a>&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="vgl__polygon_8h.html">vgl/vgl_polygon.h</a>&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="vgl__ray__3d_8h.html" title="A 3-d ray defined by an origin and a direction vector.">vgl/vgl_ray_3d.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;vcl_cassert.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;vcl_cmath.h&gt;</span> <span class="comment">// for std::abs(double)</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00028"></a>00028 <span class="keyword">static</span> <span class="keyword">inline</span> T square(T x) { <span class="keywordflow">return</span> x*x; }
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">// Consider numbers smaller than this to be zero</span>
<a name="l00032"></a><a class="code" href="vgl__closest__point_8txx.html#a59ea33ec83674ebe5275dd3910e661f4">00032</a> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vgl__closest__point_8txx.html#a59ea33ec83674ebe5275dd3910e661f4">SMALL_DOUBLE</a> = 1e-12;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">// Borland has trouble deducing template types when parameters have</span>
<a name="l00036"></a>00036 <span class="comment">// type const T instead of T. This occurs in</span>
<a name="l00037"></a>00037 <span class="comment">// vgl_distance2_to_linesegment. The workaround is to make the T const</span>
<a name="l00038"></a>00038 <span class="comment">// parameter a T parameter.</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="preprocessor">#ifdef VCL_BORLAND_55</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span><span class="preprocessor"># define DIST_SQR_TO_LINE_SEG_2D( T, x1, y1, x2, y2, x, y ) \</span>
<a name="l00042"></a>00042 <span class="preprocessor">     vgl_distance2_to_linesegment(T(x1), T(y1), T(x2), T(y2), T(x), T(y) );</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor"># define DIST_SQR_TO_LINE_SEG_3D( T, x1, y1, z1, x2, y2, z2, x, y, z ) \</span>
<a name="l00044"></a>00044 <span class="preprocessor">     vgl_distance2_to_linesegment(T(x1), T(y1), T(z1), T(x2), T(y2), T(z2), T(x), T(y), T(z) );</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00046"></a><a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">00046</a> <span class="preprocessor"></span><span class="preprocessor"># define DIST_SQR_TO_LINE_SEG_2D( T, x1, y1, x2, y2, x, y ) \</span>
<a name="l00047"></a>00047 <span class="preprocessor">     vgl_distance2_to_linesegment(x1, y1, x2, y2, x, y );</span>
<a name="l00048"></a><a class="code" href="vgl__closest__point_8txx.html#a1bc66a07326cd2c1129d34a7f1b0e7a7">00048</a> <span class="preprocessor"></span><span class="preprocessor"># define DIST_SQR_TO_LINE_SEG_3D( T, x1, y1, z1, x2, y2, z2, x, y, z ) \</span>
<a name="l00049"></a>00049 <span class="preprocessor">     vgl_distance2_to_linesegment(x1, y1, z1, x2, y2, z2, x, y, z );</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00054"></a><a class="code" href="vgl__closest__point_8txx.html#abc37d4b6cec685ae09a274d80039e39a">00054</a> <span class="keywordtype">void</span> <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(T&amp; ret_x, T&amp; ret_y,
<a name="l00055"></a>00055                                       T x1, T y1,
<a name="l00056"></a>00056                                       T x2, T y2,
<a name="l00057"></a>00057                                       T x0, T y0)
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059   <span class="comment">// squared distance between endpoints:</span>
<a name="l00060"></a>00060   T ddh = square(x2-x1) + square(y2-y1);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <span class="comment">// squared distance to endpoints:</span>
<a name="l00063"></a>00063   T dd1 = square(x0-x1) + square(y0-y1);
<a name="l00064"></a>00064   T dd2 = square(x0-x2) + square(y0-y2);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   <span class="comment">// if closest to the start point:</span>
<a name="l00067"></a>00067   <span class="keywordflow">if</span> (dd2 &gt; ddh + dd1) { ret_x=x1; ret_y=y1; <span class="keywordflow">return</span>; }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="comment">// if closest to the end point :</span>
<a name="l00070"></a>00070   <span class="keywordflow">if</span> (dd1 &gt; ddh + dd2) { ret_x=x2; ret_y=y2; <span class="keywordflow">return</span>; }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072   <span class="comment">// line through (x0,y0) and perpendicular to the given line is</span>
<a name="l00073"></a>00073   <span class="comment">// the line with equation (x-x0)(x2-x1)+(y-y0)(y2-y1)=0.</span>
<a name="l00074"></a>00074   <span class="comment">// Then it just remains to intersect these two lines:</span>
<a name="l00075"></a>00075   T dx = x2-x1;
<a name="l00076"></a>00076   T dy = y2-y1;
<a name="l00077"></a>00077   <span class="keywordtype">double</span> c = dx*dx+dy*dy;
<a name="l00078"></a>00078   ret_x = T((dx*dx*x0+dy*dy*x1-dx*dy*(y1-y0))/c); <span class="comment">// possible rounding error!</span>
<a name="l00079"></a>00079   ret_y = T((dx*dx*y1+dy*dy*y0-dx*dy*(x1-x0))/c);
<a name="l00080"></a>00080 }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00083"></a><a class="code" href="vgl__closest__point_8txx.html#a3206d46a7ba0a3e5aaa2a2c0f47f3049">00083</a> <span class="keywordtype">void</span> <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(T&amp; ret_x, T&amp; ret_y, T&amp; ret_z,
<a name="l00084"></a>00084                                       T x1, T y1, T z1,
<a name="l00085"></a>00085                                       T x2, T y2, T z2,
<a name="l00086"></a>00086                                       T x, T y, T z)
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088   <span class="comment">// squared distance between endpoints:</span>
<a name="l00089"></a>00089   T ddh = square(x2-x1) + square(y2-y1) + square(z2-z1);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="comment">// squared distance to endpoints :</span>
<a name="l00092"></a>00092   T dd1 = square(x-x1) + square(y-y1) + square(z-z1);
<a name="l00093"></a>00093   T dd2 = square(x-x2) + square(y-y2) + square(z-z2);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <span class="comment">// if closest to the start point:</span>
<a name="l00096"></a>00096   <span class="keywordflow">if</span> (dd2 &gt; ddh + dd1) { ret_x=x1; ret_y=y1; ret_z=z1; <span class="keywordflow">return</span>; }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="comment">// if closest to the end point :</span>
<a name="l00099"></a>00099   <span class="keywordflow">if</span> (dd1 &gt; ddh + dd2) { ret_x=x2; ret_y=y2; ret_z=z2; <span class="keywordflow">return</span>; }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   <span class="comment">// plane through (x,y,z) and orthogonal to the line is a(X-x)+b(Y-y)+c(Z-z)=0</span>
<a name="l00102"></a>00102   <span class="comment">// where (a,b,c) is the direction of the line.</span>
<a name="l00103"></a>00103   T a = x2-x1, b = y2-y1, c = z2-z1;
<a name="l00104"></a>00104   <span class="comment">// The closest point is then the intersection of this plane with the line.</span>
<a name="l00105"></a>00105   <span class="comment">// This point equals (x1,y1,z1) + lambda * (a,b,c), with this lambda:</span>
<a name="l00106"></a>00106   <span class="keywordtype">double</span> lambda = (a*(x-x1)+b*(y-y1)+c*(z-z1))/double(a*a+b*b+c*c);
<a name="l00107"></a>00107   ret_x = x1+T(lambda*a); ret_y = y1+T(lambda*b); ret_z = z1+T(lambda*c);
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00111"></a><a class="code" href="vgl__closest__point_8txx.html#a394bc326dfa025080c0197f475ee792b">00111</a> <span class="keywordtype">int</span> <a class="code" href="vgl__closest__point_8h.html#a394bc326dfa025080c0197f475ee792b" title="Closest point to (x,y) on open polygon (px[i],py[i]).">vgl_closest_point_to_non_closed_polygon</a>(T&amp; ret_x, T&amp; ret_y,
<a name="l00112"></a>00112                                             T <span class="keyword">const</span> px[], T <span class="keyword">const</span> py[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n,
<a name="l00113"></a>00113                                             T x, T y)
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115   assert(n&gt;1);
<a name="l00116"></a>00116   <span class="keywordtype">double</span> dd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,px[0],py[0], px[1],py[1], x,y);
<a name="l00117"></a>00117   <span class="keywordtype">int</span> di = 0;
<a name="l00118"></a>00118   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=1; i+1&lt;n; ++i)
<a name="l00119"></a>00119   {
<a name="l00120"></a>00120     <span class="keywordtype">double</span> nd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,px[i],py[i], px[i+1],py[i+1], x,y);
<a name="l00121"></a>00121     <span class="keywordflow">if</span> (nd&lt;dd) { dd=nd; di=i; }
<a name="l00122"></a>00122   }
<a name="l00123"></a>00123   <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y, px[di],py[di], px[di+1],py[di+1], x,y);
<a name="l00124"></a>00124   <span class="keywordflow">return</span> di;
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00128"></a><a class="code" href="vgl__closest__point_8txx.html#abb4ed2e159b169fc3a27f1ab3ed95cde">00128</a> <span class="keywordtype">int</span> <a class="code" href="vgl__closest__point_8h.html#a394bc326dfa025080c0197f475ee792b" title="Closest point to (x,y) on open polygon (px[i],py[i]).">vgl_closest_point_to_non_closed_polygon</a>(T&amp; ret_x, T&amp; ret_y, T&amp; ret_z,
<a name="l00129"></a>00129                                             T <span class="keyword">const</span> px[], T <span class="keyword">const</span> py[], T <span class="keyword">const</span> pz[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n,
<a name="l00130"></a>00130                                             T x, T y, T z)
<a name="l00131"></a>00131 {
<a name="l00132"></a>00132   assert(n&gt;1);
<a name="l00133"></a>00133   <span class="keywordtype">double</span> dd = <a class="code" href="vgl__closest__point_8txx.html#a1bc66a07326cd2c1129d34a7f1b0e7a7">DIST_SQR_TO_LINE_SEG_3D</a>(T,px[0],py[0],pz[0], px[1],py[1],pz[1], x,y,z);
<a name="l00134"></a>00134   <span class="keywordtype">int</span> di = 0;
<a name="l00135"></a>00135   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=1; i+1&lt;n; ++i)
<a name="l00136"></a>00136   {
<a name="l00137"></a>00137     <span class="keywordtype">double</span> nd = <a class="code" href="vgl__closest__point_8txx.html#a1bc66a07326cd2c1129d34a7f1b0e7a7">DIST_SQR_TO_LINE_SEG_3D</a>(T,px[i],py[i],pz[i], px[i+1],py[i+1],pz[i+1], x,y,z);
<a name="l00138"></a>00138     <span class="keywordflow">if</span> (nd&lt;dd) { dd=nd; di=i; }
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140   <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y,ret_z, px[di],py[di],pz[di],
<a name="l00141"></a>00141                                    px[di+1],py[di+1],pz[di+1], x,y,z);
<a name="l00142"></a>00142   <span class="keywordflow">return</span> di;
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00146"></a><a class="code" href="vgl__closest__point_8txx.html#a0af566b5a2d0098c725772f5ca143861">00146</a> <span class="keywordtype">int</span> <a class="code" href="vgl__closest__point_8h.html#a0af566b5a2d0098c725772f5ca143861" title="Closest point to (x,y) on closed polygon (px[i],py[i]).">vgl_closest_point_to_closed_polygon</a>(T&amp; ret_x, T&amp; ret_y,
<a name="l00147"></a>00147                                         T <span class="keyword">const</span> px[], T <span class="keyword">const</span> py[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n,
<a name="l00148"></a>00148                                         T x, T y)
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150   assert(n&gt;1);
<a name="l00151"></a>00151   <span class="keywordtype">double</span> dd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,px[0],py[0], px[n-1],py[n-1], x,y);
<a name="l00152"></a>00152   <span class="keywordtype">int</span> di = -1;
<a name="l00153"></a>00153   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i+1&lt;n; ++i)
<a name="l00154"></a>00154   {
<a name="l00155"></a>00155     <span class="keywordtype">double</span> nd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,px[i],py[i], px[i+1],py[i+1], x,y);
<a name="l00156"></a>00156     <span class="keywordflow">if</span> (nd&lt;dd) { dd=nd; di=i; }
<a name="l00157"></a>00157   }
<a name="l00158"></a>00158   <span class="keywordflow">if</span> (di == -1) di+=n,
<a name="l00159"></a>00159     <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y, px[0],py[0], px[n-1],py[n-1], x,y);
<a name="l00160"></a>00160   <span class="keywordflow">else</span>
<a name="l00161"></a>00161     <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y, px[di],py[di], px[di+1],py[di+1], x,y);
<a name="l00162"></a>00162   <span class="keywordflow">return</span> di;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00166"></a><a class="code" href="vgl__closest__point_8txx.html#aeff87a038279019906cc5768c7aa77f0">00166</a> <span class="keywordtype">int</span> <a class="code" href="vgl__closest__point_8h.html#a0af566b5a2d0098c725772f5ca143861" title="Closest point to (x,y) on closed polygon (px[i],py[i]).">vgl_closest_point_to_closed_polygon</a>(T&amp; ret_x, T&amp; ret_y, T&amp; ret_z,
<a name="l00167"></a>00167                                         T <span class="keyword">const</span> px[], T <span class="keyword">const</span> py[], T <span class="keyword">const</span> pz[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n,
<a name="l00168"></a>00168                                         T x, T y, T z)
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170   assert(n&gt;1);
<a name="l00171"></a>00171   <span class="keywordtype">double</span> dd = <a class="code" href="vgl__closest__point_8txx.html#a1bc66a07326cd2c1129d34a7f1b0e7a7">DIST_SQR_TO_LINE_SEG_3D</a>(T,px[0],py[0],pz[0], px[n-1],py[n-1],pz[n-1], x,y,z);
<a name="l00172"></a>00172   <span class="keywordtype">int</span> di = -1;
<a name="l00173"></a>00173   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i+1&lt;n; ++i)
<a name="l00174"></a>00174   {
<a name="l00175"></a>00175     <span class="keywordtype">double</span> nd = <a class="code" href="vgl__closest__point_8txx.html#a1bc66a07326cd2c1129d34a7f1b0e7a7">DIST_SQR_TO_LINE_SEG_3D</a>(T,px[i],py[i],pz[i], px[i+1],py[i+1],pz[i+1], x,y,z);
<a name="l00176"></a>00176     <span class="keywordflow">if</span> (nd&lt;dd) { dd=nd; di=i; }
<a name="l00177"></a>00177   }
<a name="l00178"></a>00178   <span class="keywordflow">if</span> (di == -1) di+=n,
<a name="l00179"></a>00179     <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y,ret_z, px[0],py[0],pz[0],
<a name="l00180"></a>00180                                      px[n-1],py[n-1],pz[n-1], x,y,z);
<a name="l00181"></a>00181   <span class="keywordflow">else</span>
<a name="l00182"></a>00182     <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y,ret_z, px[di],py[di],pz[di],
<a name="l00183"></a>00183                                      px[di+1],py[di+1],pz[di+1], x,y,z);
<a name="l00184"></a>00184   <span class="keywordflow">return</span> di;
<a name="l00185"></a>00185 }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00188"></a><a class="code" href="vgl__closest__point_8txx.html#ac897670c5010136ae95ab7618823a35e">00188</a> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__point__2d.html#a87520612fef821a63081160ed701a716" title="Return the point on the given line closest to the origin.">vgl_closest_point_origin</a>(<a class="code" href="classvgl__line__2d.html">vgl_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>)
<a name="l00189"></a>00189 {
<a name="l00190"></a>00190   T d = l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()+l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>();
<a name="l00191"></a>00191   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(-l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a556109b3c8173a446c37eed3b9284674" title="Parameter c of line a*x + b*y + c = 0.">c</a>()/d, -l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*l.<a class="code" href="classvgl__line__2d.html#a556109b3c8173a446c37eed3b9284674" title="Parameter c of line a*x + b*y + c = 0.">c</a>()/d);
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00195"></a><a class="code" href="vgl__closest__point_8txx.html#a46996dd6dce99a8d56ee731d7776ad32">00195</a> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__point__2d.html#a87520612fef821a63081160ed701a716" title="Return the point on the given line closest to the origin.">vgl_closest_point_origin</a>(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(), l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(),
<a name="l00198"></a>00198                               -l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()-l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>());
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00202"></a><a class="code" href="vgl__closest__point_8txx.html#aa22c0d5ac260e598c174326f246bdadd">00202</a> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__point__2d.html#a87520612fef821a63081160ed701a716" title="Return the point on the given line closest to the origin.">vgl_closest_point_origin</a>(<a class="code" href="classvgl__plane__3d.html" title="Represents a Euclidean 3D plane.">vgl_plane_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; pl)
<a name="l00203"></a>00203 {
<a name="l00204"></a>00204   T d = pl.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*pl.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()+pl.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*pl.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()+pl.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*pl.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>();
<a name="l00205"></a>00205   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a>(-pl.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*pl.<a class="code" href="classvgl__plane__3d.html#a45c996b9d1374b0e7131bb3bab1239e3" title="Return constant coefficient.">d</a>()/d, -pl.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*pl.<a class="code" href="classvgl__plane__3d.html#a45c996b9d1374b0e7131bb3bab1239e3" title="Return constant coefficient.">d</a>()/d, -pl.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*pl.<a class="code" href="classvgl__plane__3d.html#a45c996b9d1374b0e7131bb3bab1239e3" title="Return constant coefficient.">d</a>()/d);
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00209"></a><a class="code" href="vgl__closest__point_8txx.html#a0ec37d8e0e7993a746b1f4de0a4accc9">00209</a> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__point__2d.html#a87520612fef821a63081160ed701a716" title="Return the point on the given line closest to the origin.">vgl_closest_point_origin</a>(<a class="code" href="classvgl__homg__plane__3d.html">vgl_homg_plane_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; pl)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a>(pl.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*pl.<a class="code" href="classvgl__homg__plane__3d.html#ab83a333e0676a516bbd02b38f099ab52" title="Return homogeneous scaling coefficient.">d</a>(), pl.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*pl.<a class="code" href="classvgl__homg__plane__3d.html#ab83a333e0676a516bbd02b38f099ab52" title="Return homogeneous scaling coefficient.">d</a>(), pl.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*pl.<a class="code" href="classvgl__homg__plane__3d.html#ab83a333e0676a516bbd02b38f099ab52" title="Return homogeneous scaling coefficient.">d</a>(),
<a name="l00212"></a>00212                               -pl.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*pl.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()-pl.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*pl.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()-pl.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*pl.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>());
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00216"></a><a class="code" href="vgl__closest__point_8txx.html#a0d86622481adfb6d83ea1577cfe59909">00216</a> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__point__2d.html#a87520612fef821a63081160ed701a716" title="Return the point on the given line closest to the origin.">vgl_closest_point_origin</a>(<a class="code" href="classvgl__homg__line__3d__2__points.html" title="Represents a homogeneous 3D line using two points.">vgl_homg_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>)
<a name="l00217"></a>00217 {
<a name="l00218"></a>00218   <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; q = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>();
<a name="l00219"></a>00219   <span class="comment">// The plane through the origin and orthogonal to l is ax+by+cz=0</span>
<a name="l00220"></a>00220   <span class="comment">// where (a,b,c,0) is the point at infinity of l.</span>
<a name="l00221"></a>00221   T a = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>().x(), b = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>().y(), c = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>().z(),
<a name="l00222"></a>00222     d = a*a+b*b+c*c;
<a name="l00223"></a>00223   <span class="comment">// The closest point is then the intersection of this plane with the line l.</span>
<a name="l00224"></a>00224   <span class="comment">// This point equals d * l.point_finite - lambda * l.direction, with lambda:</span>
<a name="l00225"></a>00225   T lambda = a*q.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>()+b*q.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>()+c*q.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>();
<a name="l00226"></a>00226   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a>(d*q.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>()-lambda*a*q.<a class="code" href="classvgl__homg__point__3d.html#a446ca3aacd4e1a50921dba2a76403d17">w</a>(), d*q.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>()-lambda*b*q.<a class="code" href="classvgl__homg__point__3d.html#a446ca3aacd4e1a50921dba2a76403d17">w</a>(), d*q.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>()-lambda*c*q.<a class="code" href="classvgl__homg__point__3d.html#a446ca3aacd4e1a50921dba2a76403d17">w</a>(), d*q.<a class="code" href="classvgl__homg__point__3d.html#a446ca3aacd4e1a50921dba2a76403d17">w</a>());
<a name="l00227"></a>00227 }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00230"></a><a class="code" href="vgl__closest__point_8txx.html#a56680dd1d85d60d4da41f44d2651f215">00230</a> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__point__2d.html#a87520612fef821a63081160ed701a716" title="Return the point on the given line closest to the origin.">vgl_closest_point_origin</a>(<a class="code" href="classvgl__line__3d__2__points.html" title="A class to hold a non-homogeneous representation of a 3D line.">vgl_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>)
<a name="l00231"></a>00231 {
<a name="l00232"></a>00232   <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; q = l.<a class="code" href="classvgl__line__3d__2__points.html#a496c4503594c8c30be6260fc2f698c94" title="Return the first point representing this line.">point1</a>();
<a name="l00233"></a>00233   <span class="comment">// The plane through the origin and orthogonal to l is ax+by+cz=0</span>
<a name="l00234"></a>00234   <span class="comment">// where (a,b,c) is the direction of l.</span>
<a name="l00235"></a>00235   T a = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-q.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>(), b = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-q.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>(), c = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-q.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>(),
<a name="l00236"></a>00236     d = a*a+b*b+c*c;
<a name="l00237"></a>00237   <span class="comment">// The closest point is then the intersection of this plane with the line l.</span>
<a name="l00238"></a>00238   <span class="comment">// This point equals l.point1 - lambda * l.direction, with lambda:</span>
<a name="l00239"></a>00239   T lambda = (a*q.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()+b*q.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()+c*q.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>())/d; <span class="comment">// possible rounding error!</span>
<a name="l00240"></a>00240   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a>(q.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-lambda*a, q.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-lambda*b, q.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-lambda*c);
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00244"></a><a class="code" href="vgl__closest__point_8txx.html#abadd214bbd6b585347551e598190c5b4">00244</a> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__line__2d.html">vgl_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00245"></a>00245                                   <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00246"></a>00246 {
<a name="l00247"></a>00247   T d = l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()+l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>();
<a name="l00248"></a>00248   assert(d!=0); <span class="comment">// line should not be the line at infinity</span>
<a name="l00249"></a>00249   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>((l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*p.<a class="code" href="classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>()-l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*p.<a class="code" href="classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>()-l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a556109b3c8173a446c37eed3b9284674" title="Parameter c of line a*x + b*y + c = 0.">c</a>())/d,
<a name="l00250"></a>00250                          (l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*p.<a class="code" href="classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>()-l.<a class="code" href="classvgl__line__2d.html#a514cb88be30de5ca197bb866878c6c39" title="Parameter a of line a*x + b*y + c = 0.">a</a>()*l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*p.<a class="code" href="classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>()-l.<a class="code" href="classvgl__line__2d.html#a7a58fce013a75f492c9b49ede0eb2b4c" title="Parameter b of line a*x + b*y + c = 0.">b</a>()*l.<a class="code" href="classvgl__line__2d.html#a556109b3c8173a446c37eed3b9284674" title="Parameter c of line a*x + b*y + c = 0.">c</a>())/d);
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00254"></a><a class="code" href="vgl__closest__point_8txx.html#af81a6ebcbf4aa6f19cc00117b587ab50">00254</a> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__homg__line__2d.html" title="Represents a homogeneous 2D line.">vgl_homg_line_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00255"></a>00255                                        <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00256"></a>00256 {
<a name="l00257"></a>00257   T d = l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()+l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>();
<a name="l00258"></a>00258   assert(d!=0); <span class="comment">// line should not be the line at infinity</span>
<a name="l00259"></a>00259   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__2d.html" title="Represents a homogeneous 2D point.">vgl_homg_point_2d&lt;T&gt;</a>(l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()-l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()-l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(),
<a name="l00260"></a>00260                               l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a098f0121fa0b75d2f4171d00a1bf7f31">y</a>()-l.<a class="code" href="classvgl__homg__line__2d.html#a481ccab9a7babd3828c81e45cb46695c" title="Parameter a of line a*x + b*y + c*w = 0.">a</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*p.<a class="code" href="classvgl__homg__point__2d.html#a1d928ee2aae43e7cc7bec7e2db2ad989">x</a>()-l.<a class="code" href="classvgl__homg__line__2d.html#ac239fb51fba33d2e1d61cf880384255b" title="Parameter b of line a*x + b*y + c*w = 0.">b</a>()*l.<a class="code" href="classvgl__homg__line__2d.html#a9fb1d3fe8edd8f30c8d190f721b160a6" title="Parameter c of line a*x + b*y + c*w = 0.">c</a>(),
<a name="l00261"></a>00261                               d);
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00265"></a><a class="code" href="vgl__closest__point_8txx.html#af5bc12a57c24466ea2855b6dbab32fe5">00265</a> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__plane__3d.html" title="Represents a Euclidean 3D plane.">vgl_plane_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00266"></a>00266                                   <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00267"></a>00267 {
<a name="l00268"></a>00268   <span class="comment">// The planes b(x-x0)=a(y-y0) and c(x-x0)=a(z-z0) are orthogonal</span>
<a name="l00269"></a>00269   <span class="comment">// to ax+by+cz+d=0 and go through the point (x0,y0,z0).</span>
<a name="l00270"></a>00270   <span class="comment">// Hence take the intersection of these three planes:</span>
<a name="l00271"></a>00271   T d = l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()+l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()+l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>();
<a name="l00272"></a>00272   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a>(((l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()+l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>())*p.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*p.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#a45c996b9d1374b0e7131bb3bab1239e3" title="Return constant coefficient.">d</a>())/d,
<a name="l00273"></a>00273                          ((l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()+l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>())*p.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*p.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__plane__3d.html#a45c996b9d1374b0e7131bb3bab1239e3" title="Return constant coefficient.">d</a>())/d,
<a name="l00274"></a>00274                             ((l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()+l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>())*p.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-l.<a class="code" href="classvgl__plane__3d.html#ac7e2be012966cfb5f4e54bf1aa1cd0ef" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-l.<a class="code" href="classvgl__plane__3d.html#a3a3e71a133fd2b3c438e3c7a3cc272bb" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-l.<a class="code" href="classvgl__plane__3d.html#a74f68261528e94c03dce88302904647b" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__plane__3d.html#a45c996b9d1374b0e7131bb3bab1239e3" title="Return constant coefficient.">d</a>())/d);
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00278"></a><a class="code" href="vgl__closest__point_8txx.html#a8658024b0f8a47b142a6f114c43cbb46">00278</a> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__homg__plane__3d.html">vgl_homg_plane_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00279"></a>00279                                        <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a>((l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()+l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>())*p.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*p.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ab83a333e0676a516bbd02b38f099ab52" title="Return homogeneous scaling coefficient.">d</a>(),
<a name="l00282"></a>00282                               (l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()+l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>())*p.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*p.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ab83a333e0676a516bbd02b38f099ab52" title="Return homogeneous scaling coefficient.">d</a>(),
<a name="l00283"></a>00283                               (l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()+l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>())*p.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*p.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>()-l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ab83a333e0676a516bbd02b38f099ab52" title="Return homogeneous scaling coefficient.">d</a>(),
<a name="l00284"></a>00284                               l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a7953c1e63b8fe1f02da1815972f1f2a2" title="Return x coefficient.">a</a>()+l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#ad9591fcf5af741af841d889911024e13" title="Return y coefficient.">b</a>()+l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>()*l.<a class="code" href="classvgl__homg__plane__3d.html#a3a87cabef22cb6abfd081b8631fb3ec2" title="Return z coefficient.">c</a>());
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00288"></a><a class="code" href="vgl__closest__point_8txx.html#aeeab42cc94e8bd24bac28db1128ff3af">00288</a> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__polygon.html" title="Store a polygon.">vgl_polygon&lt;T&gt;</a> <span class="keyword">const</span>&amp; poly,
<a name="l00289"></a>00289                                   <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; point,
<a name="l00290"></a>00290                                   <span class="keywordtype">bool</span> closed)
<a name="l00291"></a>00291 {
<a name="l00292"></a>00292   T x=point.<a class="code" href="classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>(), y=point.<a class="code" href="classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00293"></a>00293   <span class="keywordtype">double</span> dd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,poly[0][0].x(),poly[0][0].y(), poly[0][1].x(),poly[0][1].y(), x,y);
<a name="l00294"></a>00294   <span class="keywordtype">int</span> si = 0, di = 0;
<a name="l00295"></a>00295   <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s &lt; poly.<a class="code" href="classvgl__polygon.html#a3ee8b16bf2330687ec376dc945d50ec2">num_sheets</a>(); ++s )
<a name="l00296"></a>00296   {
<a name="l00297"></a>00297     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = (<span class="keywordtype">unsigned</span> int)(poly[s].size());
<a name="l00298"></a>00298     assert( n &gt; 1 );
<a name="l00299"></a>00299     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i+1&lt;n; ++i)
<a name="l00300"></a>00300     {
<a name="l00301"></a>00301       <span class="keywordtype">double</span> nd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,poly[s][i].x(),poly[s][i].y(), poly[s][i+1].x(),poly[s][i+1].y(), x,y);
<a name="l00302"></a>00302       <span class="keywordflow">if</span> (nd&lt;dd) { dd=nd; di=i; si=s; }
<a name="l00303"></a>00303     }
<a name="l00304"></a>00304     <span class="keywordflow">if</span> (closed)
<a name="l00305"></a>00305     {
<a name="l00306"></a>00306       <span class="keywordtype">double</span> nd = <a class="code" href="vgl__closest__point_8txx.html#ad7c18d4481c5e2b6531496ace37cffe7">DIST_SQR_TO_LINE_SEG_2D</a>(T,poly[s][0].x(),poly[s][0].y(), poly[s][n-1].x(),poly[s][n-1].y(), x,y);
<a name="l00307"></a>00307       <span class="keywordflow">if</span> (nd&lt;dd) { dd=nd; di=-1; si=s; }
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309   }
<a name="l00310"></a>00310   T ret_x, ret_y;
<a name="l00311"></a>00311   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = (<span class="keywordtype">unsigned</span> int)(poly[si].size());
<a name="l00312"></a>00312   <span class="keywordflow">if</span> (di == -1)
<a name="l00313"></a>00313     <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y, poly[si][0].x(),poly[si][0].y(), poly[si][n-1].x(),poly[si][n-1].y(), x,y);
<a name="l00314"></a>00314   <span class="keywordflow">else</span>
<a name="l00315"></a>00315     <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(ret_x,ret_y, poly[si][di].x(),poly[si][di].y(), poly[si][di+1].x(),poly[si][di+1].y(), x,y);
<a name="l00316"></a>00316   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a>(T(ret_x), T(ret_y));
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00320"></a>00320 vcl_pair&lt;vgl_homg_point_3d&lt;T&gt;, <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> &gt;
<a name="l00321"></a><a class="code" href="vgl__closest__point_8txx.html#aa130facdc4502eced9945f3e6034e919">00321</a> <a class="code" href="classvgl__homg__line__3d__2__points.html#ab430de2137639a1202184e4973bfbbe7" title="Return the two points of nearest approach of two 3D lines, one on each line.">vgl_closest_points</a>(<a class="code" href="classvgl__homg__line__3d__2__points.html" title="Represents a homogeneous 3D line using two points.">vgl_homg_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; line1,
<a name="l00322"></a>00322                    <a class="code" href="classvgl__homg__line__3d__2__points.html" title="Represents a homogeneous 3D line using two points.">vgl_homg_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; line2)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324   vcl_pair&lt;vgl_homg_point_3d&lt;T&gt;, <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> &gt; ret;
<a name="l00325"></a>00325   <span class="comment">// parallel or equal lines</span>
<a name="l00326"></a>00326   <span class="keywordflow">if</span> ((line1==line2)||(line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>()==line2.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>()))
<a name="l00327"></a>00327   {
<a name="l00328"></a>00328     ret.first = ret.second = line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>();
<a name="l00329"></a>00329   }
<a name="l00330"></a>00330   <span class="comment">// intersecting lines</span>
<a name="l00331"></a>00331   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classvgl__homg__line__2d.html#afd5bd00ae73b3dae747c4651af002b44" title="Are three lines concurrent, i.e., do they pass through a common point?.">concurrent</a>(line1, line2))
<a name="l00332"></a>00332   {
<a name="l00333"></a>00333     ret.first = ret.second = <a class="code" href="classvgl__homg__line__3d__2__points.html#a940c11f17a733fa4f4ba8fae6a217b2c" title="Return the intersection point of two concurrent lines.">intersection</a>(line1, line2);
<a name="l00334"></a>00334   }
<a name="l00335"></a>00335   <span class="comment">// neither parallel nor intersecting</span>
<a name="l00336"></a>00336   <span class="comment">// this is the Paul Bourke code - suitably modified for vxl</span>
<a name="l00337"></a>00337   <span class="keywordflow">else</span>
<a name="l00338"></a>00338   {
<a name="l00339"></a>00339     <span class="comment">// direction of the two lines and of a crossing line</span>
<a name="l00340"></a>00340     <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> p21 = line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>();
<a name="l00341"></a>00341     <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> p43 = line2.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>();
<a name="l00342"></a>00342     <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> p13 = line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>()-line2.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>();
<a name="l00343"></a>00343 
<a name="l00344"></a>00344     T d1343 = p13.<a class="code" href="classvgl__vector__3d.html#a912b0263c344513af0ffa0c07415fe20">x</a>() * p43.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() + p13.<a class="code" href="classvgl__vector__3d.html#af31e8106e9f1aa85bdc70bc40a73dff6">y</a>() * p43.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() + p13.<a class="code" href="classvgl__vector__3d.html#aa655643683e63092c938ea6f2b4459e0">z</a>() * p43.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>();
<a name="l00345"></a>00345     T d4321 = p43.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() + p43.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() + p43.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>();
<a name="l00346"></a>00346     T d1321 = p13.<a class="code" href="classvgl__vector__3d.html#a912b0263c344513af0ffa0c07415fe20">x</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() + p13.<a class="code" href="classvgl__vector__3d.html#af31e8106e9f1aa85bdc70bc40a73dff6">y</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() + p13.<a class="code" href="classvgl__vector__3d.html#aa655643683e63092c938ea6f2b4459e0">z</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>();
<a name="l00347"></a>00347     T d4343 = p43.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() * p43.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() + p43.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() * p43.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() + p43.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>() * p43.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>();
<a name="l00348"></a>00348     T d2121 = p21.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>() + p21.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>() + p21.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>() * p21.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>();
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     T denom = d2121 * d4343 - d4321 * d4321;
<a name="l00351"></a>00351     T numer = d1343 * d4321 - d1321 * d4343;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="comment">// avoid divisions:</span>
<a name="l00354"></a>00354     <span class="comment">//T mua = numer / denom;</span>
<a name="l00355"></a>00355     <span class="comment">//T mub = (d1343 + d4321 * mua) / d4343;</span>
<a name="l00356"></a>00356     T mu_n = d1343 * denom + d4321 * numer;
<a name="l00357"></a>00357     T mu_d = d4343 * denom;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     ret.first.set(denom*line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>().x()+numer*p21.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>(),
<a name="l00360"></a>00360                   denom*line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>().y()+numer*p21.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>(),
<a name="l00361"></a>00361                   denom*line1.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>().z()+numer*p21.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>(),
<a name="l00362"></a>00362                   denom);
<a name="l00363"></a>00363     ret.second.set(mu_d*line2.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>().x()+mu_n*p43.<a class="code" href="classvgl__homg__point__3d.html#aceac2a4dfd00dc600196eb9b9279f5fd">x</a>(),
<a name="l00364"></a>00364                    mu_d*line2.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>().y()+mu_n*p43.<a class="code" href="classvgl__homg__point__3d.html#a054f0d10a7c37b4aebcae08daf66c185">y</a>(),
<a name="l00365"></a>00365                    mu_d*line2.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>().z()+mu_n*p43.<a class="code" href="classvgl__homg__point__3d.html#a7084d86ca9aeca00cf6c9b87bc2bfc92">z</a>(),
<a name="l00366"></a>00366                    mu_d);
<a name="l00367"></a>00367   }
<a name="l00368"></a>00368   <span class="keywordflow">return</span> ret;
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00372"></a><a class="code" href="vgl__closest__point_8txx.html#a8976aaa57e6cada09961a1cf375f45d9">00372</a> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__homg__line__3d__2__points.html" title="Represents a homogeneous 3D line using two points.">vgl_homg_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00373"></a>00373                                        <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00374"></a>00374 {
<a name="l00375"></a>00375   <span class="comment">// Invalid case: the given point is at infinity:</span>
<a name="l00376"></a>00376   <span class="keywordflow">if</span> (p.<a class="code" href="classvgl__homg__point__3d.html#a446ca3aacd4e1a50921dba2a76403d17">w</a>() == 0) <span class="keywordflow">return</span> l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>();
<a name="l00377"></a>00377   <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; q = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#ae6cb92dfc72a233387f8160a7134960c" title="Finite point (Could be an ideal point, if the whole line is at infinity.).">point_finite</a>();
<a name="l00378"></a>00378   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = p-q;
<a name="l00379"></a>00379   <span class="comment">// The plane through p and orthogonal to l is a(x-px)+b(y-py)+c(z-pz)=0</span>
<a name="l00380"></a>00380   <span class="comment">// where (a,b,c,0) is the point at infinity of l.</span>
<a name="l00381"></a>00381   T a = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>().x(), b = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>().y(), c = l.<a class="code" href="classvgl__homg__line__3d__2__points.html#adf64bca8541c07bef82e24f3a75671c2" title="Infinite point: the intersection of the line with the plane at infinity.">point_infinite</a>().z(),
<a name="l00382"></a>00382     d = a*a+b*b+c*c;
<a name="l00383"></a>00383   <span class="comment">// The closest point is then the intersection of this plane with the line l.</span>
<a name="l00384"></a>00384   <span class="comment">// This point equals d * l.point_finite + lambda * l.direction, with lambda:</span>
<a name="l00385"></a>00385   T lambda = a*v.<a class="code" href="classvgl__vector__3d.html#a912b0263c344513af0ffa0c07415fe20">x</a>()+b*v.<a class="code" href="classvgl__vector__3d.html#af31e8106e9f1aa85bdc70bc40a73dff6">y</a>()+c*v.<a class="code" href="classvgl__vector__3d.html#aa655643683e63092c938ea6f2b4459e0">z</a>();
<a name="l00386"></a>00386   <span class="keywordflow">return</span> <a class="code" href="classvgl__homg__point__3d.html" title="Represents a homogeneous 3D point.">vgl_homg_point_3d&lt;T&gt;</a>(d*q.x()+lambda*a*q.w(), d*q.y()+lambda*b*q.w(), d*q.z()+lambda*c*q.w(), d*q.w());
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00390"></a><a class="code" href="vgl__closest__point_8txx.html#aa5cb1f732ea22c2786a6b781c469b5c5">00390</a> <span class="keywordtype">double</span> <a class="code" href="classvgl__point__3d.html#aa5cb1f732ea22c2786a6b781c469b5c5" title="Return the point on the given line which is closest to the given point.">vgl_closest_point_t</a>(<a class="code" href="classvgl__line__3d__2__points.html" title="A class to hold a non-homogeneous representation of a 3D line.">vgl_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00391"></a>00391                            <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00392"></a>00392 {
<a name="l00393"></a>00393   <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; q = l.<a class="code" href="classvgl__line__3d__2__points.html#a496c4503594c8c30be6260fc2f698c94" title="Return the first point representing this line.">point1</a>();
<a name="l00394"></a>00394   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = p-q;
<a name="l00395"></a>00395   <span class="comment">// The plane through p and orthogonal to l is a(x-px)+b(y-py)+c(z-pz)=0</span>
<a name="l00396"></a>00396   <span class="comment">// where (a,b,c,0) is the direction of l.</span>
<a name="l00397"></a>00397   <span class="keywordtype">double</span> a = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-q.x(), b = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-q.y(),
<a name="l00398"></a>00398          c = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-q.z(), d = a*a+b*b+c*c;
<a name="l00399"></a>00399   <span class="comment">// The closest point is then the intersection of this plane with the line l.</span>
<a name="l00400"></a>00400   <span class="comment">// This point equals l.point1 + lambda * l.direction, with lambda:</span>
<a name="l00401"></a>00401   <span class="keywordtype">double</span> lambda = (a*v.<a class="code" href="classvgl__vector__3d.html#a912b0263c344513af0ffa0c07415fe20">x</a>()+b*v.<a class="code" href="classvgl__vector__3d.html#af31e8106e9f1aa85bdc70bc40a73dff6">y</a>()+c*v.<a class="code" href="classvgl__vector__3d.html#aa655643683e63092c938ea6f2b4459e0">z</a>())/d;
<a name="l00402"></a>00402   <span class="keywordflow">return</span> lambda;
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <span class="comment">// NB This function could be written in terms of the preceding function vgl_closest_point_t()</span>
<a name="l00406"></a>00406 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00407"></a><a class="code" href="vgl__closest__point_8txx.html#ae46ed44ef525b7700e20415327fd3441">00407</a> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__line__3d__2__points.html" title="A class to hold a non-homogeneous representation of a 3D line.">vgl_line_3d_2_points&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00408"></a>00408                                   <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00409"></a>00409 {
<a name="l00410"></a>00410   <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; q = l.<a class="code" href="classvgl__line__3d__2__points.html#a496c4503594c8c30be6260fc2f698c94" title="Return the first point representing this line.">point1</a>();
<a name="l00411"></a>00411   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = p-q;
<a name="l00412"></a>00412   <span class="comment">// The plane through p and orthogonal to l is a(x-px)+b(y-py)+c(z-pz)=0</span>
<a name="l00413"></a>00413   <span class="comment">// where (a,b,c,0) is the direction of l.</span>
<a name="l00414"></a>00414   T a = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>()-q.x(), b = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>()-q.y(), c = l.<a class="code" href="classvgl__line__3d__2__points.html#abc46ab27df47ef070e744455dcc8a84e" title="Return the second point representing this line.">point2</a>().<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>()-q.z(),
<a name="l00415"></a>00415     d = a*a+b*b+c*c;
<a name="l00416"></a>00416   <span class="comment">// The closest point is then the intersection of this plane with the line l.</span>
<a name="l00417"></a>00417   <span class="comment">// This point equals l.point1 + lambda * l.direction, with lambda:</span>
<a name="l00418"></a>00418   T lambda = (a*v.<a class="code" href="classvgl__vector__3d.html#a912b0263c344513af0ffa0c07415fe20">x</a>()+b*v.<a class="code" href="classvgl__vector__3d.html#af31e8106e9f1aa85bdc70bc40a73dff6">y</a>()+c*v.<a class="code" href="classvgl__vector__3d.html#aa655643683e63092c938ea6f2b4459e0">z</a>())/d; <span class="comment">// possible rounding error!</span>
<a name="l00419"></a>00419   <span class="keywordflow">return</span> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a>(q.x()+lambda*a, q.y()+lambda*b, q.z()+lambda*c);
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 <span class="comment">//: Return the points of closest approach on 2 3D lines.</span>
<a name="l00423"></a>00423 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00424"></a>00424 vcl_pair&lt;vgl_point_3d&lt;T&gt;, <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> &gt;
<a name="l00425"></a><a class="code" href="vgl__closest__point_8txx.html#ae737c9ef35d805811b6e5664465b4031">00425</a> <a class="code" href="classvgl__homg__line__3d__2__points.html#ab430de2137639a1202184e4973bfbbe7" title="Return the two points of nearest approach of two 3D lines, one on each line.">vgl_closest_points</a>(<span class="keyword">const</span> <a class="code" href="classvgl__line__3d__2__points.html" title="A class to hold a non-homogeneous representation of a 3D line.">vgl_line_3d_2_points&lt;T&gt;</a>&amp; l1,
<a name="l00426"></a>00426                    <span class="keyword">const</span> <a class="code" href="classvgl__line__3d__2__points.html" title="A class to hold a non-homogeneous representation of a 3D line.">vgl_line_3d_2_points&lt;T&gt;</a>&amp; l2,
<a name="l00427"></a>00427                    <span class="keywordtype">bool</span>* unique<span class="comment">/*=0*/</span>)
<a name="l00428"></a>00428 {
<a name="l00429"></a>00429   vcl_pair&lt;vgl_point_3d&lt;T&gt;, <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> &gt; ret;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   <span class="comment">// Get the parametric equation of each line</span>
<a name="l00432"></a>00432   <span class="comment">// l1: p(s) = p1 + su;  u = p2 - p1</span>
<a name="l00433"></a>00433   <span class="comment">// l2: q(t) = q1 + tv;  v = q2 - q1</span>
<a name="l00434"></a>00434   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> u = l1.<a class="code" href="classvgl__line__3d__2__points.html#a8b12d362528e44d7c0967db3132d5fa2" title="Return the direction vector of this line (not normalised - but perhaps it should be, like other line classes?).">direction</a>();
<a name="l00435"></a>00435   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = l2.<a class="code" href="classvgl__line__3d__2__points.html#a8b12d362528e44d7c0967db3132d5fa2" title="Return the direction vector of this line (not normalised - but perhaps it should be, like other line classes?).">direction</a>();
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="comment">// Get a vector w from first point on line1 to first point on line2</span>
<a name="l00438"></a>00438   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> w = l1.<a class="code" href="classvgl__line__3d__2__points.html#a496c4503594c8c30be6260fc2f698c94" title="Return the first point representing this line.">point1</a>() - l2.<a class="code" href="classvgl__line__3d__2__points.html#a496c4503594c8c30be6260fc2f698c94" title="Return the first point representing this line.">point1</a>();
<a name="l00439"></a>00439 
<a name="l00440"></a>00440   <span class="keywordtype">double</span> a = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(u,u);
<a name="l00441"></a>00441   <span class="keywordtype">double</span> b = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(u,v);
<a name="l00442"></a>00442   <span class="keywordtype">double</span> c = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(v,v);
<a name="l00443"></a>00443   <span class="keywordtype">double</span> d = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(u,w);
<a name="l00444"></a>00444   <span class="keywordtype">double</span> e = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(v,w);
<a name="l00445"></a>00445 
<a name="l00446"></a>00446   <span class="comment">// Calculate the parameters s,t for the closest point on each line</span>
<a name="l00447"></a>00447   <span class="keywordtype">double</span> denom = a*c - b*b; <span class="comment">// should always be non-negative</span>
<a name="l00448"></a>00448   <span class="keywordflow">if</span> (denom&lt;0.0) denom = 0.0;
<a name="l00449"></a>00449   <span class="keywordflow">if</span> (denom&gt;<a class="code" href="vgl__closest__point_8txx.html#a59ea33ec83674ebe5275dd3910e661f4">SMALL_DOUBLE</a>)
<a name="l00450"></a>00450   {
<a name="l00451"></a>00451     <span class="keywordtype">double</span> s = (b*e - c*d) / denom;
<a name="l00452"></a>00452     <span class="keywordtype">double</span> t = (a*e - b*d) / denom;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     ret.first = l1.<a class="code" href="classvgl__line__3d__2__points.html#a70199980b5cd8bf9fc17b9369072d687" title="Return a point on the line defined by a scalar parameter t such that t=0.0 at point1 and t=1...">point_t</a>(s);
<a name="l00455"></a>00455     ret.second = l2.<a class="code" href="classvgl__line__3d__2__points.html#a70199980b5cd8bf9fc17b9369072d687" title="Return a point on the line defined by a scalar parameter t such that t=0.0 at point1 and t=1...">point_t</a>(t);
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (unique) *unique = <span class="keyword">true</span>;
<a name="l00457"></a>00457   }
<a name="l00458"></a>00458   <span class="keywordflow">else</span>
<a name="l00459"></a>00459   {
<a name="l00460"></a>00460     <span class="comment">// Lines are parallel or collinear.</span>
<a name="l00461"></a>00461     <span class="comment">// Arbitrarily, return the first point on line1 and the closest point on line2.</span>
<a name="l00462"></a>00462     <span class="keywordtype">double</span> s = 0.0;
<a name="l00463"></a>00463     <span class="keywordtype">double</span> t = (b&gt;c ? d/b : e/c);
<a name="l00464"></a>00464     ret.first = l1.<a class="code" href="classvgl__line__3d__2__points.html#a70199980b5cd8bf9fc17b9369072d687" title="Return a point on the line defined by a scalar parameter t such that t=0.0 at point1 and t=1...">point_t</a>(s);
<a name="l00465"></a>00465     ret.second = l2.<a class="code" href="classvgl__line__3d__2__points.html#a70199980b5cd8bf9fc17b9369072d687" title="Return a point on the line defined by a scalar parameter t such that t=0.0 at point1 and t=1...">point_t</a>(t);
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (unique) *unique = <span class="keyword">false</span>;
<a name="l00467"></a>00467   }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469   <span class="keywordflow">return</span> ret;
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00473"></a><a class="code" href="vgl__closest__point_8txx.html#a642fc332dd054f689f0fcf697ad8b867">00473</a> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p,
<a name="l00474"></a>00474                                   <a class="code" href="classvgl__ray__3d.html" title="Represents a 3-d ray.">vgl_ray_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; r)
<a name="l00475"></a>00475 {
<a name="l00476"></a>00476   <a class="code" href="classvgl__line__3d__2__points.html" title="A class to hold a non-homogeneous representation of a 3D line.">vgl_line_3d_2_points&lt;T&gt;</a> l2(r.<a class="code" href="classvgl__ray__3d.html#ad4ea7c060cf71c338578456a98a162d1" title="Accessors.">origin</a>(), r.<a class="code" href="classvgl__ray__3d.html#ad4ea7c060cf71c338578456a98a162d1" title="Accessors.">origin</a>()+r.<a class="code" href="classvgl__ray__3d.html#ac1194361067f4de72511417e3e380168">direction</a>());
<a name="l00477"></a>00477   <span class="keywordflow">return</span> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(p,l2);
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="comment">//: Return the points of closest approach on 2 3D line segments.</span>
<a name="l00481"></a>00481 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00482"></a>00482 vcl_pair&lt;vgl_point_3d&lt;T&gt;, <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> &gt;
<a name="l00483"></a><a class="code" href="vgl__closest__point_8txx.html#a5ee349a624ecc4a40a30bf4511b80346">00483</a> <a class="code" href="classvgl__homg__line__3d__2__points.html#ab430de2137639a1202184e4973bfbbe7" title="Return the two points of nearest approach of two 3D lines, one on each line.">vgl_closest_points</a>(<a class="code" href="classvgl__line__segment__3d.html" title="Represents a 3D line segment using two points.">vgl_line_segment_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l1,
<a name="l00484"></a>00484                    <a class="code" href="classvgl__line__segment__3d.html" title="Represents a 3D line segment using two points.">vgl_line_segment_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; l2,
<a name="l00485"></a>00485                    <span class="keywordtype">bool</span>* unique<span class="comment">/*=0*/</span>)
<a name="l00486"></a>00486 {
<a name="l00487"></a>00487   vcl_pair&lt;vgl_point_3d&lt;T&gt;, <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> &gt; ret;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489   <span class="comment">// Get the parametric equation of each line</span>
<a name="l00490"></a>00490   <span class="comment">// l1: p(s) = p1 + su;  u = p2 - p1</span>
<a name="l00491"></a>00491   <span class="comment">// l2: q(t) = q1 + tv;  v = q2 - q1</span>
<a name="l00492"></a>00492   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> u = l1.<a class="code" href="classvgl__line__segment__3d.html#acfdd8d0dfd52f85d6ba5baa1381ed99b" title="Return the direction vector of this line (not normalised - but perhaps it should be, like other line classes?).">direction</a>();
<a name="l00493"></a>00493   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> <a class="code" href="vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = l2.<a class="code" href="classvgl__line__segment__3d.html#acfdd8d0dfd52f85d6ba5baa1381ed99b" title="Return the direction vector of this line (not normalised - but perhaps it should be, like other line classes?).">direction</a>();
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <span class="comment">// Get a vector w from first point on line2 to first point on line1</span>
<a name="l00496"></a>00496   <a class="code" href="classvgl__vector__3d.html" title="Direction vector in Euclidean 3D space, templated by type of element.">vgl_vector_3d&lt;T&gt;</a> w = l1.<a class="code" href="classvgl__line__segment__3d.html#a379621138ad9c9fc54b7dea6b5108dbd">point1</a>() - l2.<a class="code" href="classvgl__line__segment__3d.html#a379621138ad9c9fc54b7dea6b5108dbd">point1</a>();
<a name="l00497"></a>00497 
<a name="l00498"></a>00498   <span class="keywordtype">double</span> a = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(u,u); assert(a&gt;0.0);
<a name="l00499"></a>00499   <span class="keywordtype">double</span> b = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(u,v);
<a name="l00500"></a>00500   <span class="keywordtype">double</span> c = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(v,v); assert(c&gt;0.0);
<a name="l00501"></a>00501   <span class="keywordtype">double</span> d = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(u,w);
<a name="l00502"></a>00502   <span class="keywordtype">double</span> e = <a class="code" href="classvgl__vector__2d.html#af8601d1894aed553c33ab9d9a2c5af48" title="dot product or inner product of two vectors.">dot_product</a>(v,w);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="comment">// Calculate the parameters s,t for the closest point on each infinite line</span>
<a name="l00505"></a>00505   <span class="keywordtype">double</span> denom = a*c - b*b; <span class="comment">// should always be non-negative</span>
<a name="l00506"></a>00506   assert(denom&gt;=0.0);
<a name="l00507"></a>00507 
<a name="l00508"></a>00508   <span class="comment">// Check whether the closest points on the infinite lines are also</span>
<a name="l00509"></a>00509   <span class="comment">// on the finite line segments.</span>
<a name="l00510"></a>00510   <span class="comment">// Consider the square [0,1][0,1] in the plane (s,t).</span>
<a name="l00511"></a>00511   <span class="comment">// Closest points (s,t) on the infinite lines may lie outside this square.</span>
<a name="l00512"></a>00512   <span class="comment">// Closest points on line segments will then lie on the boundary of this square.</span>
<a name="l00513"></a>00513   <span class="comment">// Hence, need to check either 1 or 2 edges of the square.</span>
<a name="l00514"></a>00514   <span class="keywordtype">double</span> s_numer;
<a name="l00515"></a>00515   <span class="keywordtype">double</span> s_denom = denom;
<a name="l00516"></a>00516   <span class="keywordtype">double</span> t_numer;
<a name="l00517"></a>00517   <span class="keywordtype">double</span> t_denom = denom;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519   <span class="keywordflow">if</span> (denom &lt; <a class="code" href="vgl__closest__point_8txx.html#a59ea33ec83674ebe5275dd3910e661f4">SMALL_DOUBLE</a>)
<a name="l00520"></a>00520   {
<a name="l00521"></a>00521     <span class="comment">// Lines are parallel or collinear</span>
<a name="l00522"></a>00522     s_numer = 0.0;
<a name="l00523"></a>00523     s_denom = 1.0;
<a name="l00524"></a>00524     t_numer = e;
<a name="l00525"></a>00525     t_denom = c;
<a name="l00526"></a>00526     <span class="keywordflow">if</span> (unique) *unique = <span class="keyword">false</span>; <span class="comment">// assume this for now; check below.</span>
<a name="l00527"></a>00527   }
<a name="l00528"></a>00528   <span class="keywordflow">else</span>
<a name="l00529"></a>00529   {
<a name="l00530"></a>00530     <span class="comment">// Calculate the closest points on the infinite lines</span>
<a name="l00531"></a>00531     s_numer = (b*e - c*d);
<a name="l00532"></a>00532     t_numer = (a*e - b*d);
<a name="l00533"></a>00533     <span class="keywordflow">if</span> (s_numer &lt; 0.0)
<a name="l00534"></a>00534     {
<a name="l00535"></a>00535       <span class="comment">// If sc&lt;0 then the s=0 edge is a candidate</span>
<a name="l00536"></a>00536       s_numer = 0.0;
<a name="l00537"></a>00537       t_numer = e;
<a name="l00538"></a>00538       t_denom = c;
<a name="l00539"></a>00539     }
<a name="l00540"></a>00540     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s_numer &gt; s_denom)
<a name="l00541"></a>00541     {
<a name="l00542"></a>00542       <span class="comment">// If sc&gt;1 then the s=1 edge is a candidate</span>
<a name="l00543"></a>00543       s_numer = s_denom;
<a name="l00544"></a>00544       t_numer = e + b;
<a name="l00545"></a>00545       t_denom = c;
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547     <span class="keywordflow">if</span> (unique) *unique = <span class="keyword">true</span>;
<a name="l00548"></a>00548   }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550   <span class="keywordflow">if</span> (t_numer &lt; 0.0)
<a name="l00551"></a>00551   {
<a name="l00552"></a>00552     <span class="comment">// If tc&lt;0 then the t=0 edge is a candidate</span>
<a name="l00553"></a>00553     t_numer = 0.0;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <span class="comment">// Recalculate sc for this edge</span>
<a name="l00556"></a>00556     <span class="keywordflow">if</span> (-d &lt; 0.0)
<a name="l00557"></a>00557       s_numer = 0.0;
<a name="l00558"></a>00558     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (-d &gt; a)
<a name="l00559"></a>00559       s_numer = s_denom;
<a name="l00560"></a>00560     <span class="keywordflow">else</span>
<a name="l00561"></a>00561     {
<a name="l00562"></a>00562       s_numer = -d;
<a name="l00563"></a>00563       s_denom = a;
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565   }
<a name="l00566"></a>00566   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t_numer &gt; t_denom)
<a name="l00567"></a>00567   {
<a name="l00568"></a>00568     <span class="comment">// If tc&gt;1 then the t=1 edge is a candidate</span>
<a name="l00569"></a>00569     t_numer = t_denom;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571     <span class="comment">// Recalculate sc for this edge</span>
<a name="l00572"></a>00572     <span class="keywordflow">if</span> ((-d + b) &lt; 0.0)
<a name="l00573"></a>00573       s_numer = 0.0;
<a name="l00574"></a>00574     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((-d + b) &gt; a)
<a name="l00575"></a>00575       s_numer = s_denom;
<a name="l00576"></a>00576     <span class="keywordflow">else</span>
<a name="l00577"></a>00577     {
<a name="l00578"></a>00578       s_numer = (-d + b);
<a name="l00579"></a>00579       s_denom = a;
<a name="l00580"></a>00580     }
<a name="l00581"></a>00581   }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583   <span class="comment">// Now calculate the required values of (s,t)</span>
<a name="l00584"></a>00584   <span class="keywordtype">double</span> s = (vcl_abs(s_numer) &lt; <a class="code" href="vgl__closest__point_8txx.html#a59ea33ec83674ebe5275dd3910e661f4">SMALL_DOUBLE</a> ? 0.0 : s_numer / s_denom);
<a name="l00585"></a>00585   <span class="keywordtype">double</span> t = (vcl_abs(t_numer) &lt; <a class="code" href="vgl__closest__point_8txx.html#a59ea33ec83674ebe5275dd3910e661f4">SMALL_DOUBLE</a> ? 0.0 : t_numer / t_denom);
<a name="l00586"></a>00586 
<a name="l00587"></a>00587   <span class="comment">// Need to verify whether returned closest points are unique</span>
<a name="l00588"></a>00588   <span class="comment">// in the case of parallel/collinear line segments</span>
<a name="l00589"></a>00589   <span class="keywordflow">if</span> (unique &amp;&amp; ! *unique)
<a name="l00590"></a>00590   {
<a name="l00591"></a>00591     <span class="keywordflow">if</span> ((s==0.0 || s==1.0) &amp;&amp; (t==0.0 || t==1.0))
<a name="l00592"></a>00592       *unique = <span class="keyword">true</span>;
<a name="l00593"></a>00593   }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595   ret.first = l1.<a class="code" href="classvgl__line__segment__3d.html#a0f223f2395210ca2e1ec6cea1a49aa8d" title="Return a point on the line defined by a scalar parameter t.">point_t</a>(s);
<a name="l00596"></a>00596   ret.second = l2.<a class="code" href="classvgl__line__segment__3d.html#a0f223f2395210ca2e1ec6cea1a49aa8d" title="Return a point on the line defined by a scalar parameter t.">point_t</a>(t);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <span class="keywordflow">return</span> ret;
<a name="l00599"></a>00599 }
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00602"></a><a class="code" href="vgl__closest__point_8txx.html#a976c6d515544f0a62bda4c020586b646">00602</a> <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__line__segment__2d.html" title="Represents a 2D line segment using two points.">vgl_line_segment_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00603"></a>00603                                   <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00604"></a>00604 {
<a name="l00605"></a>00605   <a class="code" href="classvgl__point__2d.html" title="Represents a cartesian 2D point.">vgl_point_2d&lt;T&gt;</a> q;
<a name="l00606"></a>00606   <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(q.<a class="code" href="classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>(), q.<a class="code" href="classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>(),
<a name="l00607"></a>00607                                    l.<a class="code" href="classvgl__line__segment__2d.html#ad1e23f30e475e661c64bb824a81d9f5d" title="One end-point of the line segment.">point1</a>().x(), l.<a class="code" href="classvgl__line__segment__2d.html#ad1e23f30e475e661c64bb824a81d9f5d" title="One end-point of the line segment.">point1</a>().y(),
<a name="l00608"></a>00608                                    l.<a class="code" href="classvgl__line__segment__2d.html#aa4d4b6ed8709f9969ef8cd76d3158a0e" title="The other end-point of the line segment.">point2</a>().x(), l.<a class="code" href="classvgl__line__segment__2d.html#aa4d4b6ed8709f9969ef8cd76d3158a0e" title="The other end-point of the line segment.">point2</a>().y(),
<a name="l00609"></a>00609                                    p.<a class="code" href="classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>(), p.<a class="code" href="classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>());
<a name="l00610"></a>00610   <span class="keywordflow">return</span> q;
<a name="l00611"></a>00611 }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00614"></a><a class="code" href="vgl__closest__point_8txx.html#a44156df6f43e590670b5365edae54fa9">00614</a> <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <a class="code" href="classvgl__line__2d.html#ab7e27e5e8d19a6e749eb2526b890d0ab" title="Return the point on the given line closest to the given point.">vgl_closest_point</a>(<a class="code" href="classvgl__line__segment__3d.html" title="Represents a 3D line segment using two points.">vgl_line_segment_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; <a class="code" href="vgl__homg__line__2d_8h.html#a1cb503ddd20ff3cf9588d2b5abd202d8">l</a>,
<a name="l00615"></a>00615                                   <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> <span class="keyword">const</span>&amp; p)
<a name="l00616"></a>00616 {
<a name="l00617"></a>00617  <a class="code" href="classvgl__point__3d.html">vgl_point_3d&lt;T&gt;</a> q;
<a name="l00618"></a>00618  <a class="code" href="vgl__closest__point_8h.html#aef096544c1b9077f9040177e7ca24341" title="Closest point to (x,y) on the line segment (x1,y1)-(x2,y2).">vgl_closest_point_to_linesegment</a>(q.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>(), q.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>(), q.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>(),
<a name="l00619"></a>00619                                   l.<a class="code" href="classvgl__line__segment__3d.html#a379621138ad9c9fc54b7dea6b5108dbd">point1</a>().<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>(), l.<a class="code" href="classvgl__line__segment__3d.html#a379621138ad9c9fc54b7dea6b5108dbd">point1</a>().<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>(), l.<a class="code" href="classvgl__line__segment__3d.html#a379621138ad9c9fc54b7dea6b5108dbd">point1</a>().<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>(),
<a name="l00620"></a>00620                                   l.<a class="code" href="classvgl__line__segment__3d.html#a82a135ac4158cd7d13cd3c023e4f43b2">point2</a>().<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>(), l.<a class="code" href="classvgl__line__segment__3d.html#a82a135ac4158cd7d13cd3c023e4f43b2">point2</a>().<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>(), l.<a class="code" href="classvgl__line__segment__3d.html#a82a135ac4158cd7d13cd3c023e4f43b2">point2</a>().<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>(),
<a name="l00621"></a>00621                                   p.<a class="code" href="classvgl__point__3d.html#a1ad910614a911c7d322c086438d6441d">x</a>(), p.<a class="code" href="classvgl__point__3d.html#a6fcfebd50c3f8570fafd49df0687feb2">y</a>(), p.<a class="code" href="classvgl__point__3d.html#a477066fab00b63b2641305fb7e41fb62">z</a>());
<a name="l00622"></a>00622  <span class="keywordflow">return</span> q;
<a name="l00623"></a>00623 }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="preprocessor">#undef DIST_SQR_TO_LINE_SEG_2D</span>
<a name="l00626"></a>00626 <span class="preprocessor"></span><span class="preprocessor">#undef DIST_SQR_TO_LINE_SEG_3D</span>
<a name="l00627"></a>00627 <span class="preprocessor"></span>
<a name="l00628"></a>00628 <span class="preprocessor">#undef VGL_CLOSEST_POINT_INSTANTIATE</span>
<a name="l00629"></a><a class="code" href="vgl__closest__point_8txx.html#a5b7c5a921d6680b658f0fb270c813802">00629</a> <span class="preprocessor"></span><span class="preprocessor">#define VGL_CLOSEST_POINT_INSTANTIATE(T) \</span>
<a name="l00630"></a>00630 <span class="preprocessor">template void vgl_closest_point_to_linesegment(T&amp;,T&amp;,T,T,T,T,T,T); \</span>
<a name="l00631"></a>00631 <span class="preprocessor">template void vgl_closest_point_to_linesegment(T&amp;,T&amp;,T&amp;,T,T,T,T,T,T,T,T,T); \</span>
<a name="l00632"></a>00632 <span class="preprocessor">template int vgl_closest_point_to_non_closed_polygon(T&amp;,T&amp;,T const[],T const[],unsigned int,T,T); \</span>
<a name="l00633"></a>00633 <span class="preprocessor">template int vgl_closest_point_to_non_closed_polygon(T&amp;,T&amp;,T&amp;,T const[],T const[],T const[],unsigned int,T,T,T); \</span>
<a name="l00634"></a>00634 <span class="preprocessor">template int vgl_closest_point_to_closed_polygon(T&amp;,T&amp;,T const[],T const[],unsigned int,T,T); \</span>
<a name="l00635"></a>00635 <span class="preprocessor">template int vgl_closest_point_to_closed_polygon(T&amp;,T&amp;,T&amp;,T const[],T const[],T const[],unsigned int,T,T,T); \</span>
<a name="l00636"></a>00636 <span class="preprocessor">template vgl_point_2d&lt;T &gt; vgl_closest_point_origin(vgl_line_2d&lt;T &gt;const&amp; l); \</span>
<a name="l00637"></a>00637 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point_origin(vgl_plane_3d&lt;T &gt; const&amp; pl); \</span>
<a name="l00638"></a>00638 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point_origin(vgl_line_3d_2_points&lt;T &gt; const&amp; l); \</span>
<a name="l00639"></a>00639 <span class="preprocessor">template vgl_homg_point_2d&lt;T &gt; vgl_closest_point_origin(vgl_homg_line_2d&lt;T &gt;const&amp; l); \</span>
<a name="l00640"></a>00640 <span class="preprocessor">template vgl_homg_point_3d&lt;T &gt; vgl_closest_point_origin(vgl_homg_plane_3d&lt;T &gt; const&amp; pl); \</span>
<a name="l00641"></a>00641 <span class="preprocessor">template vgl_homg_point_3d&lt;T &gt; vgl_closest_point_origin(vgl_homg_line_3d_2_points&lt;T &gt; const&amp; l); \</span>
<a name="l00642"></a>00642 <span class="preprocessor">template vgl_point_2d&lt;T &gt; vgl_closest_point(vgl_line_2d&lt;T &gt;const&amp;,vgl_point_2d&lt;T &gt;const&amp;); \</span>
<a name="l00643"></a>00643 <span class="preprocessor">template vgl_point_2d&lt;T &gt; vgl_closest_point(vgl_point_2d&lt;T &gt;const&amp;,vgl_line_2d&lt;T &gt;const&amp;); \</span>
<a name="l00644"></a>00644 <span class="preprocessor">template double vgl_closest_point_t(vgl_line_3d_2_points&lt;T &gt;const&amp;,vgl_point_3d&lt;T &gt;const&amp;); \</span>
<a name="l00645"></a>00645 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point(vgl_line_3d_2_points&lt;T &gt;const&amp;,vgl_point_3d&lt;T &gt;const&amp;); \</span>
<a name="l00646"></a>00646 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point(vgl_point_3d&lt;T &gt; const&amp; p,vgl_ray_3d&lt;T &gt; const&amp; r); \</span>
<a name="l00647"></a>00647 <span class="preprocessor">template vgl_homg_point_2d&lt;T &gt; vgl_closest_point(vgl_homg_line_2d&lt;T &gt;const&amp;,vgl_homg_point_2d&lt;T &gt;const&amp;); \</span>
<a name="l00648"></a>00648 <span class="preprocessor">template vgl_homg_point_2d&lt;T &gt; vgl_closest_point(vgl_homg_point_2d&lt;T &gt;const&amp;,vgl_homg_line_2d&lt;T &gt;const&amp;); \</span>
<a name="l00649"></a>00649 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point(vgl_plane_3d&lt;T &gt;const&amp;,vgl_point_3d&lt;T &gt;const&amp;); \</span>
<a name="l00650"></a>00650 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point(vgl_point_3d&lt;T &gt;const&amp;,vgl_plane_3d&lt;T &gt;const&amp;); \</span>
<a name="l00651"></a>00651 <span class="preprocessor">template vgl_homg_point_3d&lt;T &gt; vgl_closest_point(vgl_homg_plane_3d&lt;T &gt;const&amp;,vgl_homg_point_3d&lt;T &gt;const&amp;); \</span>
<a name="l00652"></a>00652 <span class="preprocessor">template vgl_homg_point_3d&lt;T &gt; vgl_closest_point(vgl_homg_point_3d&lt;T &gt;const&amp;,vgl_homg_plane_3d&lt;T &gt;const&amp;); \</span>
<a name="l00653"></a>00653 <span class="preprocessor">template vgl_point_2d&lt;T &gt; vgl_closest_point(vgl_polygon&lt;T &gt;const&amp;,vgl_point_2d&lt;T &gt;const&amp;,bool); \</span>
<a name="l00654"></a>00654 <span class="preprocessor">template vcl_pair&lt;vgl_homg_point_3d&lt;T &gt;,vgl_homg_point_3d&lt;T &gt; &gt; \</span>
<a name="l00655"></a>00655 <span class="preprocessor">         vgl_closest_points(vgl_homg_line_3d_2_points&lt;T &gt;const&amp;,vgl_homg_line_3d_2_points&lt;T &gt;const&amp;); \</span>
<a name="l00656"></a>00656 <span class="preprocessor">template vgl_homg_point_3d&lt;T &gt; vgl_closest_point(vgl_homg_line_3d_2_points&lt;T &gt;const&amp;,vgl_homg_point_3d&lt;T &gt;const&amp;); \</span>
<a name="l00657"></a>00657 <span class="preprocessor">template vgl_homg_point_3d&lt;T &gt; vgl_closest_point(vgl_homg_point_3d&lt;T &gt;const&amp;,vgl_homg_line_3d_2_points&lt;T &gt;const&amp;); \</span>
<a name="l00658"></a>00658 <span class="preprocessor">template vcl_pair&lt;vgl_point_3d&lt;T &gt;,vgl_point_3d&lt;T &gt; &gt; \</span>
<a name="l00659"></a>00659 <span class="preprocessor">         vgl_closest_points(vgl_line_3d_2_points&lt;T &gt;const&amp;, vgl_line_3d_2_points&lt;T &gt;const&amp;, bool*); \</span>
<a name="l00660"></a>00660 <span class="preprocessor">template vcl_pair&lt;vgl_point_3d&lt;T &gt;,vgl_point_3d&lt;T &gt; &gt; \</span>
<a name="l00661"></a>00661 <span class="preprocessor">         vgl_closest_points(vgl_line_segment_3d&lt;T &gt;const&amp;, vgl_line_segment_3d&lt;T &gt;const&amp;, bool*); \</span>
<a name="l00662"></a>00662 <span class="preprocessor">template vgl_point_2d&lt;T &gt; vgl_closest_point(vgl_line_segment_2d&lt;T &gt; const&amp;, vgl_point_2d&lt;T &gt; const&amp;); \</span>
<a name="l00663"></a>00663 <span class="preprocessor">template vgl_point_3d&lt;T &gt; vgl_closest_point(vgl_line_segment_3d&lt;T &gt; const&amp;, vgl_point_3d&lt;T &gt; const&amp;)</span>
<a name="l00664"></a>00664 <span class="preprocessor"></span>
<a name="l00665"></a>00665 <span class="preprocessor">#endif // vgl_closest_point_txx_</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:31:24 for core/vgl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
