<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>core/vgui/vgui_tag.h File Reference</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">core/vgui/vgui_tag.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Allow clients to register 'tag functions' which are called later.  
<a href="#details">More...</a></p>

<p><a href="vgui__tag_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vgui__tag_8h.html#a1a167207a67734f102f579d49d8fbbd4">vgui_tag</a>(tk)</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vgui__tag_8h.html#a2ffbf331227e2bc0949ef1554f793526">vgui_tag_function</a> )(void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of a tag function.  <a href="#a2ffbf331227e2bc0949ef1554f793526"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vgui__tag_8h.html#abc97a0fa6f1dd6e374cfd7a8e44f8a30">vgui_tag_add</a> (<a class="el" href="vgui__tag_8h.html#a2ffbf331227e2bc0949ef1554f793526">vgui_tag_function</a>, char const *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a tag function - returns 0.  <a href="#abc97a0fa6f1dd6e374cfd7a8e44f8a30"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="vgui__tag_8h.html#a2ffbf331227e2bc0949ef1554f793526">vgui_tag_function</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vgui__tag_8h.html#a23e8c2810086bbae8ee827f33db0ddc0">vgui_tag_list</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns null-terminated list of tag functions.  <a href="#a23e8c2810086bbae8ee827f33db0ddc0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vgui__tag_8h.html#a2a519d0de20d27826426c0e8c06a57e5">vgui_tag_call</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Call all registered tag functions and remove them from the list.  <a href="#a2a519d0de20d27826426c0e8c06a57e5"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Allow clients to register 'tag functions' which are called later. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>fsm</dd></dl>
<p>Real Purpose:</p>
<p>An impl library "blah" should register a tag function at library initialization time. The old method, where a library had a line something like </p>
<div class="fragment"><pre class="fragment">   <span class="keyword">static</span> vgui_blah *init_dummy = <span class="keyword">new</span> vgui_blah;
</pre></div><p> caused problems (segv) if a vgui_blah uses run-time libraries which have not yet been initialized. No particular order of library initialization may be assumed, so static objects in libA might not yet have been constructed when libB is initialized.</p>
<p>The workaround provided by vgui_tag is to make impl libraries register tag functions instead. Class vgui then promises to call all the registered tag functions near the beginning of <a class="el" href="classvgui.html#a21e49b999dab8ae89d76b8c7df2c64cc" title="Initialize the selected toolkit passing it the given command line.">vgui::init()</a>; There is no problem with registering function pointers, as these are POD (Plain Old Data). Thus, vgui_blah_tag.cxx now looks like this : </p>
<div class="fragment"><pre class="fragment">   <span class="keyword">static</span> <span class="keywordtype">int</span> vgui_blah_function() { <span class="keyword">new</span> vgui_blah; <span class="keywordflow">return</span> 0; }
   <span class="keywordtype">int</span> vgui_blah_tag = <a class="code" href="vgui__tag_8cxx.html#a1905f087584512c3c73f6495512ade04" title="Registers a tag function - returns 0.">vgui_tag_add</a>(vgui_blah_function, <span class="stringliteral">&quot;blah&quot;</span>);
</pre></div><p> Thus, when 'vgui_blah_tag' is initialized, the tag function called 'vgui_blah_tag_function' is registered. There is no instance of vgui_blah created until that tag function is called by <a class="el" href="classvgui.html#a21e49b999dab8ae89d76b8c7df2c64cc" title="Initialize the selected toolkit passing it the given command line.">vgui::init()</a>.</p>
<div class="fragment"><pre class="fragment">
    Modifications
     07-AUG-2002 K.Y.McGaul - Changed to Doxygen style comments.
   </pre></div> 
<p>Definition in file <a class="el" href="vgui__tag_8h_source.html">vgui_tag.h</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a1a167207a67734f102f579d49d8fbbd4"></a><!-- doxytag: member="vgui_tag.h::vgui_tag" ref="a1a167207a67734f102f579d49d8fbbd4" args="(tk)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vgui_tag</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tk</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordtype">int</span> vgui_##tk##_tag_function(); \
int vgui_##tk##_tag = <a class="code" href="vgui__tag_8cxx.html#a1905f087584512c3c73f6495512ade04" title="Registers a tag function - returns 0.">vgui_tag_add</a>(vgui_##tk##_tag_function, #tk); \
static <span class="keywordtype">int</span> vgui_##tk##_tag_function_(); \
int vgui_##tk##_tag_function() { \
  static <span class="keywordtype">bool</span> once = <span class="keyword">false</span>; \
  static <span class="keywordtype">int</span>  value = 0; \
  if (!once) \
    value = vgui_##tk##_tag_function_(); \
  once = <span class="keyword">true</span>; \
  return value; \
} \
int vgui_##tk##_tag_function_()
</pre></div>
<p>Definition at line <a class="el" href="vgui__tag_8h_source.html#l00062">62</a> of file <a class="el" href="vgui__tag_8h_source.html">vgui_tag.h</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a2ffbf331227e2bc0949ef1554f793526"></a><!-- doxytag: member="vgui_tag.h::vgui_tag_function" ref="a2ffbf331227e2bc0949ef1554f793526" args=")(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* <a class="el" href="vgui__tag_8h.html#a2ffbf331227e2bc0949ef1554f793526">vgui_tag_function</a>)(void)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The type of a tag function. </p>

<p>Definition at line <a class="el" href="vgui__tag_8h_source.html#l00044">44</a> of file <a class="el" href="vgui__tag_8h_source.html">vgui_tag.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="abc97a0fa6f1dd6e374cfd7a8e44f8a30"></a><!-- doxytag: member="vgui_tag.h::vgui_tag_add" ref="abc97a0fa6f1dd6e374cfd7a8e44f8a30" args="(vgui_tag_function, char const *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vgui_tag_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="vgui__tag_8h.html#a2ffbf331227e2bc0949ef1554f793526">vgui_tag_function</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Registers a tag function - returns 0. </p>

<p>Definition at line <a class="el" href="vgui__tag_8cxx_source.html#l00019">19</a> of file <a class="el" href="vgui__tag_8cxx_source.html">vgui_tag.cxx</a>.</p>

</div>
</div>
<a class="anchor" id="a2a519d0de20d27826426c0e8c06a57e5"></a><!-- doxytag: member="vgui_tag.h::vgui_tag_call" ref="a2a519d0de20d27826426c0e8c06a57e5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vgui_tag_call </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Call all registered tag functions and remove them from the list. </p>

<p>Definition at line <a class="el" href="vgui__tag_8cxx_source.html#l00032">32</a> of file <a class="el" href="vgui__tag_8cxx_source.html">vgui_tag.cxx</a>.</p>

</div>
</div>
<a class="anchor" id="a23e8c2810086bbae8ee827f33db0ddc0"></a><!-- doxytag: member="vgui_tag.h::vgui_tag_list" ref="a23e8c2810086bbae8ee827f33db0ddc0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="vgui__tag_8h.html#a2ffbf331227e2bc0949ef1554f793526">vgui_tag_function</a> const* vgui_tag_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns null-terminated list of tag functions. </p>

<p>Definition at line <a class="el" href="vgui__tag_8cxx_source.html#l00027">27</a> of file <a class="el" href="vgui__tag_8cxx_source.html">vgui_tag.cxx</a>.</p>

</div>
</div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:32:45 for core/vgui by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
