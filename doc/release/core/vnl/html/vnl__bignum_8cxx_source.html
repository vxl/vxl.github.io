<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>core/vnl/vnl_bignum.cxx Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">core/vnl/vnl_bignum.cxx</div>  </div>
</div>
<div class="contents">
<a href="vnl__bignum_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is core/vnl/vnl_bignum.cxx</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;<a class="code" href="vnl__bignum_8h.html" title="Infinite precision integers.">vnl_bignum.h</a>&quot;</span>
<a name="l00003"></a>00003 <span class="comment">//:</span>
<a name="l00004"></a>00004 <span class="comment">// \file</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;vcl_cstdlib.h&gt;</span>   <span class="comment">// for vcl_atol</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;vcl_cstring.h&gt;</span>   <span class="comment">// for vcl_strlen</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;vcl_cmath.h&gt;</span>     <span class="comment">// for vcl_fmod</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;vcl_algorithm.h&gt;</span> <span class="comment">// for vcl_copy</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;vcl_vector.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;vcl_cassert.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;vcl_iostream.h&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;vcl_limits.h&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;<a class="code" href="vnl__math_8h.html" title="Namespace with standard math functions.">vnl/vnl_math.h</a>&gt;</span> <span class="comment">// for vnl_math_isfinite(double)</span>
<a name="l00015"></a>00015 
<a name="l00016"></a><a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">00016</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>;
<a name="l00017"></a><a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">00017</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>;
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">//: Creates a zero vnl_bignum.</span>
<a name="l00020"></a>00020 
<a name="l00021"></a><a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4">00021</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>()
<a name="l00022"></a>00022 : count(0), sign(1), data(0)
<a name="l00023"></a>00023 {
<a name="l00024"></a>00024 }
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">//: Creates a vnl_bignum from a long integer.</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="classvnl__bignum.html#a43b33fbec8bfa487111c763e24d8babe">00028</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">long</span> l)
<a name="l00029"></a>00029 : count(0), sign(1), data(0)
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031   <span class="keywordflow">if</span> (l &lt; 0) {                  <span class="comment">// Get correct sign</span>
<a name="l00032"></a>00032     l = -l;                     <span class="comment">// Get absolute value of l</span>
<a name="l00033"></a>00033     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;
<a name="l00034"></a>00034   }
<a name="l00035"></a>00035   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> buf[<span class="keyword">sizeof</span>(l)];          <span class="comment">// Temp buffer to store l in</span>
<a name="l00036"></a>00036   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;                <span class="comment">// buffer index</span>
<a name="l00037"></a>00037   <span class="keywordflow">while</span> (l) {                   <span class="comment">// While more bits in l</span>
<a name="l00038"></a>00038     assert(i &lt; <span class="keyword">sizeof</span>(l));      <span class="comment">// no more buffer space</span>
<a name="l00039"></a>00039     buf[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(l);           <span class="comment">// Peel off lower order bits</span>
<a name="l00040"></a>00040     l &gt;&gt;= 16;   <span class="comment">// Shift next bits into place</span>
<a name="l00041"></a>00041     ++i;
<a name="l00042"></a>00042   }
<a name="l00043"></a>00043   <span class="keywordflow">if</span> (i &gt; 0)
<a name="l00044"></a>00044     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=i]; <span class="comment">// Allocate permanent data</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="keywordflow">while</span> (i--)     <span class="comment">// Save buffer into perm. data</span>
<a name="l00047"></a>00047     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = buf[i];
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">//: Creates a vnl_bignum from an integer.</span>
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="classvnl__bignum.html#a037cce4315689b85dfeae368d8d8351c">00052</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">int</span> l)
<a name="l00053"></a>00053 : count(0), sign(1), data(0)
<a name="l00054"></a>00054 {
<a name="l00055"></a>00055   <span class="keywordflow">if</span> (l &lt; 0) {                  <span class="comment">// Get correct sign</span>
<a name="l00056"></a>00056     l = -l;                     <span class="comment">// Get absolute value of l</span>
<a name="l00057"></a>00057     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;
<a name="l00058"></a>00058   }
<a name="l00059"></a>00059   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> buf[<span class="keyword">sizeof</span>(l)];          <span class="comment">// Temp buffer to store l in</span>
<a name="l00060"></a>00060   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;                <span class="comment">// buffer index</span>
<a name="l00061"></a>00061   <span class="keywordflow">while</span> (l) {                   <span class="comment">// While more bits in l</span>
<a name="l00062"></a>00062     assert(i &lt; <span class="keyword">sizeof</span>(l));      <span class="comment">// no more buffer space</span>
<a name="l00063"></a>00063     buf[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(l);           <span class="comment">// Peel off lower order bits</span>
<a name="l00064"></a>00064     l &gt;&gt;= 16;                   <span class="comment">// Shift next bits into place</span>
<a name="l00065"></a>00065     i++;
<a name="l00066"></a>00066   }
<a name="l00067"></a>00067   <span class="keywordflow">if</span> (i &gt; 0)
<a name="l00068"></a>00068     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=i]; <span class="comment">// Allocate permanent data</span>
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="keywordflow">while</span> (i--)     <span class="comment">// Save buffer into perm. data</span>
<a name="l00071"></a>00071     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = buf[i];
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">//: Creates a vnl_bignum from an unsigned long integer.</span>
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="classvnl__bignum.html#a077b4938a9e646c486308bd0ee4dea2c">00076</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l)
<a name="l00077"></a>00077 : count(0), sign(1), data(0)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> buf[<span class="keyword">sizeof</span>(l)];          <span class="comment">// Temp buffer to store l in</span>
<a name="l00080"></a>00080   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;                <span class="comment">// buffer index</span>
<a name="l00081"></a>00081   <span class="keywordflow">while</span> (l) {                   <span class="comment">// While more bits in l</span>
<a name="l00082"></a>00082     assert(i &lt; <span class="keyword">sizeof</span>(l));      <span class="comment">// no more buffer space</span>
<a name="l00083"></a>00083     buf[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(l);           <span class="comment">// Peel off lower order bits</span>
<a name="l00084"></a>00084     l &gt;&gt;= 16;   <span class="comment">// Shift next bits into place</span>
<a name="l00085"></a>00085     i++;
<a name="l00086"></a>00086   }
<a name="l00087"></a>00087   <span class="keywordflow">if</span> (i &gt; 0)
<a name="l00088"></a>00088     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=i]; <span class="comment">// Allocate permanent data</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="keywordflow">while</span> (i--)     <span class="comment">// Save buffer into perm. data</span>
<a name="l00091"></a>00091     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = buf[i];
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="comment">//: Creates a vnl_bignum from an unsigned integer.</span>
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classvnl__bignum.html#a0cc474b569b9c1d433504237425fec58">00096</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l)
<a name="l00097"></a>00097 : count(0), sign(1), data(0)
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> buf[<span class="keyword">sizeof</span>(l)];          <span class="comment">// Temp buffer to store l in</span>
<a name="l00100"></a>00100   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;                <span class="comment">// buffer index</span>
<a name="l00101"></a>00101   <span class="keywordflow">while</span> (l) {                   <span class="comment">// While more bits in l</span>
<a name="l00102"></a>00102     assert(i &lt; <span class="keyword">sizeof</span>(l));      <span class="comment">// no more buffer space</span>
<a name="l00103"></a>00103     buf[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(l);           <span class="comment">// Peel off lower order bits</span>
<a name="l00104"></a>00104     l &gt;&gt;= 16;   <span class="comment">// Shift next bits into place</span>
<a name="l00105"></a>00105     i++;
<a name="l00106"></a>00106   }
<a name="l00107"></a>00107   <span class="keywordflow">if</span> (i &gt; 0)
<a name="l00108"></a>00108     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=i]; <span class="comment">// Allocate permanent data</span>
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="keywordflow">while</span> (i--)     <span class="comment">// Save buffer into perm. data</span>
<a name="l00111"></a>00111     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = buf[i];
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">//: Creates a vnl_bignum from a single-precision floating point number.</span>
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="classvnl__bignum.html#a36c8aa01837dafb8afb0bdd93e201d22">00116</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">float</span> f)
<a name="l00117"></a>00117 : count(0), sign(1), data(0)
<a name="l00118"></a>00118 {
<a name="l00119"></a>00119   <span class="keywordtype">double</span> d = f;
<a name="l00120"></a>00120   <span class="keywordflow">if</span> (d &lt; 0.0) {                <span class="comment">// Get sign of d</span>
<a name="l00121"></a>00121     d = -d;                     <span class="comment">// Get absolute value of d</span>
<a name="l00122"></a>00122     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;
<a name="l00123"></a>00123   }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="keywordflow">if</span> (!<a class="code" href="vnl__bignum_8h.html#a432fec158a967671dd1d19ae766b721d">vnl_math_isfinite</a>(d)) {
<a name="l00126"></a>00126     <span class="comment">// Infinity is represented as: count=1, data[0]=0.</span>
<a name="l00127"></a>00127     <span class="comment">// This is an otherwise unused representation, since 0 is represented as count=0.</span>
<a name="l00128"></a>00128     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = 1;
<a name="l00129"></a>00129     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1];
<a name="l00130"></a>00130     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0] = 0;
<a name="l00131"></a>00131   }
<a name="l00132"></a>00132   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d &gt;= 1.0) {
<a name="l00133"></a>00133     <span class="comment">// Note: 0x10000L == 1 &gt;&gt; 16: the (assumed) size of unsigned short is 16 bits.</span>
<a name="l00134"></a>00134     vcl_vector&lt;Data&gt; buf;
<a name="l00135"></a>00135     <span class="keywordflow">while</span> (d &gt;= 1.0) {
<a name="l00136"></a>00136       buf.push_back( <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(vcl_fmod(d,0x10000L)) );  <span class="comment">// Get next data &quot;digit&quot; from d</span>
<a name="l00137"></a>00137       d /= 0x10000L;                                <span class="comment">// Shift d right 1 data &quot;digit&quot;</span>
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139     <span class="comment">// Allocate and copy into permanent buffer</span>
<a name="l00140"></a>00140     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = buf.size()&gt;0 ? <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[buf.size()] : 0;
<a name="l00141"></a>00141     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = (<span class="keywordtype">unsigned</span> short)(buf.size());
<a name="l00142"></a>00142     vcl_copy( buf.begin(), buf.end(), <a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> );
<a name="l00143"></a>00143   }
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">//: Creates a vnl_bignum from a double floating point number.</span>
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="classvnl__bignum.html#a0e6fb8e59c05e88271a1bca495c0a214">00148</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">double</span> d)
<a name="l00149"></a>00149 : count(0), sign(1), data(0)
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151   <span class="keywordflow">if</span> (d &lt; 0.0) {                <span class="comment">// Get sign of d</span>
<a name="l00152"></a>00152     d = -d;                     <span class="comment">// Get absolute value of d</span>
<a name="l00153"></a>00153     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;
<a name="l00154"></a>00154   }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="keywordflow">if</span> (!<a class="code" href="vnl__bignum_8h.html#a432fec158a967671dd1d19ae766b721d">vnl_math_isfinite</a>(d)) {
<a name="l00157"></a>00157     <span class="comment">// Infinity is represented as: count=1, data[0]=0.</span>
<a name="l00158"></a>00158     <span class="comment">// This is an otherwise unused representation, since 0 is represented as count=0.</span>
<a name="l00159"></a>00159     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = 1;
<a name="l00160"></a>00160     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1];
<a name="l00161"></a>00161     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0] = 0;
<a name="l00162"></a>00162   }
<a name="l00163"></a>00163   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d &gt;= 1.0) {
<a name="l00164"></a>00164     <span class="comment">// Note: 0x10000L == 1 &gt;&gt; 16: the (assumed) size of unsigned short is 16 bits.</span>
<a name="l00165"></a>00165     vcl_vector&lt;Data&gt; buf;
<a name="l00166"></a>00166     <span class="keywordflow">while</span> (d &gt;= 1.0) {
<a name="l00167"></a>00167       buf.push_back( <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(vcl_fmod(d,0x10000L)) );  <span class="comment">// Get next data &quot;digit&quot; from d</span>
<a name="l00168"></a>00168       d /= 0x10000L;                                <span class="comment">// Shift d right 1 data &quot;digit&quot;</span>
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170     <span class="comment">// Allocate and copy into permanent buffer</span>
<a name="l00171"></a>00171     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = buf.size()&gt;0 ? <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[buf.size()] : 0;
<a name="l00172"></a>00172     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = (<span class="keywordtype">unsigned</span> short)(buf.size());
<a name="l00173"></a>00173     vcl_copy( buf.begin(), buf.end(), <a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> );
<a name="l00174"></a>00174   }
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">//: Creates a vnl_bignum from a &quot;long double&quot; floating point number.</span>
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="classvnl__bignum.html#a0ea4d67ac73cb511d93d3a4d8b19f210">00179</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keywordtype">long</span> <span class="keywordtype">double</span> d)
<a name="l00180"></a>00180 : count(0), sign(1), data(0)
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182   <span class="keywordflow">if</span> (d &lt; 0.0) {                <span class="comment">// Get sign of d</span>
<a name="l00183"></a>00183     d = -d;                     <span class="comment">// Get absolute value of d</span>
<a name="l00184"></a>00184     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;
<a name="l00185"></a>00185   }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <span class="keywordflow">if</span> (!<a class="code" href="vnl__bignum_8h.html#a432fec158a967671dd1d19ae766b721d">vnl_math_isfinite</a>(d)) {
<a name="l00188"></a>00188     <span class="comment">// Infinity is represented as: count=1, data[0]=0.</span>
<a name="l00189"></a>00189     <span class="comment">// This is an otherwise unused representation, since 0 is represented as count=0.</span>
<a name="l00190"></a>00190     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = 1;
<a name="l00191"></a>00191     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1];
<a name="l00192"></a>00192     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0] = 0;
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d &gt;= 1.0) {
<a name="l00195"></a>00195     <span class="comment">// Note: 0x10000L == 1 &gt;&gt; 16: the (assumed) size of unsigned short is 16 bits.</span>
<a name="l00196"></a>00196     vcl_vector&lt;Data&gt; buf;
<a name="l00197"></a>00197     <span class="keywordflow">while</span> (d &gt;= 1.0) {
<a name="l00198"></a>00198       buf.push_back( <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(vcl_fmod(d,0x10000L)) );  <span class="comment">// Get next data &quot;digit&quot; from d</span>
<a name="l00199"></a>00199       d /= 0x10000L;                                <span class="comment">// Shift d right 1 data &quot;digit&quot;</span>
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     <span class="comment">// Allocate and copy into permanent buffer</span>
<a name="l00202"></a>00202     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = (buf.size()&gt;0 ? <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[buf.size()] : 0);
<a name="l00203"></a>00203     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = (<span class="keywordtype">unsigned</span> short)(buf.size());
<a name="l00204"></a>00204     vcl_copy( buf.begin(), buf.end(), <a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> );
<a name="l00205"></a>00205   }
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="preprocessor">#if 0 // Old, original Texas Instruments implementation - PVr</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>      <span class="comment">// Left here for ducumentation purposes only!</span>
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_decimal(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00212"></a>00212 {
<a name="l00213"></a>00213   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;+&#39;</span> || *s == <span class="charliteral">&#39;-&#39;</span>) ++s;
<a name="l00214"></a>00214   <span class="keywordflow">if</span> (*s &lt; &#39;1&#39; || *s &gt; <span class="charliteral">&#39;9&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00215"></a>00215   <span class="keywordflow">while</span> (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>) ++s;
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;l&#39;</span> || *s == <span class="charliteral">&#39;L&#39;</span>) ++s;
<a name="l00217"></a>00217   <span class="keywordflow">return</span> *s == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_exponential(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00221"></a>00221 {
<a name="l00222"></a>00222   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;+&#39;</span> || *s == <span class="charliteral">&#39;-&#39;</span>) ++s;
<a name="l00223"></a>00223   <span class="keywordflow">if</span> (*s &lt; &#39;1&#39; || *s &gt; <span class="charliteral">&#39;9&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00224"></a>00224   <span class="keywordflow">while</span> (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>) ++s;
<a name="l00225"></a>00225   <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;e&#39;</span> &amp;&amp; *s != <span class="charliteral">&#39;E&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00226"></a>00226   ++s;
<a name="l00227"></a>00227   <span class="keywordflow">if</span> (*s &lt; &#39;1&#39; || *s &gt; <span class="charliteral">&#39;9&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00228"></a>00228   <span class="keywordflow">while</span> (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>) ++s;
<a name="l00229"></a>00229   <span class="keywordflow">return</span> *s == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_hexadecimal(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;+&#39;</span> || *s == <span class="charliteral">&#39;-&#39;</span>) ++s;
<a name="l00235"></a>00235   <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;0&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00236"></a>00236   ++s;
<a name="l00237"></a>00237   <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;x&#39;</span> &amp;&amp; *s != <span class="charliteral">&#39;X&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00238"></a>00238   ++s;
<a name="l00239"></a>00239   <span class="keywordflow">if</span> ((*s &lt; &#39;0&#39; || *s &gt; <span class="charliteral">&#39;9&#39;</span>) &amp;&amp;
<a name="l00240"></a>00240       (*s &lt; &#39;a&#39; || *s &gt; <span class="charliteral">&#39;f&#39;</span>) &amp;&amp;
<a name="l00241"></a>00241       (*s &lt; &#39;A&#39; || *s &gt; <span class="charliteral">&#39;F&#39;</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00242"></a>00242   <span class="keywordflow">while</span> ((*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>) ||
<a name="l00243"></a>00243          (*s &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;f&#39;</span>) ||
<a name="l00244"></a>00244          (*s &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;F&#39;</span>)) ++s;
<a name="l00245"></a>00245   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;l&#39;</span> || *s == <span class="charliteral">&#39;L&#39;</span>) ++s;
<a name="l00246"></a>00246   <span class="keywordflow">return</span> *s == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_octal(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;+&#39;</span> || *s == <span class="charliteral">&#39;-&#39;</span>) ++s;
<a name="l00252"></a>00252   <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;0&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00253"></a>00253   <span class="keywordflow">while</span> (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;7&#39;</span>) ++s;
<a name="l00254"></a>00254   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;l&#39;</span> || *s == <span class="charliteral">&#39;L&#39;</span>) ++s;
<a name="l00255"></a>00255   <span class="keywordflow">return</span> *s == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00256"></a>00256 }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="preprocessor">#else // new implementation, also to be used for operator&gt;&gt; - PVr</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>
<a name="l00260"></a>00260 <span class="keyword">static</span> <span class="keywordtype">char</span> rt[4096];
<a name="l00261"></a>00261 <span class="keyword">static</span> <span class="keywordtype">int</span> rt_pos = 0;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 <span class="keyword">static</span> <span class="keywordtype">char</span> next(<span class="keyword">const</span> <span class="keywordtype">char</span>*&amp; s, vcl_istream** is)
<a name="l00264"></a>00264 {
<a name="l00265"></a>00265   <span class="keywordflow">if</span> (!is || *s) { <span class="keywordtype">char</span> c = *s; <span class="keywordflow">if</span> (c) ++rt_pos, ++s; <span class="keywordflow">return</span> c; }
<a name="l00266"></a>00266   <span class="keywordflow">if</span> (rt_pos == 4096) <span class="keywordflow">return</span> <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00267"></a>00267   (*is)-&gt;get(rt[rt_pos]); <span class="comment">// read a single byte from istream</span>
<a name="l00268"></a>00268   <span class="keywordflow">if</span> (*s) ++s; <span class="comment">// in case s == rt+rt_pos</span>
<a name="l00269"></a>00269   rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>; <span class="keywordflow">return</span> rt[rt_pos-1];
<a name="l00270"></a>00270 }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_decimal(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, vcl_istream** is = 0)
<a name="l00273"></a>00273 {
<a name="l00274"></a>00274   rt_pos = 0;
<a name="l00275"></a>00275   <span class="keywordtype">char</span> c = next(s,is);
<a name="l00276"></a>00276   <span class="keywordflow">while</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;\t&#39;</span> || c == <span class="charliteral">&#39;\n&#39;</span> || c == <span class="charliteral">&#39;\r&#39;</span>) c = next(s,is);
<a name="l00277"></a>00277   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;+&#39;</span> || c == <span class="charliteral">&#39;-&#39;</span>) c = next(s,is);
<a name="l00278"></a>00278   <span class="keywordflow">if</span> (c &lt; &#39;1&#39; || c &gt; <span class="charliteral">&#39;9&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00279"></a>00279   <span class="keywordflow">while</span> (c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>) c = next(s,is);
<a name="l00280"></a>00280   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;l&#39;</span> || c == <span class="charliteral">&#39;L&#39;</span>) c = next(s,is);
<a name="l00281"></a>00281   <span class="keywordflow">if</span> (rt_pos &gt; 0) rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00282"></a>00282   <span class="keywordflow">return</span> is ? <span class="keyword">true</span> : c == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_exponential(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, vcl_istream** is = 0)
<a name="l00286"></a>00286 {
<a name="l00287"></a>00287   rt_pos = 0;
<a name="l00288"></a>00288   <span class="keywordtype">char</span> c = next(s,is);
<a name="l00289"></a>00289   <span class="keywordflow">while</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;\t&#39;</span> || c == <span class="charliteral">&#39;\n&#39;</span> || c == <span class="charliteral">&#39;\r&#39;</span>) c = next(s,is);
<a name="l00290"></a>00290   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;+&#39;</span> || c == <span class="charliteral">&#39;-&#39;</span>) c = next(s,is);
<a name="l00291"></a>00291   <span class="keywordflow">if</span> (c &lt; &#39;1&#39; || c &gt; <span class="charliteral">&#39;9&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00292"></a>00292   <span class="keywordflow">while</span> (c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>) c = next(s,is);
<a name="l00293"></a>00293   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;e&#39;</span> &amp;&amp; c != <span class="charliteral">&#39;E&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00294"></a>00294   c = next(s,is);
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;+&#39;</span>) c = next(s,is); <span class="comment">// no negative exponent!</span>
<a name="l00296"></a>00296   <span class="keywordflow">if</span> (c &lt; &#39;0&#39; || c &gt; <span class="charliteral">&#39;9&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00297"></a>00297   <span class="keywordflow">while</span> (c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>) c = next(s,is);
<a name="l00298"></a>00298   <span class="keywordflow">if</span> (rt_pos &gt; 0) rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00299"></a>00299   <span class="keywordflow">return</span> is ? <span class="keyword">true</span> : c == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_hexadecimal(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, vcl_istream** is = 0)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304   rt_pos = 0;
<a name="l00305"></a>00305   <span class="keywordtype">char</span> c = next(s,is);
<a name="l00306"></a>00306   <span class="keywordflow">while</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;\t&#39;</span> || c == <span class="charliteral">&#39;\n&#39;</span> || c == <span class="charliteral">&#39;\r&#39;</span>) c = next(s,is);
<a name="l00307"></a>00307   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;+&#39;</span> || c == <span class="charliteral">&#39;-&#39;</span>) c = next(s,is);
<a name="l00308"></a>00308   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;0&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00309"></a>00309   c = next(s,is);
<a name="l00310"></a>00310   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;x&#39;</span> &amp;&amp; c != <span class="charliteral">&#39;X&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00311"></a>00311   c = next(s,is);
<a name="l00312"></a>00312   <span class="keywordflow">if</span> ((c &lt; &#39;0&#39; || c &gt; <span class="charliteral">&#39;9&#39;</span>) &amp;&amp;
<a name="l00313"></a>00313       (c &lt; &#39;a&#39; || c &gt; <span class="charliteral">&#39;f&#39;</span>) &amp;&amp;
<a name="l00314"></a>00314       (c &lt; &#39;A&#39; || c &gt; <span class="charliteral">&#39;F&#39;</span>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00315"></a>00315   <span class="keywordflow">while</span> ((c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>) ||
<a name="l00316"></a>00316          (c &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;f&#39;</span>) ||
<a name="l00317"></a>00317          (c &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;F&#39;</span>)) c = next(s,is);
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;l&#39;</span> || c == <span class="charliteral">&#39;L&#39;</span>) c = next(s,is);
<a name="l00319"></a>00319   <span class="keywordflow">if</span> (rt_pos &gt; 0) rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00320"></a>00320   <span class="keywordflow">return</span> is ? <span class="keyword">true</span> : c == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_octal(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, vcl_istream** is = 0)
<a name="l00324"></a>00324 {
<a name="l00325"></a>00325   rt_pos = 0;
<a name="l00326"></a>00326   <span class="keywordtype">char</span> c = next(s,is);
<a name="l00327"></a>00327   <span class="keywordflow">while</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;\t&#39;</span> || c == <span class="charliteral">&#39;\n&#39;</span> || c == <span class="charliteral">&#39;\r&#39;</span>) c = next(s,is);
<a name="l00328"></a>00328   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;+&#39;</span> || c == <span class="charliteral">&#39;-&#39;</span>) c = next(s,is);
<a name="l00329"></a>00329   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;0&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00330"></a>00330   <span class="keywordflow">while</span> (c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;7&#39;</span>) c = next(s,is);
<a name="l00331"></a>00331   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;l&#39;</span> || c == <span class="charliteral">&#39;L&#39;</span>) c = next(s,is);
<a name="l00332"></a>00332   <span class="keywordflow">if</span> (rt_pos &gt; 0) rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00333"></a>00333   <span class="keywordflow">return</span> is ? <span class="keyword">true</span> : c == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00334"></a>00334 }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_plus_inf(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, vcl_istream** is = 0)
<a name="l00337"></a>00337 {
<a name="l00338"></a>00338   rt_pos = 0;
<a name="l00339"></a>00339   <span class="keywordtype">char</span> c = next(s,is);
<a name="l00340"></a>00340   <span class="keywordflow">while</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;\t&#39;</span> || c == <span class="charliteral">&#39;\n&#39;</span> || c == <span class="charliteral">&#39;\r&#39;</span>) c = next(s,is);
<a name="l00341"></a>00341   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;+&#39;</span>) c = next(s,is);
<a name="l00342"></a>00342   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;I&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;n&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00344"></a>00344   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;f&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00345"></a>00345   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;i&#39;</span>) c = next(s,is);
<a name="l00346"></a>00346   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;n&#39;</span>) c = next(s,is);
<a name="l00347"></a>00347   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;i&#39;</span>) c = next(s,is);
<a name="l00348"></a>00348   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;t&#39;</span>) c = next(s,is);
<a name="l00349"></a>00349   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;y&#39;</span>) c = next(s,is);
<a name="l00350"></a>00350   <span class="keywordflow">if</span> (rt_pos &gt; 0) rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00351"></a>00351   <span class="keywordflow">return</span> is ? <span class="keyword">true</span> : c == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00352"></a>00352 }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="keyword">static</span> <span class="keywordtype">bool</span> is_minus_inf(<span class="keyword">const</span> <span class="keywordtype">char</span>* s, vcl_istream** is = 0)
<a name="l00355"></a>00355 {
<a name="l00356"></a>00356   rt_pos = 0;
<a name="l00357"></a>00357   <span class="keywordtype">char</span> c = next(s,is);
<a name="l00358"></a>00358   <span class="keywordflow">while</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;\t&#39;</span> || c == <span class="charliteral">&#39;\n&#39;</span> || c == <span class="charliteral">&#39;\r&#39;</span>) c = next(s,is);
<a name="l00359"></a>00359   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;-&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00360"></a>00360   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;I&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00361"></a>00361   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;n&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00362"></a>00362   <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;f&#39;</span>) <span class="keywordflow">return</span> <span class="keyword">false</span>; c = next(s,is);
<a name="l00363"></a>00363   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;i&#39;</span>) c = next(s,is);
<a name="l00364"></a>00364   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;n&#39;</span>) c = next(s,is);
<a name="l00365"></a>00365   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;i&#39;</span>) c = next(s,is);
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;t&#39;</span>) c = next(s,is);
<a name="l00367"></a>00367   <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;y&#39;</span>) c = next(s,is);
<a name="l00368"></a>00368   <span class="keywordflow">if</span> (rt_pos &gt; 0) rt[++rt_pos] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00369"></a>00369   <span class="keywordflow">return</span> is ? <span class="keyword">true</span> : c == <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="preprocessor">#endif // new implementation - PVr</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>
<a name="l00374"></a>00374 <span class="comment">//: Creates a vnl_bignum from the character string representation.</span>
<a name="l00375"></a>00375 
<a name="l00376"></a><a class="code" href="classvnl__bignum.html#a3e8517aa4c0aae1a34839ded9aa55fc0">00376</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00377"></a>00377 : count(0), sign(1), data(0)
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379   <span class="comment">// decimal:     &quot;^ *[-+]?[1-9][0-9]*$&quot;</span>
<a name="l00380"></a>00380   <span class="comment">// exponential: &quot;^ *[-+]?[1-9][0-9]*[eE][+]?[0-9]+$&quot;</span>
<a name="l00381"></a>00381   <span class="comment">// hexadecimal: &quot;^ *[-+]?0[xX][0-9a-fA-F]+$&quot;</span>
<a name="l00382"></a>00382   <span class="comment">// octal:       &quot;^ *[-+]?0[0-7]*$&quot;</span>
<a name="l00383"></a>00383   <span class="comment">// infinity:    &quot;^ *[-+]?Inf(inity)?$&quot;</span>
<a name="l00384"></a>00384 
<a name="l00385"></a>00385   <span class="keywordflow">if</span> (is_plus_inf(s))
<a name="l00386"></a>00386     <a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=1,<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>=<span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1],<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0]=0;
<a name="l00387"></a>00387   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_minus_inf(s))
<a name="l00388"></a>00388     <a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>=-1,<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=1,data=<span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1],data[0]=0;
<a name="l00389"></a>00389   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_decimal(s))               <span class="comment">// If string is decimal</span>
<a name="l00390"></a>00390     this-&gt;<a class="code" href="classvnl__bignum.html#a111e6a2f11ca62135eda81faff1acda6" title="Converts decimal string to a vnl_bignum.">dtoBigNum</a>(s);                 <span class="comment">// convert decimal to vnl_bignum</span>
<a name="l00391"></a>00391   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_exponential(s))           <span class="comment">// If string is exponential</span>
<a name="l00392"></a>00392     this-&gt;<a class="code" href="classvnl__bignum.html#a501e8d1aa5b0693cf0bb05e4e1b32f25" title="convert exponential string to a vnl_bignum.">exptoBigNum</a>(s);               <span class="comment">// convert exp. to vnl_bignum</span>
<a name="l00393"></a>00393   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_hexadecimal(s))           <span class="comment">// If string is hex,</span>
<a name="l00394"></a>00394     this-&gt;<a class="code" href="classvnl__bignum.html#a84559dec19e42813bd2305ab507b9648" title="convert hex string to vnl_bignum.">xtoBigNum</a>(s);                 <span class="comment">// convert hex to vnl_bignum</span>
<a name="l00395"></a>00395   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_octal(s))                 <span class="comment">// If string is octal</span>
<a name="l00396"></a>00396     this-&gt;<a class="code" href="classvnl__bignum.html#a53d2cb32473a259028e17afe4260c361" title="convert octal string to vnl_bignum.">otoBigNum</a>(s);                 <span class="comment">// convert octal to vnl_bignum</span>
<a name="l00397"></a>00397   <span class="keywordflow">else</span> {                                <span class="comment">// Otherwise</span>
<a name="l00398"></a>00398     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Cannot convert string &quot;</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">&quot; to vnl_bignum\n&quot;</span>;
<a name="l00399"></a>00399   }
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="comment">//: Reads a vnl_bignum from a stream</span>
<a name="l00403"></a>00403 
<a name="l00404"></a><a class="code" href="vnl__bignum_8h.html#a9d25fe13a3bcaf2be81e689a1c37a2e3">00404</a> vcl_istream&amp; <a class="code" href="classvnl__decnum.html#ab34c8cf6db48769ec7d6cbd00f68b6af" title="decimal input.">operator&gt;&gt;</a>(vcl_istream&amp; is, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; x)
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406   <span class="comment">// decimal:     &quot;^ *[-+]?[1-9][0-9]*$&quot;</span>
<a name="l00407"></a>00407   <span class="comment">// exponential: &quot;^ *[-+]?[1-9][0-9]*[eE][+]?[0-9]+$&quot;</span>
<a name="l00408"></a>00408   <span class="comment">// hexadecimal: &quot;^ *[-+]?0[xX][0-9a-fA-F]+$&quot;</span>
<a name="l00409"></a>00409   <span class="comment">// octal:       &quot;^ *[-+]?0[0-7]*$&quot;</span>
<a name="l00410"></a>00410   vcl_istream* isp = &amp;is;
<a name="l00411"></a>00411   rt[0] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413   x = 0L;
<a name="l00414"></a>00414   <span class="keywordflow">if</span> (is_plus_inf(rt,&amp;isp))
<a name="l00415"></a>00415     x.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>=1,x.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=1,x.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>=<span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1],x.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0]=0;
<a name="l00416"></a>00416   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_minus_inf(rt,&amp;isp))
<a name="l00417"></a>00417     x.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>=-1,x.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>=1,x.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>=<span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[1],x.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0]=0;
<a name="l00418"></a>00418   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_exponential(rt,&amp;isp))     <span class="comment">// If input stream string is exponential</span>
<a name="l00419"></a>00419     x.<a class="code" href="classvnl__bignum.html#a501e8d1aa5b0693cf0bb05e4e1b32f25" title="convert exponential string to a vnl_bignum.">exptoBigNum</a>(rt);                  <span class="comment">// convert exp. to vnl_bignum</span>
<a name="l00420"></a>00420   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_decimal(rt,&amp;isp))         <span class="comment">// If string is decimal</span>
<a name="l00421"></a>00421     x.<a class="code" href="classvnl__bignum.html#a111e6a2f11ca62135eda81faff1acda6" title="Converts decimal string to a vnl_bignum.">dtoBigNum</a>(rt);                    <span class="comment">// convert decimal to vnl_bignum</span>
<a name="l00422"></a>00422   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_hexadecimal(rt,&amp;isp))     <span class="comment">// If string is hex,</span>
<a name="l00423"></a>00423     x.<a class="code" href="classvnl__bignum.html#a84559dec19e42813bd2305ab507b9648" title="convert hex string to vnl_bignum.">xtoBigNum</a>(rt);                    <span class="comment">// convert hex to vnl_bignum</span>
<a name="l00424"></a>00424   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_octal(rt,&amp;isp))           <span class="comment">// If string is octal</span>
<a name="l00425"></a>00425     x.<a class="code" href="classvnl__bignum.html#a53d2cb32473a259028e17afe4260c361" title="convert octal string to vnl_bignum.">otoBigNum</a>(rt);                    <span class="comment">// convert octal to vnl_bignum</span>
<a name="l00426"></a>00426   <span class="keywordflow">else</span> {                                <span class="comment">// Otherwise</span>
<a name="l00427"></a>00427     vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Cannot convert string &quot;</span> &lt;&lt; rt &lt;&lt; <span class="stringliteral">&quot; to vnl_bignum\n&quot;</span>;
<a name="l00428"></a>00428   }
<a name="l00429"></a>00429   <span class="keywordflow">return</span> is; <span class="comment">// FIXME - should probably push back read characters to istream</span>
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="comment">//: Copies the contents of vnl_bignum b.</span>
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="classvnl__bignum.html#acd179d21267fe2370ccb260a9d368391">00434</a> <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum::vnl_bignum</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)
<a name="l00435"></a>00435 : count(b.count), sign(b.sign)
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>) {
<a name="l00438"></a>00438     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>];            <span class="comment">// Allocate data</span>
<a name="l00439"></a>00439     <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0; i &lt; this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; ++i)  <span class="comment">// Copy b data</span>
<a name="l00440"></a>00440       this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = b.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i];
<a name="l00441"></a>00441   }
<a name="l00442"></a>00442   <span class="keywordflow">else</span> {
<a name="l00443"></a>00443     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = 0;
<a name="l00444"></a>00444   }
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">//: Frees space for vnl_bignum.</span>
<a name="l00448"></a>00448 
<a name="l00449"></a><a class="code" href="classvnl__bignum.html#ac4d604e52f6ef1e15f590271a1b0f1ee">00449</a> <a class="code" href="classvnl__bignum.html#ac4d604e52f6ef1e15f590271a1b0f1ee" title="Frees space for vnl_bignum.">vnl_bignum::~vnl_bignum</a>()
<a name="l00450"></a>00450 {
<a name="l00451"></a>00451   <span class="keyword">delete</span> [] this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>; this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = 0;        <span class="comment">// Delete any allocated data</span>
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="comment">//: Copies rhs vnl_bignum to lhs vnl_bignum.</span>
<a name="l00455"></a>00455 
<a name="l00456"></a><a class="code" href="classvnl__bignum.html#a6e22b400f5b6515c1496c8b52aca83bc">00456</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#a6e22b400f5b6515c1496c8b52aca83bc" title="Copies rhs vnl_bignum to lhs vnl_bignum.">vnl_bignum::operator=</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; rhs)
<a name="l00457"></a>00457 {
<a name="l00458"></a>00458   <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;rhs) {                           <span class="comment">// Avoid self-assignment</span>
<a name="l00459"></a>00459     <span class="keyword">delete</span>[] this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>;                        <span class="comment">// Delete existing data</span>
<a name="l00460"></a>00460     this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = rhs.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>;                    <span class="comment">// Copy rhs&#39;s count</span>
<a name="l00461"></a>00461     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = rhs.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> ? <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[rhs.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>] : 0; <span class="comment">// Allocate data if necessary</span>
<a name="l00462"></a>00462     <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0; i &lt; rhs.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; ++i)     <span class="comment">// Copy rhs&#39;s data</span>
<a name="l00463"></a>00463       this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = rhs.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i];
<a name="l00464"></a>00464     this-&gt;sign = rhs.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;                      <span class="comment">// Copy rhs&#39;s sign</span>
<a name="l00465"></a>00465   }
<a name="l00466"></a>00466   <span class="keywordflow">return</span> *<span class="keyword">this</span>;                                 <span class="comment">// Return reference</span>
<a name="l00467"></a>00467 }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 <span class="comment">//: Returns the negation of a vnl_bignum.</span>
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="classvnl__bignum.html#a3c79245f4bc59fd27a4996e55a3ad322">00471</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> <a class="code" href="classvnl__bignum.html#a3c79245f4bc59fd27a4996e55a3ad322" title="Returns the negation of a vnl_bignum.">vnl_bignum::operator-</a>()<span class="keyword"> const</span>
<a name="l00472"></a>00472 <span class="keyword"></span>{
<a name="l00473"></a>00473   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> neg(*<span class="keyword">this</span>);
<a name="l00474"></a>00474   <span class="keywordflow">if</span> (neg.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>)                <span class="comment">// So long as this is non-zero</span>
<a name="l00475"></a>00475     neg.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -neg.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;       <span class="comment">// Flip its sign</span>
<a name="l00476"></a>00476   <span class="keywordflow">return</span> neg;
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="comment">//: Prefix increment. Increments a vnl_bignum by 1, and returns it.</span>
<a name="l00480"></a>00480 
<a name="l00481"></a><a class="code" href="classvnl__bignum.html#a38d0f61d09d85f5b36d73625e7336ef6">00481</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#a38d0f61d09d85f5b36d73625e7336ef6" title="prefix increment (++b).">vnl_bignum::operator++</a>()
<a name="l00482"></a>00482 {
<a name="l00483"></a>00483   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00484"></a>00484   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>==0)
<a name="l00485"></a>00485   {
<a name="l00486"></a>00486     this-&gt;<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(1);
<a name="l00487"></a>00487     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0] = 1;
<a name="l00488"></a>00488     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = +1;
<a name="l00489"></a>00489     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00490"></a>00490   }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &gt; 0) <a class="code" href="classvnl__bignum.html#a5d55189cd1270075bb594d7a3128506c" title="Add 1 to bnum (unsigned, non-infinite).">increment</a>(*<span class="keyword">this</span>);
<a name="l00493"></a>00493   <span class="keywordflow">else</span> <a class="code" href="classvnl__bignum.html#afd695420ca3198a746b1b13c5afa2e64" title="Subtract 1 from bnum (unsigned, non-infinite, non-zero).">decrement</a>(*<span class="keyword">this</span>);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="comment">//: Prefix decrement. Decrements a vnl_bignum by 1, and returns it.</span>
<a name="l00499"></a>00499 
<a name="l00500"></a><a class="code" href="classvnl__bignum.html#a4e33e04375e1adfaaaf41003fec3479c">00500</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#a4e33e04375e1adfaaaf41003fec3479c" title="decrement.">vnl_bignum::operator--</a>()
<a name="l00501"></a>00501 {
<a name="l00502"></a>00502   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00503"></a>00503   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>==0)
<a name="l00504"></a>00504   {
<a name="l00505"></a>00505     this-&gt;<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(1);
<a name="l00506"></a>00506     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0] = 1;
<a name="l00507"></a>00507     this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;
<a name="l00508"></a>00508     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00509"></a>00509   }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0) <a class="code" href="classvnl__bignum.html#a5d55189cd1270075bb594d7a3128506c" title="Add 1 to bnum (unsigned, non-infinite).">increment</a>(*<span class="keyword">this</span>);
<a name="l00512"></a>00512   <span class="keywordflow">else</span> <a class="code" href="classvnl__bignum.html#afd695420ca3198a746b1b13c5afa2e64" title="Subtract 1 from bnum (unsigned, non-infinite, non-zero).">decrement</a>(*<span class="keyword">this</span>);
<a name="l00513"></a>00513 
<a name="l00514"></a>00514   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="comment">//: Adds two vnl_bignums, and returns new sum.</span>
<a name="l00518"></a>00518 
<a name="l00519"></a><a class="code" href="classvnl__bignum.html#a3ee1d4ffe13b4102c8b9a0e4424f4daf">00519</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> <a class="code" href="classvnl__bignum.html#a0701ae4d80f813471def98a1871a660e">vnl_bignum::operator+</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)<span class="keyword"> const</span>
<a name="l00520"></a>00520 <span class="keyword"></span>{
<a name="l00521"></a>00521   <span class="comment">// Infinity arithmetic:</span>
<a name="l00522"></a>00522   assert (! b.<a class="code" href="classvnl__bignum.html#a0d05dc166f5477f49aa901542153df1c">is_minus_infinity</a>() || ! this-&gt;<a class="code" href="classvnl__bignum.html#a761659346ac21548bed81c4c569932de">is_plus_infinity</a>() ); <span class="comment">// +Inf-Inf</span>
<a name="l00523"></a>00523   assert (! b.<a class="code" href="classvnl__bignum.html#a761659346ac21548bed81c4c569932de">is_plus_infinity</a>() || ! this-&gt;<a class="code" href="classvnl__bignum.html#a0d05dc166f5477f49aa901542153df1c">is_minus_infinity</a>() ); <span class="comment">// -Inf+Inf</span>
<a name="l00524"></a>00524   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) { <span class="keywordflow">return</span> b; }
<a name="l00525"></a>00525   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) { <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> sum;                       <span class="comment">// Init sum to zero</span>
<a name="l00528"></a>00528   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> == b.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>) {           <span class="comment">// If both have same sign</span>
<a name="l00529"></a>00529     <a class="code" href="classvnl__bignum.html#a12003ffc085efff112a8727ff58ad920" title="add two non-infinite vnl_bignum values and save their sum.">add</a>(*<span class="keyword">this</span>,b,sum);                   <span class="comment">//   Do simple addition</span>
<a name="l00530"></a>00530     sum.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;              <span class="comment">// Attach proper sign</span>
<a name="l00531"></a>00531   }
<a name="l00532"></a>00532   <span class="keywordflow">else</span> {                                <span class="comment">// Else different signs</span>
<a name="l00533"></a>00533     <span class="keywordtype">int</span> mag = <a class="code" href="classvnl__bignum.html#ab6e951d56b76927509f672ac33acce87" title="compare absolute values of two vnl_bignums.">magnitude_cmp</a>(*<span class="keyword">this</span>,b);   <span class="comment">// Determine relative sizes</span>
<a name="l00534"></a>00534     <span class="keywordflow">if</span> (mag &gt; 0) {                      <span class="comment">// If abs(*this) &gt; abs(b)</span>
<a name="l00535"></a>00535       <a class="code" href="classvnl__bignum.html#a7e04219d436a1d7bd20d3924afa23b9d" title="subtract bmin from bmax (unsigned, non-infinite), result in diff.">subtract</a>(*<span class="keyword">this</span>,b,sum);            <span class="comment">//   sum = *this - b</span>
<a name="l00536"></a>00536       sum.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;            <span class="comment">// Sign of sum follows *this</span>
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mag &lt; 0) {                 <span class="comment">// Else if abs(*this) &lt; abs(b)</span>
<a name="l00539"></a>00539       <a class="code" href="classvnl__bignum.html#a7e04219d436a1d7bd20d3924afa23b9d" title="subtract bmin from bmax (unsigned, non-infinite), result in diff.">subtract</a>(b,*<span class="keyword">this</span>,sum);            <span class="comment">//   sum = b - *this</span>
<a name="l00540"></a>00540       sum.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = b.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;                <span class="comment">// Sign of sum follows b</span>
<a name="l00541"></a>00541     }                                   <span class="comment">// (Else abs(*this) == abs(b)</span>
<a name="l00542"></a>00542   }                                     <span class="comment">//   so sum must be zero)</span>
<a name="l00543"></a>00543   <span class="keywordflow">return</span> sum;                           <span class="comment">// shallow swap on return</span>
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="comment">//: Multiplies this with a vnl_bignum</span>
<a name="l00547"></a>00547 
<a name="l00548"></a><a class="code" href="classvnl__bignum.html#a7b8a569559b6fa1900d9cbceff5e7cf7">00548</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#a7b8a569559b6fa1900d9cbceff5e7cf7" title="Multiplies this with a vnl_bignum.">vnl_bignum::operator*=</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)
<a name="l00549"></a>00549 {
<a name="l00550"></a>00550   <span class="comment">// Infinity arithmetic:</span>
<a name="l00551"></a>00551   assert (! b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() || this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> != 0 ); <span class="comment">// multiplication 0*Inf</span>
<a name="l00552"></a>00552   assert (! this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() || b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> != 0 ); <span class="comment">// multiplication Inf*0</span>
<a name="l00553"></a>00553   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>&lt;0 ? -b : b);
<a name="l00554"></a>00554   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = (b.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>&lt;0 ? -(*this) : *<span class="keyword">this</span>);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> == 0 || this-&gt;count == 0)
<a name="l00557"></a>00557     <span class="keywordflow">return</span> (*<span class="keyword">this</span>)=0L;
<a name="l00558"></a>00558   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> prod;
<a name="l00559"></a>00559   prod.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>);           <span class="comment">//   allocate data for product</span>
<a name="l00560"></a>00560   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0; i &lt; b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i++)         <span class="comment">//   multiply each b &quot;digit&quot;</span>
<a name="l00561"></a>00561     <a class="code" href="classvnl__bignum.html#a2d9ffa8d3bf84f4ddddaff7f67d21209">multiply_aux</a>(*<span class="keyword">this</span>, b.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i], prod, i);    <span class="comment">//   times b1 and add to total</span>
<a name="l00562"></a>00562   prod.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> * b.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;              <span class="comment">//   determine correct sign</span>
<a name="l00563"></a>00563   prod.<a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030" title="trim non-infinite vnl_bignum of excess data allotment.">trim</a>();                                  <span class="comment">//   trim excess data and ret.</span>
<a name="l00564"></a>00564   <span class="keywordflow">return</span> (*<span class="keyword">this</span>)=prod;
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 <span class="comment">//: Divides this by a vnl_bignum</span>
<a name="l00568"></a>00568 
<a name="l00569"></a><a class="code" href="classvnl__bignum.html#a51996c762609ad2cc2889cd70f29fb5c">00569</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#a51996c762609ad2cc2889cd70f29fb5c" title="Divides this by a vnl_bignum.">vnl_bignum::operator/=</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)
<a name="l00570"></a>00570 {
<a name="l00571"></a>00571   <span class="comment">// Infinity arithmetic:</span>
<a name="l00572"></a>00572   assert (! b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() || ! this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() ); <span class="comment">// division Inf/Inf</span>
<a name="l00573"></a>00573   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> (*<span class="keyword">this</span>)=0L;
<a name="l00574"></a>00574   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = (b.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>&lt;0 ? -(*this) : *<span class="keyword">this</span>);
<a name="l00575"></a>00575   assert (b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>!=0 || this-&gt;count != 0); <span class="comment">// division 0/0</span>
<a name="l00576"></a>00576   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> == 0)
<a name="l00577"></a>00577     <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0 ? <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum</a>(<span class="stringliteral">&quot;-Inf&quot;</span>) : <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum</a>(<span class="stringliteral">&quot;+Inf&quot;</span>));
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   vnl_bignum quot, r;          <span class="comment">// Quotient and remainder</span>
<a name="l00580"></a>00580   <a class="code" href="classvnl__bignum.html#adec22c7d0bc290b297df5a794d055eb7" title="divide b2 into b1, getting quotient q and remainder r.">divide</a>(*<span class="keyword">this</span>,b,quot,r);      <span class="comment">// Call divide fn</span>
<a name="l00581"></a>00581   <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = quot;
<a name="l00582"></a>00582 }
<a name="l00583"></a>00583 
<a name="l00584"></a>00584 <span class="comment">//: Divides this by a vnl_bignum and replaces this by remainder.</span>
<a name="l00585"></a>00585 
<a name="l00586"></a><a class="code" href="classvnl__bignum.html#a8743d0a18fd24b2ab9ed243aa84a5116">00586</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#a8743d0a18fd24b2ab9ed243aa84a5116" title="Divides this by a vnl_bignum and replaces this by remainder.">vnl_bignum::operator%=</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)
<a name="l00587"></a>00587 {
<a name="l00588"></a>00588   <span class="comment">// Infinity arithmetic:</span>
<a name="l00589"></a>00589   assert (! b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() || ! this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() ); <span class="comment">// division Inf/Inf</span>
<a name="l00590"></a>00590   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> *<span class="keyword">this</span>;                    <span class="comment">// remainder of x/Inf is x.</span>
<a name="l00591"></a>00591   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = 0L;         <span class="comment">// convention: remainder is 0</span>
<a name="l00592"></a>00592   assert (b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>!=0 || this-&gt;count != 0);              <span class="comment">// division 0/0</span>
<a name="l00593"></a>00593   <span class="keywordflow">if</span> (b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> == 0) <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = 0L;                <span class="comment">// convention: remainder is 0</span>
<a name="l00594"></a>00594 
<a name="l00595"></a>00595   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> remain, q;        <span class="comment">// Quotient and remainder</span>
<a name="l00596"></a>00596   <a class="code" href="classvnl__bignum.html#adec22c7d0bc290b297df5a794d055eb7" title="divide b2 into b1, getting quotient q and remainder r.">divide</a>(*<span class="keyword">this</span>,b,q,remain);    <span class="comment">// divide by b and save remainder</span>
<a name="l00597"></a>00597   <span class="keywordflow">return</span> (*<span class="keyword">this</span>) = remain;     <span class="comment">// shallow swap on return</span>
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 <span class="comment">//: Shifts bignum to the left l digits.</span>
<a name="l00601"></a>00601 
<a name="l00602"></a><a class="code" href="classvnl__bignum.html#aab3c49e590f5725e64ea8a6c7873725d">00602</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> <a class="code" href="classvnl__bignum.html#aab3c49e590f5725e64ea8a6c7873725d" title="Shifts bignum to the left l digits.">vnl_bignum::operator&lt;&lt;</a>(<span class="keywordtype">int</span> l)<span class="keyword"> const</span>
<a name="l00603"></a>00603 <span class="keyword"></span>{
<a name="l00604"></a>00604   <span class="comment">// Infinity arithmetic:</span>
<a name="l00605"></a>00605   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00606"></a>00606 
<a name="l00607"></a>00607   <span class="keywordflow">if</span> (l == 0 || *<span class="keyword">this</span> == 0L)            <span class="comment">// if either arg is zero</span>
<a name="l00608"></a>00608     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00609"></a>00609   <span class="keywordflow">if</span> (l &lt; 0)                            <span class="comment">// if shift amt is negative</span>
<a name="l00610"></a>00610     <span class="keywordflow">return</span> <a class="code" href="classvnl__bignum.html#af93d4395d73af5768ee6d3dc4b3d6148" title="right shift (arithmetic) non-infinite vnl_bignum by positive number.">right_shift</a>(*<span class="keyword">this</span>,-l);       <span class="comment">//   do an actual right shift</span>
<a name="l00611"></a>00611   <span class="keywordflow">else</span>                                  <span class="comment">// otherwise</span>
<a name="l00612"></a>00612     <span class="keywordflow">return</span> <a class="code" href="classvnl__bignum.html#a8c3b604532a229147489a3797fc96080" title="left shift (arithmetic) non-infinite vnl_bignum by positive number.">left_shift</a>(*<span class="keyword">this</span>,l);         <span class="comment">//   do a left shift</span>
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="comment">//: Shifts bignum to the right l digits.</span>
<a name="l00616"></a>00616 
<a name="l00617"></a><a class="code" href="classvnl__bignum.html#a0863570eca51e5fd1cf68edf1960c0c0">00617</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> <a class="code" href="classvnl__bignum.html#a0863570eca51e5fd1cf68edf1960c0c0" title="Shifts bignum to the right l digits.">vnl_bignum::operator&gt;&gt;</a>(<span class="keywordtype">int</span> l)<span class="keyword"> const</span>
<a name="l00618"></a>00618 <span class="keyword"></span>{
<a name="l00619"></a>00619   <span class="comment">// Infinity arithmetic:</span>
<a name="l00620"></a>00620   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00621"></a>00621 
<a name="l00622"></a>00622   <span class="keywordflow">if</span> (l == 0 || *<span class="keyword">this</span> == 0L)            <span class="comment">// if either arg is zero</span>
<a name="l00623"></a>00623     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00624"></a>00624   <span class="keywordflow">if</span> (l &lt; 0)                            <span class="comment">// if shift amt is negative</span>
<a name="l00625"></a>00625     <span class="keywordflow">return</span> <a class="code" href="classvnl__bignum.html#a8c3b604532a229147489a3797fc96080" title="left shift (arithmetic) non-infinite vnl_bignum by positive number.">left_shift</a>(*<span class="keyword">this</span>,-l);        <span class="comment">//   do an actual left shift</span>
<a name="l00626"></a>00626   <span class="keywordflow">else</span>                                  <span class="comment">// else</span>
<a name="l00627"></a>00627     <span class="keywordflow">return</span> <a class="code" href="classvnl__bignum.html#af93d4395d73af5768ee6d3dc4b3d6148" title="right shift (arithmetic) non-infinite vnl_bignum by positive number.">right_shift</a>(*<span class="keyword">this</span>,l);        <span class="comment">//   do a right shift</span>
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="comment">//: Two vnl_bignums are equal if and only if they have the same integer representation.</span>
<a name="l00631"></a>00631 
<a name="l00632"></a><a class="code" href="classvnl__bignum.html#a3c3b75fc6eadb106df3142f7a5f95ccc">00632</a> <span class="keywordtype">bool</span> <a class="code" href="classvnl__bignum.html#a3c3b75fc6eadb106df3142f7a5f95ccc" title="Two vnl_bignums are equal if and only if they have the same integer representation.">vnl_bignum::operator==</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; rhs)<span class="keyword"> const</span>
<a name="l00633"></a>00633 <span class="keyword"></span>{
<a name="l00634"></a>00634   <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;rhs) {                           <span class="comment">// Check address</span>
<a name="l00635"></a>00635     <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> != rhs.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">// Different sign implies !=</span>
<a name="l00636"></a>00636     <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> != rhs.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Different size implies !=</span>
<a name="l00637"></a>00637     <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0; i &lt; this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i++)   <span class="comment">// Each data element the same?</span>
<a name="l00638"></a>00638       <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] != rhs.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i]) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// No. Return !=</span>
<a name="l00639"></a>00639   }
<a name="l00640"></a>00640   <span class="keywordflow">return</span> <span class="keyword">true</span>;                                    <span class="comment">// Yes. Return ==</span>
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a>00643 <span class="comment">//: Compares two vnl_bignums.</span>
<a name="l00644"></a>00644 
<a name="l00645"></a><a class="code" href="classvnl__bignum.html#a55a29c8edfd30a6eb30148ca2317fb32">00645</a> <span class="keywordtype">bool</span> <a class="code" href="classvnl__bignum.html#a55a29c8edfd30a6eb30148ca2317fb32" title="Compares two vnl_bignums.">vnl_bignum::operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; rhs)<span class="keyword"> const</span>
<a name="l00646"></a>00646 <span class="keyword"></span>{
<a name="l00647"></a>00647   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; rhs.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;       <span class="comment">// Different signs?</span>
<a name="l00648"></a>00648   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &gt; rhs.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00649"></a>00649   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> == 1)                          <span class="comment">// Both signs == 1</span>
<a name="l00650"></a>00650     <span class="keywordflow">return</span> <a class="code" href="classvnl__bignum.html#ab6e951d56b76927509f672ac33acce87" title="compare absolute values of two vnl_bignums.">magnitude_cmp</a>(*<span class="keyword">this</span>,rhs) &lt; 0;        <span class="comment">// this must be smaller</span>
<a name="l00651"></a>00651   <span class="keywordflow">else</span>                                          <span class="comment">// Both signs == -1</span>
<a name="l00652"></a>00652     <span class="keywordflow">return</span> <a class="code" href="classvnl__bignum.html#ab6e951d56b76927509f672ac33acce87" title="compare absolute values of two vnl_bignums.">magnitude_cmp</a>(*<span class="keyword">this</span>,rhs) &gt; 0;        <span class="comment">// this must be larger</span>
<a name="l00653"></a>00653 }
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 <span class="comment">//: Formatted output for bignum.</span>
<a name="l00656"></a>00656 
<a name="l00657"></a><a class="code" href="vnl__bignum_8h.html#ac7e9f3d3892851b694ffcba16e15bba7">00657</a> vcl_ostream&amp; <a class="code" href="classvnl__decnum.html#adcc2858d370ba80f8ca07e98ef382e37" title="decimal output.">operator&lt;&lt;</a>(vcl_ostream&amp; os, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)
<a name="l00658"></a>00658 {
<a name="l00659"></a>00659   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> d = b;                     <span class="comment">// Copy the input vnl_bignum</span>
<a name="l00660"></a>00660   <span class="keywordflow">if</span> (d.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> == -1) {                   <span class="comment">// If it&#39;s negative</span>
<a name="l00661"></a>00661     os &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;                          <span class="comment">//   Output leading minus sign</span>
<a name="l00662"></a>00662     d.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = 1;                         <span class="comment">//   Make d positive for divide</span>
<a name="l00663"></a>00663   }
<a name="l00664"></a>00664   <span class="keywordflow">if</span> (d.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> os&lt;&lt;<span class="stringliteral">&quot;Inf&quot;</span>;
<a name="l00665"></a>00665   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> q,r;                       <span class="comment">// Temp quotient and remainder</span>
<a name="l00666"></a>00666   <span class="keywordtype">char</span> *cbuf = <span class="keyword">new</span> <span class="keywordtype">char</span>[5 * (b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>+1)];   <span class="comment">// Temp character buffer</span>
<a name="l00667"></a>00667   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l00668"></a>00668   <span class="keywordflow">do</span> {                                  <span class="comment">// repeat:</span>
<a name="l00669"></a>00669     <a class="code" href="vnl__bignum_8cxx.html#ab4ede6b6a012ca91514c08c576035fcb" title="divide b2 into b1, getting quotient q and remainder r.">divide</a>(d,10L,q,r);                  <span class="comment">//   Divide vnl_bignum by ten</span>
<a name="l00670"></a>00670     cbuf[i++] = char(<span class="keywordtype">long</span>(r) + <span class="charliteral">&#39;0&#39;</span>);    <span class="comment">//   Get one&#39;s digit</span>
<a name="l00671"></a>00671     d = q;                              <span class="comment">//   Then discard one&#39;s digit</span>
<a name="l00672"></a>00672     q = r = 0L;                         <span class="comment">//   Prep for next divide</span>
<a name="l00673"></a>00673   } <span class="keywordflow">while</span> (d != 0L);                    <span class="comment">// until no more one&#39;s digits</span>
<a name="l00674"></a>00674   <span class="keywordflow">do</span> {                                  <span class="comment">// repeat;</span>
<a name="l00675"></a>00675     os &lt;&lt; cbuf[--i];                    <span class="comment">//   output char buf in reverse</span>
<a name="l00676"></a>00676   } <span class="keywordflow">while</span> (i);                          <span class="comment">// until no more chars</span>
<a name="l00677"></a>00677   <span class="keyword">delete</span> [] cbuf;                       <span class="comment">// delete temp char buf</span>
<a name="l00678"></a>00678   <span class="keywordflow">return</span> os;                            <span class="comment">// return output stream</span>
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 <span class="comment">//: Convert the number to a decimal representation in a string.</span>
<a name="l00682"></a>00682 
<a name="l00683"></a><a class="code" href="vnl__bignum_8h.html#a7080eb6c4a42d24652151a7ed475d416">00683</a> vcl_string&amp; <a class="code" href="vnl__bignum_8cxx.html#a2b9b148e515122ec2883d0871f6f9ab5" title="Convert the number to a decimal representation in a string.">vnl_bignum_to_string</a>(vcl_string&amp; s, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b)
<a name="l00684"></a>00684 {
<a name="l00685"></a>00685   s.erase();
<a name="l00686"></a>00686   vcl_string::size_type insert_point = 0; <span class="comment">// keep record of location of first number.</span>
<a name="l00687"></a>00687 
<a name="l00688"></a>00688   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> d = b;                     <span class="comment">// Copy the input vnl_bignum</span>
<a name="l00689"></a>00689   <span class="keywordflow">if</span> (d.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> == -1) {                   <span class="comment">// If it&#39;s negative</span>
<a name="l00690"></a>00690     s.insert(insert_point,<span class="stringliteral">&quot;-&quot;</span>);         <span class="comment">//   Output leading minus sign</span>
<a name="l00691"></a>00691     d.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = 1;                         <span class="comment">//   Make d positive for divide</span>
<a name="l00692"></a>00692     ++insert_point;                     <span class="comment">// keep record of location of first number.</span>
<a name="l00693"></a>00693   }
<a name="l00694"></a>00694   <span class="keywordflow">if</span> (d.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> s+=<span class="stringliteral">&quot;Inf&quot;</span>;
<a name="l00695"></a>00695   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> q,r;                       <span class="comment">// Temp quotient and remainder</span>
<a name="l00696"></a>00696   <span class="keywordflow">do</span> {                                  <span class="comment">// repeat:</span>
<a name="l00697"></a>00697     <a class="code" href="vnl__bignum_8cxx.html#ab4ede6b6a012ca91514c08c576035fcb" title="divide b2 into b1, getting quotient q and remainder r.">divide</a>(d,10L,q,r);                  <span class="comment">//   Divide vnl_bignum by ten</span>
<a name="l00698"></a>00698     s.insert(insert_point, 1, <span class="keywordtype">char</span>(<span class="charliteral">&#39;0&#39;</span>+<span class="keywordtype">long</span>(r))); <span class="comment">//   Get one&#39;s digit, and insert it at head.</span>
<a name="l00699"></a>00699     d = q;                              <span class="comment">//   Then discard one&#39;s digit</span>
<a name="l00700"></a>00700     q = r = 0L;                         <span class="comment">//   Prep for next divide</span>
<a name="l00701"></a>00701   } <span class="keywordflow">while</span> (d != 0L);                    <span class="comment">// until no more one&#39;s digits</span>
<a name="l00702"></a>00702   <span class="keywordflow">return</span> s;
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 <span class="comment">//: Convert the number from a decimal representation in a string.</span>
<a name="l00706"></a>00706 
<a name="l00707"></a><a class="code" href="vnl__bignum_8h.html#a290c64a62c3cffd2b00f28a97f505753">00707</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="vnl__bignum_8cxx.html#ac1cd1c5667323722b9ce2f82a35c3be3" title="Convert the number from a decimal representation in a string.">vnl_bignum_from_string</a>(<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b, <span class="keyword">const</span> vcl_string&amp; s)
<a name="l00708"></a>00708 {
<a name="l00709"></a>00709   <span class="comment">// decimal:     &quot;^ *[-+]?[1-9][0-9]*$&quot;</span>
<a name="l00710"></a>00710   <span class="comment">// Infinity:    &quot;^ *[-+]?Inf(inity)?$&quot;</span>
<a name="l00711"></a>00711 
<a name="l00712"></a>00712   <span class="keywordflow">if</span> (is_plus_inf(s.c_str()))
<a name="l00713"></a>00713     b=<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>(<span class="stringliteral">&quot;+Inf&quot;</span>);
<a name="l00714"></a>00714   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_minus_inf(s.c_str()))
<a name="l00715"></a>00715     b=<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>(<span class="stringliteral">&quot;-Inf&quot;</span>);
<a name="l00716"></a>00716   <span class="keywordflow">else</span>
<a name="l00717"></a>00717     b.<a class="code" href="classvnl__bignum.html#a111e6a2f11ca62135eda81faff1acda6" title="Converts decimal string to a vnl_bignum.">dtoBigNum</a>(s.c_str());             <span class="comment">// convert decimal to vnl_bignum</span>
<a name="l00718"></a>00718   <span class="keywordflow">return</span> b;
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="comment">//: Implicit conversion from a vnl_bignum to a short.</span>
<a name="l00722"></a>00722 
<a name="l00723"></a><a class="code" href="classvnl__bignum.html#a451aa5ee7d3b844bdf9d8fb76f6eee16">00723</a> <a class="code" href="classvnl__bignum.html#a451aa5ee7d3b844bdf9d8fb76f6eee16" title="Implicit conversion from a vnl_bignum to a short.">vnl_bignum::operator short</a>()<span class="keyword"> const</span>
<a name="l00724"></a>00724 <span class="keyword"></span>{
<a name="l00725"></a>00725   <span class="keywordtype">int</span> j = this-&gt;<a class="code" href="classvnl__bignum.html#ae6d593d65cf371da3bcef3596d536633" title="Implicit conversion from a vnl_bignum to an int.">operator int</a>();
<a name="l00726"></a>00726   <span class="keywordflow">return</span> (<span class="keywordtype">short</span>)j;
<a name="l00727"></a>00727 }
<a name="l00728"></a>00728 
<a name="l00729"></a>00729 <span class="comment">//: Implicit conversion from a vnl_bignum to an int.</span>
<a name="l00730"></a>00730 
<a name="l00731"></a><a class="code" href="classvnl__bignum.html#ae6d593d65cf371da3bcef3596d536633">00731</a> <a class="code" href="classvnl__bignum.html#ae6d593d65cf371da3bcef3596d536633" title="Implicit conversion from a vnl_bignum to an int.">vnl_bignum::operator int</a>()<span class="keyword"> const</span>
<a name="l00732"></a>00732 <span class="keyword"></span>{
<a name="l00733"></a>00733   <span class="keywordtype">int</span> j = 0;
<a name="l00734"></a>00734   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i &gt; 0; )
<a name="l00735"></a>00735     j = <span class="keywordtype">int</span>(j*0x10000 + this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[--i]);
<a name="l00736"></a>00736   <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0) ? -j : j;
<a name="l00737"></a>00737 }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 <span class="comment">//: Implicit conversion from a vnl_bignum to a long.</span>
<a name="l00740"></a>00740 
<a name="l00741"></a><a class="code" href="classvnl__bignum.html#ab4363e2f7b6cc7df9207f49cad3193f8">00741</a> <a class="code" href="classvnl__bignum.html#ab4363e2f7b6cc7df9207f49cad3193f8" title="Implicit conversion from a vnl_bignum to a long.">vnl_bignum::operator long</a>()<span class="keyword"> const</span>
<a name="l00742"></a>00742 <span class="keyword"></span>{
<a name="l00743"></a>00743   <span class="keywordtype">long</span> l = 0;
<a name="l00744"></a>00744   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i &gt; 0; )
<a name="l00745"></a>00745     l = l*0x10000L + this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[--i];
<a name="l00746"></a>00746   <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0) ? -l : l;
<a name="l00747"></a>00747 }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749 <span class="comment">//: Implicit conversion from a vnl_bignum to a float.</span>
<a name="l00750"></a>00750 
<a name="l00751"></a><a class="code" href="classvnl__bignum.html#ab260bae81a994d2b7b2b4b8efc0e2a69">00751</a> <a class="code" href="classvnl__bignum.html#ab260bae81a994d2b7b2b4b8efc0e2a69" title="Implicit conversion from a vnl_bignum to a float.">vnl_bignum::operator float</a>()<span class="keyword"> const</span>
<a name="l00752"></a>00752 <span class="keyword"></span>{
<a name="l00753"></a>00753   <span class="keywordtype">float</span> f = 0.0f;
<a name="l00754"></a>00754   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i &gt; 0; )
<a name="l00755"></a>00755     f = f*0x10000 + this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[--i];
<a name="l00756"></a>00756   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) f = vcl_numeric_limits&lt;float&gt;::infinity();
<a name="l00757"></a>00757   <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0) ? -f : f;
<a name="l00758"></a>00758 }
<a name="l00759"></a>00759 
<a name="l00760"></a>00760 <span class="comment">//: Implicit conversion from a vnl_bignum to a double.</span>
<a name="l00761"></a>00761 
<a name="l00762"></a><a class="code" href="classvnl__bignum.html#aa996e36657aa681041995307ef551fad">00762</a> <a class="code" href="classvnl__bignum.html#aa996e36657aa681041995307ef551fad" title="Implicit conversion from a vnl_bignum to a double.">vnl_bignum::operator double</a>()<span class="keyword"> const</span>
<a name="l00763"></a>00763 <span class="keyword"></span>{
<a name="l00764"></a>00764   <span class="keywordtype">double</span> d = 0.0;
<a name="l00765"></a>00765   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i &gt; 0; )
<a name="l00766"></a>00766     d = d*0x10000 + this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[--i];
<a name="l00767"></a>00767   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) d = vcl_numeric_limits&lt;double&gt;::infinity();
<a name="l00768"></a>00768   <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0) ? -d : d;
<a name="l00769"></a>00769 }
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 <span class="comment">//: Implicit conversion from a vnl_bignum to a long double.</span>
<a name="l00772"></a>00772 
<a name="l00773"></a><a class="code" href="classvnl__bignum.html#aafee6123f4813c6348f9737846ccc303">00773</a> <a class="code" href="classvnl__bignum.html#aafee6123f4813c6348f9737846ccc303" title="Implicit conversion from a vnl_bignum to a long double.">vnl_bignum::operator long double</a>()<span class="keyword"> const</span>
<a name="l00774"></a>00774 <span class="keyword"></span>{
<a name="l00775"></a>00775   <span class="keywordtype">long</span> <span class="keywordtype">double</span> d = 0.0;
<a name="l00776"></a>00776   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i &gt; 0; )
<a name="l00777"></a>00777     d = d*0x10000 + this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[--i];
<a name="l00778"></a>00778   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) d = vcl_numeric_limits&lt;long double&gt;::infinity();
<a name="l00779"></a>00779   <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> &lt; 0) ? -d : d;
<a name="l00780"></a>00780 }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782 <span class="comment">//: dump the contents of a vnl_bignum to a stream, default cout.</span>
<a name="l00783"></a>00783 
<a name="l00784"></a><a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1">00784</a> <span class="keywordtype">void</span> <a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">vnl_bignum::dump</a>(vcl_ostream&amp; os)<span class="keyword"> const</span>
<a name="l00785"></a>00785 <span class="keyword"></span>{
<a name="l00786"></a>00786   os &lt;&lt; <span class="stringliteral">&quot;{count=&quot;</span> &lt;&lt; this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>       <span class="comment">// output count field</span>
<a name="l00787"></a>00787      &lt;&lt; <span class="stringliteral">&quot;, sign=&quot;</span> &lt;&lt; this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>        <span class="comment">// output sign field</span>
<a name="l00788"></a>00788      &lt;&lt; <span class="stringliteral">&quot;, data=&quot;</span> &lt;&lt; this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>        <span class="comment">// output data pointer</span>
<a name="l00789"></a>00789      &lt;&lt; <span class="stringliteral">&quot;, value=&quot;</span> &lt;&lt; *<span class="keyword">this</span>
<a name="l00790"></a>00790      &lt;&lt; <span class="stringliteral">&quot;, {&quot;</span>;
<a name="l00791"></a>00791   <span class="comment">// format string == &quot;%04X%s&quot; or &quot;%02X%s&quot;, etc.</span>
<a name="l00792"></a>00792   <span class="comment">//  static char format_str[10] =</span>
<a name="l00793"></a>00793   <span class="comment">//    {&#39;%&#39;,&#39;0&#39;,char(2*2 + &#39;0&#39;),&#39;X&#39;,&#39;%&#39;,&#39;s&#39;};</span>
<a name="l00794"></a>00794   <span class="comment">//  format_str[2] = char(2*2 + &#39;0&#39;);</span>
<a name="l00795"></a>00795   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &gt; 0) { <span class="comment">// output data array</span>
<a name="l00796"></a>00796     os &lt;&lt; vcl_hex &lt;&lt; (this-&gt;data[this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>-1]);
<a name="l00797"></a>00797     <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1; i &gt; 0; --i) {
<a name="l00798"></a>00798       os  &lt;&lt; <span class="charliteral">&#39;,&#39;</span>;
<a name="l00799"></a>00799       <span class="keywordflow">if</span> (this-&gt;data[i-1] &lt; 0x10) os &lt;&lt; <span class="charliteral">&#39;0&#39;</span>;
<a name="l00800"></a>00800       <span class="keywordflow">if</span> (this-&gt;data[i-1] &lt; 0x100) os &lt;&lt; <span class="charliteral">&#39;0&#39;</span>;
<a name="l00801"></a>00801       <span class="keywordflow">if</span> (this-&gt;data[i-1] &lt; 0x1000) os &lt;&lt; <span class="charliteral">&#39;0&#39;</span>;
<a name="l00802"></a>00802       os  &lt;&lt; this-&gt;data[i-1];
<a name="l00803"></a>00803     }
<a name="l00804"></a>00804     os &lt;&lt; vcl_dec;
<a name="l00805"></a>00805   }
<a name="l00806"></a>00806   os &lt;&lt; <span class="stringliteral">&quot;}}\n&quot;</span>;                         <span class="comment">// close brackets</span>
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">//: Converts decimal string to a vnl_bignum.</span>
<a name="l00810"></a>00810 
<a name="l00811"></a><a class="code" href="classvnl__bignum.html#a111e6a2f11ca62135eda81faff1acda6">00811</a> <span class="keywordtype">int</span> <a class="code" href="classvnl__bignum.html#a111e6a2f11ca62135eda81faff1acda6" title="Converts decimal string to a vnl_bignum.">vnl_bignum::dtoBigNum</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00812"></a>00812 {
<a name="l00813"></a>00813   this-&gt;<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(0); this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = 1;      <span class="comment">// Reset number to 0.</span>
<a name="l00814"></a>00814   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> len = 0;                      <span class="comment">// No chars converted yet</span>
<a name="l00815"></a>00815   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> sum;
<a name="l00816"></a>00816   <span class="keywordflow">while</span> (*s == <span class="charliteral">&#39; &#39;</span> || *s == <span class="charliteral">&#39;\t&#39;</span> || *s == <span class="charliteral">&#39;\n&#39;</span> || *s == <span class="charliteral">&#39;\r&#39;</span>) ++s; <span class="comment">// skip whitespace</span>
<a name="l00817"></a>00817   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;-&#39;</span> || *s == <span class="charliteral">&#39;+&#39;</span>) ++len;    <span class="comment">// Skip over leading +,-</span>
<a name="l00818"></a>00818   <span class="keywordflow">while</span> (s[len]&gt;=<span class="charliteral">&#39;0&#39;</span> &amp;&amp; s[len]&lt;=<span class="charliteral">&#39;9&#39;</span>) {  <span class="comment">// While current char is digit</span>
<a name="l00819"></a>00819     *<span class="keyword">this</span> *= <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum</a>(10L),           <span class="comment">// Shift vnl_bignum left a decimal</span>
<a name="l00820"></a>00820     <a class="code" href="classvnl__bignum.html#a12003ffc085efff112a8727ff58ad920" title="add two non-infinite vnl_bignum values and save their sum.">add</a>(*<span class="keyword">this</span>,<a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum</a>(<span class="keywordtype">long</span>(s[len++]-<span class="charliteral">&#39;0&#39;</span>)),sum), <span class="comment">// digit and add new digit</span>
<a name="l00821"></a>00821     *<span class="keyword">this</span> = sum;
<a name="l00822"></a>00822   }
<a name="l00823"></a>00823   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;-&#39;</span>) this-&gt;<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = -1;       <span class="comment">// If s had leading -, note it</span>
<a name="l00824"></a>00824   <span class="keywordflow">return</span> len;                           <span class="comment">// Return # of chars processed</span>
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 <span class="comment">//: convert exponential string to a vnl_bignum</span>
<a name="l00828"></a>00828 
<a name="l00829"></a><a class="code" href="classvnl__bignum.html#a501e8d1aa5b0693cf0bb05e4e1b32f25">00829</a> <span class="keywordtype">void</span> <a class="code" href="classvnl__bignum.html#a501e8d1aa5b0693cf0bb05e4e1b32f25" title="convert exponential string to a vnl_bignum.">vnl_bignum::exptoBigNum</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00830"></a>00830 {
<a name="l00831"></a>00831   <span class="keywordflow">while</span> (*s == <span class="charliteral">&#39; &#39;</span> || *s == <span class="charliteral">&#39;\t&#39;</span> || *s == <span class="charliteral">&#39;\n&#39;</span> || *s == <span class="charliteral">&#39;\r&#39;</span>) ++s; <span class="comment">// skip whitespace</span>
<a name="l00832"></a>00832   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> pos = <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>(this-&gt;<a class="code" href="classvnl__bignum.html#a111e6a2f11ca62135eda81faff1acda6" title="Converts decimal string to a vnl_bignum.">dtoBigNum</a>(s) + 1); <span class="comment">// Convert the base, skip [eE]</span>
<a name="l00833"></a>00833   <span class="keywordtype">long</span> <a class="code" href="vnl__decnum_8h.html#a0c7b72fd2cbcacf2f79d0b6f81cb9d3d">pow</a> = vcl_atol(s + pos);         <span class="comment">// Convert the exponent to long</span>
<a name="l00834"></a>00834   <span class="keywordflow">while</span> (pow-- &gt; 0)                     <span class="comment">// Raise vnl_bignum to the given</span>
<a name="l00835"></a>00835     *<span class="keyword">this</span> = (*this) * 10L;              <span class="comment">// power</span>
<a name="l00836"></a>00836 }
<a name="l00837"></a>00837 
<a name="l00838"></a>00838 <span class="comment">//: convert hex character to integer hex value (ASCII or EBCDIC)</span>
<a name="l00839"></a>00839 <span class="comment">// - Inputs:  character representation of a hex number</span>
<a name="l00840"></a>00840 <span class="comment">// - Outputs: integer value of the hex number</span>
<a name="l00841"></a>00841 
<a name="l00842"></a><a class="code" href="vnl__bignum_8cxx.html#a562025e95d5766e9e1cb99570b056580">00842</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vnl__bignum_8cxx.html#a562025e95d5766e9e1cb99570b056580" title="convert hex character to integer hex value (ASCII or EBCDIC).">ctox</a>(<span class="keywordtype">int</span> c)
<a name="l00843"></a>00843 {
<a name="l00844"></a>00844   <span class="keywordflow">if</span> (<span class="charliteral">&#39;0&#39;</span> &lt;= c &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>)
<a name="l00845"></a>00845     <span class="keywordflow">return</span> c - <span class="charliteral">&#39;0&#39;</span>;
<a name="l00846"></a>00846   <span class="keywordflow">if</span> (<span class="charliteral">&#39;a&#39;</span> &lt;= c &amp;&amp; c &lt;= <span class="charliteral">&#39;f&#39;</span>)
<a name="l00847"></a>00847     <span class="keywordflow">return</span> c - <span class="charliteral">&#39;a&#39;</span> + 10;
<a name="l00848"></a>00848   <span class="keywordflow">return</span> c - <span class="charliteral">&#39;A&#39;</span> + 10;
<a name="l00849"></a>00849 }
<a name="l00850"></a>00850 
<a name="l00851"></a>00851 <span class="comment">//: convert hex string to vnl_bignum</span>
<a name="l00852"></a>00852 
<a name="l00853"></a><a class="code" href="classvnl__bignum.html#a84559dec19e42813bd2305ab507b9648">00853</a> <span class="keywordtype">void</span> <a class="code" href="classvnl__bignum.html#a84559dec19e42813bd2305ab507b9648" title="convert hex string to vnl_bignum.">vnl_bignum::xtoBigNum</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00854"></a>00854 {
<a name="l00855"></a>00855   this-&gt;<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(0); <a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = 1;            <span class="comment">// Reset number to 0.</span>
<a name="l00856"></a>00856   <span class="keywordflow">while</span> (*s == <span class="charliteral">&#39; &#39;</span> || *s == <span class="charliteral">&#39;\t&#39;</span> || *s == <span class="charliteral">&#39;\n&#39;</span> || *s == <span class="charliteral">&#39;\r&#39;</span>) ++s; <span class="comment">// skip whitespace</span>
<a name="l00857"></a>00857   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> size = <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>(vcl_strlen(s));
<a name="l00858"></a>00858   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> len = 2;                      <span class="comment">// skip leading &quot;0x&quot;</span>
<a name="l00859"></a>00859   <span class="keywordflow">while</span> (len &lt; size) {                  <span class="comment">// While there are more chars</span>
<a name="l00860"></a>00860     (*this) = ((*this) * 16L) +         <span class="comment">// Shift vnl_bignum left one hex</span>
<a name="l00861"></a>00861       <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum</a>(<span class="keywordtype">long</span>(<a class="code" href="vnl__bignum_8cxx.html#a562025e95d5766e9e1cb99570b056580" title="convert hex character to integer hex value (ASCII or EBCDIC).">ctox</a>(s[len++]))); <span class="comment">//   digit and add next digit</span>
<a name="l00862"></a>00862   }
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a>00865 <span class="comment">//: convert octal string to vnl_bignum</span>
<a name="l00866"></a>00866 
<a name="l00867"></a><a class="code" href="classvnl__bignum.html#a53d2cb32473a259028e17afe4260c361">00867</a> <span class="keywordtype">void</span> <a class="code" href="classvnl__bignum.html#a53d2cb32473a259028e17afe4260c361" title="convert octal string to vnl_bignum.">vnl_bignum::otoBigNum</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)
<a name="l00868"></a>00868 {
<a name="l00869"></a>00869   this-&gt;<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(0); <a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = 1;           <span class="comment">// Reset number to 0.</span>
<a name="l00870"></a>00870   <span class="keywordflow">while</span> (*s == <span class="charliteral">&#39; &#39;</span> || *s == <span class="charliteral">&#39;\t&#39;</span> || *s == <span class="charliteral">&#39;\n&#39;</span> || *s == <span class="charliteral">&#39;\r&#39;</span>) ++s; <span class="comment">// skip whitespace</span>
<a name="l00871"></a>00871   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> size = <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>(vcl_strlen(s));
<a name="l00872"></a>00872   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> len = 0;                      <span class="comment">// No chars converted yet</span>
<a name="l00873"></a>00873   <span class="keywordflow">while</span> (len &lt; size) {                  <span class="comment">// While there are more chars</span>
<a name="l00874"></a>00874     (*this) = ((*this) * 8L) +          <span class="comment">// Shift vnl_bignum left 1 oct dig.</span>
<a name="l00875"></a>00875       <a class="code" href="classvnl__bignum.html#af9b54b5d0e840f34173c276a5b1112b4" title="Creates a zero vnl_bignum.">vnl_bignum</a>(<span class="keywordtype">long</span>(s[len++] - <span class="charliteral">&#39;0&#39;</span>)); <span class="comment">// Add next character value</span>
<a name="l00876"></a>00876   }
<a name="l00877"></a>00877 }
<a name="l00878"></a>00878 
<a name="l00879"></a>00879 <span class="comment">//: change the data allotment for a vnl_bignum</span>
<a name="l00880"></a>00880 
<a name="l00881"></a><a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d">00881</a> <span class="keywordtype">void</span> <a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">vnl_bignum::resize</a>(<span class="keywordtype">short</span> new_count)
<a name="l00882"></a>00882 {
<a name="l00883"></a>00883   assert(new_count &gt;= 0);
<a name="l00884"></a>00884   <span class="keywordflow">if</span> (new_count == this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) <span class="keywordflow">return</span>;
<a name="l00885"></a>00885   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> *new_data = (new_count &gt; 0 ? <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[new_count] : 0); <span class="comment">// Allocate data if necessary</span>
<a name="l00886"></a>00886 
<a name="l00887"></a>00887   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &lt;= new_count) {       <span class="comment">// Copy old data into new</span>
<a name="l00888"></a>00888     <span class="keywordtype">short</span> i = 0;
<a name="l00889"></a>00889     <span class="keywordflow">for</span> (; i &lt; this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i++)
<a name="l00890"></a>00890       new_data[i] = this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i];
<a name="l00891"></a>00891     <span class="keywordflow">for</span> (; i &lt; new_count; i++)
<a name="l00892"></a>00892       new_data[i] = 0;
<a name="l00893"></a>00893   }
<a name="l00894"></a>00894   <span class="keywordflow">else</span> {
<a name="l00895"></a>00895     <span class="keywordflow">for</span> (<span class="keywordtype">short</span> i = 0; i &lt; new_count; i++)
<a name="l00896"></a>00896       new_data[i] = this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i];
<a name="l00897"></a>00897   }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899   <span class="keyword">delete</span> [] this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>;                 <span class="comment">// Get rid of old data</span>
<a name="l00900"></a>00900   this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = new_data;                <span class="comment">// Point to new data</span>
<a name="l00901"></a>00901   this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> = new_count;              <span class="comment">// Save new count</span>
<a name="l00902"></a>00902 }
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="comment">//: trim non-infinite vnl_bignum of excess data allotment</span>
<a name="l00905"></a>00905 
<a name="l00906"></a><a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030">00906</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030" title="trim non-infinite vnl_bignum of excess data allotment.">vnl_bignum::trim</a>()
<a name="l00907"></a>00907 {
<a name="l00908"></a>00908   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>;
<a name="l00909"></a>00909   <span class="keywordflow">for</span> (; i &gt; 0; i--)                    <span class="comment">// Skip over high-order words</span>
<a name="l00910"></a>00910     <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1] != 0) <span class="keywordflow">break</span>;  <span class="comment">//   that are zero</span>
<a name="l00911"></a>00911   <span class="keywordflow">if</span> (i &lt; this-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) {                <span class="comment">// If there are some such words</span>
<a name="l00912"></a>00912     this-&gt;count = i;                    <span class="comment">// Update the count</span>
<a name="l00913"></a>00913     <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> *new_data = (i &gt; 0 ? <span class="keyword">new</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>[i] : 0); <span class="comment">// Allocate data if necessary</span>
<a name="l00914"></a>00914     <span class="keywordflow">for</span> (; i &gt; 0; i--)                  <span class="comment">// Copy old data into new</span>
<a name="l00915"></a>00915       new_data[i - 1] = this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1];
<a name="l00916"></a>00916     <span class="keyword">delete</span> [] this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>;               <span class="comment">// Delete old data</span>
<a name="l00917"></a>00917     this-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a> = new_data;              <span class="comment">// Point to new data</span>
<a name="l00918"></a>00918   }
<a name="l00919"></a>00919   <span class="keywordflow">return</span> *<span class="keyword">this</span>;                         <span class="comment">// return reference to vnl_bignum</span>
<a name="l00920"></a>00920 }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922 <span class="comment">//: add two non-infinite vnl_bignum values and save their sum</span>
<a name="l00923"></a>00923 
<a name="l00924"></a><a class="code" href="vnl__bignum_8h.html#a12003ffc085efff112a8727ff58ad920">00924</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#a19c8917d449fe18d6eb6d381b6979d86" title="add two non-infinite vnl_bignum values and save their sum.">add</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b2, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; sum)
<a name="l00925"></a>00925 {
<a name="l00926"></a>00926   <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> *bmax, *bmin;        <span class="comment">// Determine which of the two</span>
<a name="l00927"></a>00927   <span class="keywordflow">if</span> (b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &gt;= b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) {           <span class="comment">//   addends has the most</span>
<a name="l00928"></a>00928     bmax = &amp;b1;                         <span class="comment">//   data.</span>
<a name="l00929"></a>00929     bmin = &amp;b2;
<a name="l00930"></a>00930   }
<a name="l00931"></a>00931   <span class="keywordflow">else</span> {
<a name="l00932"></a>00932     bmax = &amp;b2;
<a name="l00933"></a>00933     bmin = &amp;b1;
<a name="l00934"></a>00934   }
<a name="l00935"></a>00935   sum.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(bmax-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>);              <span class="comment">// Allocate data for their sum</span>
<a name="l00936"></a>00936   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> temp, carry = 0;
<a name="l00937"></a>00937   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l00938"></a>00938   <span class="keywordflow">while</span> (i &lt; bmin-&gt;count) {             <span class="comment">// Add, element by element.</span>
<a name="l00939"></a>00939     <span class="comment">// Add both elements and carry</span>
<a name="l00940"></a>00940     temp = (<span class="keywordtype">unsigned</span> long)b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)b2.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + carry;
<a name="l00941"></a>00941     carry = temp/0x10000L;              <span class="comment">// keep track of the carry</span>
<a name="l00942"></a>00942     sum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(temp);           <span class="comment">// store sum</span>
<a name="l00943"></a>00943     i++;                                <span class="comment">// go to next element</span>
<a name="l00944"></a>00944   }
<a name="l00945"></a>00945   <span class="keywordflow">while</span> (i &lt; bmax-&gt;count) {             <span class="comment">// bmin has no more elements</span>
<a name="l00946"></a>00946     temp = bmax-&gt;<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + carry;       <span class="comment">// propagate the carry through</span>
<a name="l00947"></a>00947     carry = temp/0x10000L;              <span class="comment">// the rest of bmax&#39;s elements</span>
<a name="l00948"></a>00948     sum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(temp);           <span class="comment">// store sum</span>
<a name="l00949"></a>00949     i++;
<a name="l00950"></a>00950   }
<a name="l00951"></a>00951   <span class="keywordflow">if</span> (carry) {                          <span class="comment">// if carry left over</span>
<a name="l00952"></a>00952     sum.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(bmax-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + 1);        <span class="comment">//   allocate another word</span>
<a name="l00953"></a>00953     sum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[bmax-&gt;<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>] = 1;          <span class="comment">//   save the carry in it</span>
<a name="l00954"></a>00954   }
<a name="l00955"></a>00955 }
<a name="l00956"></a>00956 
<a name="l00957"></a>00957 <span class="comment">//: Add 1 to bnum (unsigned, non-infinite)</span>
<a name="l00958"></a>00958 
<a name="l00959"></a><a class="code" href="vnl__bignum_8h.html#a5d55189cd1270075bb594d7a3128506c">00959</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#a5d55189cd1270075bb594d7a3128506c" title="Add 1 to bnum (unsigned, non-infinite).">increment</a>(<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; bnum)
<a name="l00960"></a>00960 {
<a name="l00961"></a>00961   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l00962"></a>00962   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> carry = 1;
<a name="l00963"></a>00963   <span class="keywordflow">while</span> (i &lt; bnum.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &amp;&amp; carry) {             <span class="comment">// increment, element by element.</span>
<a name="l00964"></a>00964     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> temp = (<span class="keywordtype">unsigned</span> long)bnum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + carry;
<a name="l00965"></a>00965     carry = temp/0x10000L;
<a name="l00966"></a>00966     bnum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (<a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>)temp;
<a name="l00967"></a>00967     ++i;
<a name="l00968"></a>00968   }
<a name="l00969"></a>00969   <span class="keywordflow">if</span> (carry)
<a name="l00970"></a>00970   {
<a name="l00971"></a>00971     bnum.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(bnum.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>+1);
<a name="l00972"></a>00972     bnum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[bnum.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>-1] = 1;
<a name="l00973"></a>00973   }
<a name="l00974"></a>00974 }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 <span class="comment">//: subtract bmin from bmax (unsigned, non-infinite), result in diff</span>
<a name="l00977"></a>00977 
<a name="l00978"></a><a class="code" href="vnl__bignum_8h.html#a7e04219d436a1d7bd20d3924afa23b9d">00978</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#a988f164e804bb58231f9fceceb7c07c8" title="subtract bmin from bmax (unsigned, non-infinite), result in diff.">subtract</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; bmax, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; bmin, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; diff)
<a name="l00979"></a>00979 {
<a name="l00980"></a>00980   diff.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(bmax.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>);                      <span class="comment">// Allocate data for difference</span>
<a name="l00981"></a>00981   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> temp;
<a name="l00982"></a>00982   <span class="keywordtype">int</span> borrow = 0;
<a name="l00983"></a>00983   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l00984"></a>00984   <span class="keywordflow">for</span> (; i &lt; bmin.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i++) {                 <span class="comment">// Subtract word by word.</span>
<a name="l00985"></a>00985     temp = (<span class="keywordtype">unsigned</span> long)bmax.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + 0x10000L - borrow; <span class="comment">// Add radix to bmax&#39;s data</span>
<a name="l00986"></a>00986     temp -= (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)bmin.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i];        <span class="comment">// Subtract off bmin&#39;s data</span>
<a name="l00987"></a>00987     borrow = (temp/0x10000L == 0);              <span class="comment">// Did we have to borrow?</span>
<a name="l00988"></a>00988     diff.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (<a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>) temp;                 <span class="comment">// Reduce modulo radix and save</span>
<a name="l00989"></a>00989   }
<a name="l00990"></a>00990   <span class="keywordflow">for</span> (; i &lt; bmax.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; i++) {                 <span class="comment">// No more data for bmin</span>
<a name="l00991"></a>00991     temp = (<span class="keywordtype">unsigned</span> long)bmax.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + 0x10000L - borrow; <span class="comment">// Propagate the borrow through</span>
<a name="l00992"></a>00992     borrow = (temp/0x10000L == 0);              <span class="comment">//   rest of bmax&#39;s data</span>
<a name="l00993"></a>00993     diff.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (<a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>) temp;
<a name="l00994"></a>00994   }
<a name="l00995"></a>00995   diff.<a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030" title="trim non-infinite vnl_bignum of excess data allotment.">trim</a>();                                  <span class="comment">// Done. Now trim excess data</span>
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 
<a name="l00998"></a>00998 <span class="comment">//: Subtract 1 from bnum (unsigned, non-infinite, non-zero)</span>
<a name="l00999"></a>00999 
<a name="l01000"></a><a class="code" href="vnl__bignum_8h.html#afd695420ca3198a746b1b13c5afa2e64">01000</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#afd695420ca3198a746b1b13c5afa2e64" title="Subtract 1 from bnum (unsigned, non-infinite, non-zero).">decrement</a>(<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; bnum)
<a name="l01001"></a>01001 {
<a name="l01002"></a>01002   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l01003"></a>01003   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> borrow = 1;
<a name="l01004"></a>01004   <span class="keywordflow">while</span> (i &lt; bnum.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &amp;&amp; borrow) {            <span class="comment">// decrement, element by element.</span>
<a name="l01005"></a>01005     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> temp = (<span class="keywordtype">unsigned</span> long)bnum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + 0x10000L - borrow;
<a name="l01006"></a>01006     borrow = (temp/0x10000L == 0);              <span class="comment">// Did we have to borrow?</span>
<a name="l01007"></a>01007     bnum.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (<a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>)temp;                  <span class="comment">// Reduce modulo radix and save</span>
<a name="l01008"></a>01008     ++i;
<a name="l01009"></a>01009   }
<a name="l01010"></a>01010   bnum.<a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030" title="trim non-infinite vnl_bignum of excess data allotment.">trim</a>();                                  <span class="comment">// Done. Now trim excess data</span>
<a name="l01011"></a>01011   <span class="keywordflow">if</span> (bnum.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>==0) bnum.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>=+1;              <span class="comment">// Re-establish sign invariant</span>
<a name="l01012"></a>01012 }
<a name="l01013"></a>01013 
<a name="l01014"></a>01014 <span class="comment">//: compare absolute values of two vnl_bignums</span>
<a name="l01015"></a>01015 <span class="comment">// Outputs:  result of comparison:  -1 if abs(b1) &lt; abs(b2)</span>
<a name="l01016"></a>01016 <span class="comment">//                                   0 if abs(b1) == abs(b2)</span>
<a name="l01017"></a>01017 <span class="comment">//                                  +1 if abs(b1) &gt; abs(b2)</span>
<a name="l01018"></a>01018 
<a name="l01019"></a><a class="code" href="vnl__bignum_8h.html#ab6e951d56b76927509f672ac33acce87">01019</a> <span class="keywordtype">int</span> <a class="code" href="vnl__bignum_8cxx.html#a3306ad942eed45bea990c15ab6848e78" title="compare absolute values of two vnl_bignums.">magnitude_cmp</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b2)
<a name="l01020"></a>01020 {
<a name="l01021"></a>01021   <span class="keywordflow">if</span> (b1.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> b2.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>() ? 0 : 1;
<a name="l01022"></a>01022   <span class="keywordflow">if</span> (b2.<a class="code" href="classvnl__bignum.html#ae96d228596d1127679cb7bcd3e0902ac">is_infinity</a>()) <span class="keywordflow">return</span> -1;
<a name="l01023"></a>01023   <span class="keywordflow">if</span> (b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &gt; b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) <span class="keywordflow">return</span> 1;    <span class="comment">// If one has more data than</span>
<a name="l01024"></a>01024   <span class="keywordflow">if</span> (b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> &gt; b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) <span class="keywordflow">return</span> -1;   <span class="comment">//   the other, it wins</span>
<a name="l01025"></a>01025   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>;                 <span class="comment">// Else same number of elements</span>
<a name="l01026"></a>01026   <span class="keywordflow">while</span> (i &gt; 0) {                       <span class="comment">// Do lexicographic comparison</span>
<a name="l01027"></a>01027     <span class="keywordflow">if</span> (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1] &gt; b2.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1])
<a name="l01028"></a>01028       <span class="keywordflow">return</span> 1;
<a name="l01029"></a>01029     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1] &lt; b2.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1])
<a name="l01030"></a>01030       <span class="keywordflow">return</span> -1;
<a name="l01031"></a>01031     i--;
<a name="l01032"></a>01032   }                                     <span class="comment">// No data, or all elements same</span>
<a name="l01033"></a>01033   <span class="keywordflow">return</span> 0;                             <span class="comment">//  so must be equal</span>
<a name="l01034"></a>01034 }
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 <span class="comment">//: multiply a non-infinite vnl_bignum by a &quot;single digit&quot;</span>
<a name="l01037"></a>01037 <span class="comment">// - Inputs:  vnl_bignum reference, single word multiplier, reference to the product,</span>
<a name="l01038"></a>01038 <span class="comment">//            and index of starting storage location to use in product</span>
<a name="l01039"></a>01039 
<a name="l01040"></a><a class="code" href="vnl__bignum_8h.html#a3ff942b2b70eb887a1a99e3e5648608c">01040</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#a7bcb14e8a8aa942bbb18a29eef192beb" title="multiply a non-infinite vnl_bignum by a &quot;single digit&quot;.">multiply_aux</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b, <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> d, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; prod, <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i)
<a name="l01041"></a>01041 {
<a name="l01042"></a>01042   <span class="comment">// this function works just like normal multiplication by hand, in that the</span>
<a name="l01043"></a>01043   <span class="comment">// top number is multiplied by the first digit of the bottom number, then the</span>
<a name="l01044"></a>01044   <span class="comment">// second digit, and so on.  The only difference is that instead of doing all</span>
<a name="l01045"></a>01045   <span class="comment">// of the multiplication before adding the rows, addition is done</span>
<a name="l01046"></a>01046   <span class="comment">// concurrently.</span>
<a name="l01047"></a>01047   <span class="keywordflow">if</span> (i == 0) {                         <span class="comment">// if index is zero</span>
<a name="l01048"></a>01048     <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> j = 0;                      <span class="comment">//   then zero out all of</span>
<a name="l01049"></a>01049     <span class="keywordflow">while</span> (j &lt; prod.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>)              <span class="comment">//   prod&#39;s data elements</span>
<a name="l01050"></a>01050       prod.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[j++] = 0;
<a name="l01051"></a>01051   }
<a name="l01052"></a>01052   <span class="keywordflow">if</span> (d != 0) {                         <span class="comment">// if d == 0, nothing to do</span>
<a name="l01053"></a>01053     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> temp;
<a name="l01054"></a>01054     <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> carry = 0;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056     <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> j = 0;
<a name="l01057"></a>01057     <span class="keywordflow">for</span> (; j &lt; b.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; j++) {
<a name="l01058"></a>01058       <span class="comment">// for each of b&#39;s data elements, multiply times d and add running product</span>
<a name="l01059"></a>01059       temp = (<span class="keywordtype">unsigned</span> long)b.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[j] * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)d
<a name="l01060"></a>01060            + (<span class="keywordtype">unsigned</span> long)prod.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + j] + carry;
<a name="l01061"></a>01061       prod.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + j] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(temp % 0x10000L); <span class="comment">//   store result in product</span>
<a name="l01062"></a>01062       carry = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(temp/0x10000L);              <span class="comment">//   keep track of carry</span>
<a name="l01063"></a>01063     }
<a name="l01064"></a>01064     <span class="keywordflow">if</span> (i+j &lt; prod.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>)
<a name="l01065"></a>01065       prod.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + j] = carry;                 <span class="comment">// Done.  Store the final carry</span>
<a name="l01066"></a>01066   }
<a name="l01067"></a>01067 }
<a name="l01068"></a>01068 
<a name="l01069"></a>01069 <span class="comment">//: normalize two vnl_bignums</span>
<a name="l01070"></a>01070 <span class="comment">// (Refer to Knuth, V.2, Section 4.3.1, Algorithm D for details.</span>
<a name="l01071"></a>01071 <span class="comment">//  A digit here is one data element in the radix 2**2.)</span>
<a name="l01072"></a>01072 <span class="comment">// - Inputs:  references to two vnl_bignums b1, b2</span>
<a name="l01073"></a>01073 <span class="comment">// - Outputs: their normalized counterparts u and v,</span>
<a name="l01074"></a>01074 <span class="comment">//            and the integral normalization factor used</span>
<a name="l01075"></a>01075 
<a name="l01076"></a><a class="code" href="vnl__bignum_8h.html#a9a63befb977b46ba262d42c3f139795d">01076</a> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> <a class="code" href="vnl__bignum_8cxx.html#a264ee708c395bbb794b331c40fa3a156" title="normalize two vnl_bignums.">normalize</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b2, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; u, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="vnl__vector_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>)
<a name="l01077"></a>01077 {
<a name="l01078"></a>01078   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> d = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(0x10000L/((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)(b2.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1]) + 1L)); <span class="comment">// Calculate normalization factor.</span>
<a name="l01079"></a>01079   u.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + 1);                       <span class="comment">// Get data for u (plus extra)</span>
<a name="l01080"></a>01080   v.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>);                           <span class="comment">// Get data for v</span>
<a name="l01081"></a>01081   u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>] = 0;                         <span class="comment">// Set u&#39;s leading digit to 0</span>
<a name="l01082"></a>01082   <a class="code" href="vnl__bignum_8cxx.html#a7bcb14e8a8aa942bbb18a29eef192beb" title="multiply a non-infinite vnl_bignum by a &quot;single digit&quot;.">multiply_aux</a>(b1,d,u,0);                       <span class="comment">// u = b1 * d</span>
<a name="l01083"></a>01083   <a class="code" href="vnl__bignum_8cxx.html#a7bcb14e8a8aa942bbb18a29eef192beb" title="multiply a non-infinite vnl_bignum by a &quot;single digit&quot;.">multiply_aux</a>(b2,d,v,0);                       <span class="comment">// v = b2 * d</span>
<a name="l01084"></a>01084   <span class="keywordflow">return</span> d;                                     <span class="comment">// return normalization factor</span>
<a name="l01085"></a>01085 }
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 <span class="comment">//: divide a vnl_bignum by a &quot;single digit&quot;</span>
<a name="l01088"></a>01088 <span class="comment">// (Refer to Knuth, V.2, Section 4.3.2, exercise 16 for details.</span>
<a name="l01089"></a>01089 <span class="comment">//  A digit here is one data element in the radix 2**2.)</span>
<a name="l01090"></a>01090 <span class="comment">// - Inputs:  reference to vnl_bignum dividend, single digit divisor d, vnl_bignum</span>
<a name="l01091"></a>01091 <span class="comment">//            quotient, and single digit remainder r</span>
<a name="l01092"></a>01092 
<a name="l01093"></a><a class="code" href="vnl__bignum_8cxx.html#a4daf74de6ba6bf0c63caf847f81dd1f2">01093</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#a4daf74de6ba6bf0c63caf847f81dd1f2" title="divide a vnl_bignum by a &quot;single digit&quot;.">divide_aux</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> d, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; q, <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>&amp; r)
<a name="l01094"></a>01094 {
<a name="l01095"></a>01095   r = 0;                                        <span class="comment">// init remainder to zero</span>
<a name="l01096"></a>01096   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> temp;
<a name="l01097"></a>01097   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> j = b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; j &gt; 0; j--) {
<a name="l01098"></a>01098     temp = (<span class="keywordtype">unsigned</span> long)r*0x10000L + (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[j - 1]; <span class="comment">// get remainder, append next</span>
<a name="l01099"></a>01099     <span class="keywordflow">if</span> (j &lt; 1 + q.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>)
<a name="l01100"></a>01100       q.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[j - 1] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(temp/d);             <span class="comment">//   digit, then divide</span>
<a name="l01101"></a>01101     r = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(temp % d);                         <span class="comment">// calculate new remainder</span>
<a name="l01102"></a>01102   }
<a name="l01103"></a>01103 }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105 <span class="comment">//: estimate next dividend</span>
<a name="l01106"></a>01106 <span class="comment">// (Refer to Knuth, V.2, Section 4.3.1, Algorithm D for details.</span>
<a name="l01107"></a>01107 <span class="comment">//  This function estimates how many times v goes into u, starting at u&#39;s</span>
<a name="l01108"></a>01108 <span class="comment">//  jth digit.  A digit here is actually a data element, thought of as</span>
<a name="l01109"></a>01109 <span class="comment">//  being in the radix 2**2.)</span>
<a name="l01110"></a>01110 <span class="comment">// - Inputs:  reference to vnl_bignum dividend and divisor and starting digit j</span>
<a name="l01111"></a>01111 <span class="comment">// - Outputs: estimated number of times v goes into u</span>
<a name="l01112"></a>01112 
<a name="l01113"></a><a class="code" href="vnl__bignum_8cxx.html#a25cb261fd7e2b3eb9fe380f42eac4ae5">01113</a> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> <a class="code" href="vnl__bignum_8cxx.html#a25cb261fd7e2b3eb9fe380f42eac4ae5" title="estimate next dividend.">estimate_q_hat</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; u, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="vnl__vector_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>, <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> j)
<a name="l01114"></a>01114 {
<a name="l01115"></a>01115   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> q_hat,
<a name="l01116"></a>01116        v1 = v.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1],                <span class="comment">// localize frequent data</span>
<a name="l01117"></a>01117        v2 = v.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 2],
<a name="l01118"></a>01118        u0 = u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1 - j],
<a name="l01119"></a>01119        u1 = u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 2 - j],
<a name="l01120"></a>01120        u2 = u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 3 - j];
<a name="l01121"></a>01121 
<a name="l01122"></a>01122   <span class="comment">// Initial Knuth estimate, usually correct</span>
<a name="l01123"></a>01123   q_hat = (u0 == v1 ? <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(0xffff) : <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)u0 * 0x10000L + (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)u1) / (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)v1));
<a name="l01124"></a>01124 
<a name="l01125"></a>01125   <span class="comment">// high speed test to determine most of the cases in which initial</span>
<a name="l01126"></a>01126   <span class="comment">// estimate is too large.  Eliminates most cases in which q_hat is one too</span>
<a name="l01127"></a>01127   <span class="comment">// large.  Eliminates all cases in which q_hat is two too large.  The test</span>
<a name="l01128"></a>01128   <span class="comment">// looks hairy because we have to watch out for overflow.  In the book, this</span>
<a name="l01129"></a>01129   <span class="comment">// test is the simple inequality:</span>
<a name="l01130"></a>01130   <span class="comment">//     v2*q_hat &gt; (u0*0x10000L + u1 - q_hat*v1)*0x10000L + u2.</span>
<a name="l01131"></a>01131   <span class="comment">// If the inequality is true, decrease q_hat by 1.  If inequality is still</span>
<a name="l01132"></a>01132   <span class="comment">// true, decrease q_hat again.</span>
<a name="l01133"></a>01133   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lhs, rhs;               <span class="comment">// lhs, rhs of Knuth inequality</span>
<a name="l01134"></a>01134   <span class="keywordflow">for</span> (<a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0; i &lt; 2; i++) {     <span class="comment">// loop at most twice</span>
<a name="l01135"></a>01135     lhs = (<span class="keywordtype">unsigned</span> long)v2 * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)q_hat;       <span class="comment">// Calculate left-hand side of ineq.</span>
<a name="l01136"></a>01136     rhs = (<span class="keywordtype">unsigned</span> long)u0 * 0x10000L +(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)u1;<span class="comment">// Calculate part of right-hand side</span>
<a name="l01137"></a>01137     rhs -= ((<span class="keywordtype">unsigned</span> long)q_hat * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)v1);    <span class="comment">// Now subtract off part</span>
<a name="l01138"></a>01138 
<a name="l01139"></a>01139     <span class="keywordflow">if</span> ( rhs &gt;= 0x10000L )              <span class="comment">// if multiplication with 0x10000L causes overflow</span>
<a name="l01140"></a>01140       <span class="keywordflow">break</span>;                            <span class="comment">//   then rhs &gt; lhs, so test fails</span>
<a name="l01141"></a>01141     rhs *= 0x10000L;                    <span class="comment">// No overflow:  ok to multiply</span>
<a name="l01142"></a>01142 
<a name="l01143"></a>01143     <span class="keywordflow">if</span> (rhs &gt; rhs + (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)u2)  <span class="comment">// if addition yields overflow</span>
<a name="l01144"></a>01144       <span class="keywordflow">break</span>;                            <span class="comment">//   then rhs &gt; lhs, so test fails</span>
<a name="l01145"></a>01145     rhs += u2;                          <span class="comment">// No overflow: ok to add.</span>
<a name="l01146"></a>01146     <span class="keywordflow">if</span> (lhs &lt;= rhs)                     <span class="comment">// if lhs &lt;= rhs</span>
<a name="l01147"></a>01147       <span class="keywordflow">break</span>;                            <span class="comment">//   test fails</span>
<a name="l01148"></a>01148     q_hat--;                            <span class="comment">// Test passes:  decrement q_hat</span>
<a name="l01149"></a>01149   }                                     <span class="comment">// Loop again</span>
<a name="l01150"></a>01150   <span class="keywordflow">return</span> q_hat;                         <span class="comment">// Return estimate</span>
<a name="l01151"></a>01151 }
<a name="l01152"></a>01152 
<a name="l01153"></a>01153 <span class="comment">//: calculate u - v*q_hat</span>
<a name="l01154"></a>01154 <span class="comment">// (Refer to Knuth, V. 2, Section 4.3.1, Algorithm D for details.</span>
<a name="l01155"></a>01155 <span class="comment">//  A digit here is a data element, thought of as being in the radix 2**2.)</span>
<a name="l01156"></a>01156 <span class="comment">// - Inputs:  reference to vnl_bignum dividend, divisor, estimated result, and index</span>
<a name="l01157"></a>01157 <span class="comment">//            into jth digit of dividend</span>
<a name="l01158"></a>01158 <span class="comment">// - Outputs: true number of times v goes into u</span>
<a name="l01159"></a>01159 
<a name="l01160"></a><a class="code" href="vnl__bignum_8cxx.html#a6b33a49894a2fa1161a6f83b08e56c2b">01160</a> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> <a class="code" href="vnl__bignum_8cxx.html#a6b33a49894a2fa1161a6f83b08e56c2b" title="calculate u - v*q_hat.">multiply_subtract</a>(<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; u, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; <a class="code" href="vnl__vector_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>, <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> q_hat, <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> j)
<a name="l01161"></a>01161 {
<a name="l01162"></a>01162   <span class="comment">// At this point it has been estimated that v goes into the jth and higher</span>
<a name="l01163"></a>01163   <span class="comment">// digits of u about q_hat times, and in fact that q_hat is either the</span>
<a name="l01164"></a>01164   <span class="comment">// correct number of times or one too large.</span>
<a name="l01165"></a>01165 
<a name="l01166"></a>01166   <span class="keywordflow">if</span> (q_hat == 0) <span class="keywordflow">return</span> q_hat;         <span class="comment">// if q_hat 0, nothing to do</span>
<a name="l01167"></a>01167   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> rslt;                      <span class="comment">// create a temporary vnl_bignum</span>
<a name="l01168"></a>01168   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> tmpcnt;
<a name="l01169"></a>01169   rslt.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + 1u);            <span class="comment">// allocate data for it</span>
<a name="l01170"></a>01170 
<a name="l01171"></a>01171   <span class="comment">// simultaneous computation of u - v*q_hat</span>
<a name="l01172"></a>01172   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> prod, diff;
<a name="l01173"></a>01173   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> carry = 0, borrow = 0;
<a name="l01174"></a>01174   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l01175"></a>01175   <span class="keywordflow">for</span> (; i &lt; v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; ++i) {
<a name="l01176"></a>01176     <span class="comment">// for each digit of v, multiply it by q_hat and subtract the result</span>
<a name="l01177"></a>01177     prod = (<span class="keywordtype">unsigned</span> long)v.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] * (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)q_hat + carry;
<a name="l01178"></a>01178     diff = (<span class="keywordtype">unsigned</span> long)u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1 - j + i] + (0x10000L - (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)borrow);
<a name="l01179"></a>01179     diff -= (<span class="keywordtype">unsigned</span> long)<a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(prod);  <span class="comment">//   form proper digit of u</span>
<a name="l01180"></a>01180     rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(diff);          <span class="comment">//   save the result</span>
<a name="l01181"></a>01181     borrow = (diff/0x10000L == 0) ? 1 : 0; <span class="comment">//   keep track of any borrows</span>
<a name="l01182"></a>01182     carry = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(prod/0x10000L);        <span class="comment">//   keep track of carries</span>
<a name="l01183"></a>01183   }
<a name="l01184"></a>01184   tmpcnt = <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>(u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + i - j - 1);
<a name="l01185"></a>01185   diff = (<span class="keywordtype">unsigned</span> long)u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[tmpcnt]  <span class="comment">//  special case for the last digit</span>
<a name="l01186"></a>01186          + (0x10000L - (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)borrow);
<a name="l01187"></a>01187   diff -= (<span class="keywordtype">unsigned</span> long)carry;
<a name="l01188"></a>01188   rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(diff);
<a name="l01189"></a>01189   borrow = (diff/0x10000L == 0) ? 1 : 0;
<a name="l01190"></a>01190 
<a name="l01191"></a>01191   <span class="comment">// A leftover borrow indicates that u - v*q_hat is negative, i.e., that</span>
<a name="l01192"></a>01192   <span class="comment">// q_hat was one too large.  So to get correct result, decrement q_hat and</span>
<a name="l01193"></a>01193   <span class="comment">// add back one multiple of v</span>
<a name="l01194"></a>01194   <span class="keywordflow">if</span> (borrow) {
<a name="l01195"></a>01195     q_hat--;
<a name="l01196"></a>01196     carry = 0;
<a name="l01197"></a>01197     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sum;
<a name="l01198"></a>01198     <span class="keywordflow">for</span> (i = 0; i &lt; v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; ++i) {
<a name="l01199"></a>01199       sum = (<span class="keywordtype">unsigned</span> long)rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)v.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + carry;
<a name="l01200"></a>01200       carry = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(sum/0x10000L);
<a name="l01201"></a>01201       u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + i - 1 - j] = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(sum);
<a name="l01202"></a>01202     }
<a name="l01203"></a>01203     u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + i - 1 - j] = rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] + carry;
<a name="l01204"></a>01204   }
<a name="l01205"></a>01205   <span class="keywordflow">else</span> {                                <span class="comment">// otherwise, result is ok</span>
<a name="l01206"></a>01206     <span class="keywordflow">for</span> (i = 0; i &lt; rslt.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>; ++i)    <span class="comment">// store result back into u</span>
<a name="l01207"></a>01207       u.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[u.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - v.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + i - 1 - j] = rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i];
<a name="l01208"></a>01208   }
<a name="l01209"></a>01209   <span class="keywordflow">return</span> q_hat;                         <span class="comment">// return corrected q_hat</span>
<a name="l01210"></a>01210 }
<a name="l01211"></a>01211 
<a name="l01212"></a>01212 <span class="comment">//: divide b2 into b1, getting quotient q and remainder r.</span>
<a name="l01213"></a>01213 <span class="comment">// (Refer to Knuth, V.2, Section 4.3.1, Algorithm D for details.</span>
<a name="l01214"></a>01214 <span class="comment">//  This function implements Algorithm D.)</span>
<a name="l01215"></a>01215 <span class="comment">// - Inputs: references to a vnl_bignum dividend b1, divisor b2, quotient q, and</span>
<a name="l01216"></a>01216 <span class="comment">//           remainder r.</span>
<a name="l01217"></a>01217 
<a name="l01218"></a><a class="code" href="vnl__bignum_8h.html#adec22c7d0bc290b297df5a794d055eb7">01218</a> <span class="keywordtype">void</span> <a class="code" href="vnl__bignum_8cxx.html#ab4ede6b6a012ca91514c08c576035fcb" title="divide b2 into b1, getting quotient q and remainder r.">divide</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b2, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; q, <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; r)
<a name="l01219"></a>01219 {
<a name="l01220"></a>01220   <span class="comment">// Note that q or r may *not* be identical to either b1 or b2 !</span>
<a name="l01221"></a>01221   assert(&amp;b1 != &amp;q &amp;&amp; &amp;b2 != &amp;q &amp;&amp; &amp;b1 != &amp;r &amp;&amp; &amp;b2 != &amp;r);
<a name="l01222"></a>01222   q = r = 0L;
<a name="l01223"></a>01223   <span class="keywordflow">if</span> (b1 == 0L)                      <span class="comment">// If divisor is zero</span>
<a name="l01224"></a>01224     <span class="keywordflow">return</span>;                          <span class="comment">//   return zero quotient and remainder</span>
<a name="l01225"></a>01225   <span class="keywordtype">int</span> mag = <a class="code" href="vnl__bignum_8cxx.html#a3306ad942eed45bea990c15ab6848e78" title="compare absolute values of two vnl_bignums.">magnitude_cmp</a>(b1,b2);    <span class="comment">// Compare magnitudes</span>
<a name="l01226"></a>01226   <span class="keywordflow">if</span> (mag &lt; 0)                       <span class="comment">// if abs(b1) &lt; abs(b2)</span>
<a name="l01227"></a>01227     r = b1;                          <span class="comment">//   return zero quotient, b1 remainder</span>
<a name="l01228"></a>01228   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mag == 0)                 <span class="comment">// if abs(b1) == abs(b2)</span>
<a name="l01229"></a>01229     q = 1L;                          <span class="comment">//   quotient is 1, remainder is 0</span>
<a name="l01230"></a>01230   <span class="keywordflow">else</span> {                             <span class="comment">// otherwise abs(b1) &gt; abs(b2), so divide</span>
<a name="l01231"></a>01231     q.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + 1u - b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>); <span class="comment">// Allocate quotient</span>
<a name="l01232"></a>01232     r.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>);              <span class="comment">// Allocate remainder</span>
<a name="l01233"></a>01233     <span class="keywordflow">if</span> (b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> == 1) {                        <span class="comment">// Single digit divisor?</span>
<a name="l01234"></a>01234       <a class="code" href="vnl__bignum_8cxx.html#a4daf74de6ba6bf0c63caf847f81dd1f2" title="divide a vnl_bignum by a &quot;single digit&quot;.">divide_aux</a>(b1,b2.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0],q,r.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0]);    <span class="comment">// Do single digit divide</span>
<a name="l01235"></a>01235     }
<a name="l01236"></a>01236     <span class="keywordflow">else</span> {                                      <span class="comment">// Else full-blown divide</span>
<a name="l01237"></a>01237       <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> u,<a class="code" href="vnl__vector_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>;
<a name="l01238"></a>01238 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01239"></a>01239 <span class="preprocessor"></span>      vcl_cerr &lt;&lt; <span class="stringliteral">&quot;\nvnl_bignum::divide: b1 =&quot;</span>; b1.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01240"></a>01240       vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: b2 =&quot;</span>; b2.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01241"></a>01241 <span class="preprocessor">#endif</span>
<a name="l01242"></a>01242 <span class="preprocessor"></span>      <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> d = <a class="code" href="vnl__bignum_8cxx.html#a264ee708c395bbb794b331c40fa3a156" title="normalize two vnl_bignums.">normalize</a>(b1,b2,u,v);            <span class="comment">// Set u = b1*d, v = b2*d</span>
<a name="l01243"></a>01243 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01244"></a>01244 <span class="preprocessor"></span>      vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: d = &quot;</span> &lt;&lt; d &lt;&lt; vcl_hex &lt;&lt; <span class="stringliteral">&quot; (0x&quot;</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span> &lt;&lt; vcl_dec;
<a name="l01245"></a>01245       vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: u = &quot;</span>; u.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01246"></a>01246       vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: v = &quot;</span>; v.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01247"></a>01247 <span class="preprocessor">#endif</span>
<a name="l01248"></a>01248 <span class="preprocessor"></span>      <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> j = 0;
<a name="l01249"></a>01249       <span class="keywordflow">while</span> (j &lt;= b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - b2.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) {        <span class="comment">// Main division loop</span>
<a name="l01250"></a>01250         <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> q_hat = <a class="code" href="vnl__bignum_8cxx.html#a25cb261fd7e2b3eb9fe380f42eac4ae5" title="estimate next dividend.">estimate_q_hat</a>(u,v,j);     <span class="comment">// Estimate # times v divides u</span>
<a name="l01251"></a>01251         q.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[q.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1 - j] =               <span class="comment">// Do division, get true answ.</span>
<a name="l01252"></a>01252           <a class="code" href="vnl__bignum_8cxx.html#a6b33a49894a2fa1161a6f83b08e56c2b" title="calculate u - v*q_hat.">multiply_subtract</a>(u,v,q_hat,j);
<a name="l01253"></a>01253         j++;
<a name="l01254"></a>01254 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01255"></a>01255 <span class="preprocessor"></span>        vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: q_hat = &quot;</span> &lt;&lt; q_hat &lt;&lt; vcl_hex &lt;&lt; <span class="stringliteral">&quot; (0x&quot;</span> &lt;&lt; q_hat &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span> &lt;&lt; vcl_dec;
<a name="l01256"></a>01256         vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: u = &quot;</span>; u.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01257"></a>01257 <span class="preprocessor">#endif</span>
<a name="l01258"></a>01258 <span class="preprocessor"></span>      }
<a name="l01259"></a>01259       <span class="keyword">static</span> <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> dufus;                <span class="comment">// dummy variable</span>
<a name="l01260"></a>01260       <a class="code" href="vnl__bignum_8cxx.html#a4daf74de6ba6bf0c63caf847f81dd1f2" title="divide a vnl_bignum by a &quot;single digit&quot;.">divide_aux</a>(u,d,r,dufus);          <span class="comment">// Unnormalize u for remainder</span>
<a name="l01261"></a>01261 
<a name="l01262"></a>01262 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l01263"></a>01263 <span class="preprocessor"></span>      vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: q = &quot;</span>; q.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01264"></a>01264       vcl_cerr &lt;&lt; <span class="stringliteral">&quot;vnl_bignum::divide: r = &quot;</span>; r.<a class="code" href="classvnl__bignum.html#a466a97728121cb9b01bdcbb80542e3e1" title="dump the contents of a vnl_bignum to a stream, default cout.">dump</a>(vcl_cerr);
<a name="l01265"></a>01265 <span class="preprocessor">#endif</span>
<a name="l01266"></a>01266 <span class="preprocessor"></span>    }
<a name="l01267"></a>01267     q.<a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030" title="trim non-infinite vnl_bignum of excess data allotment.">trim</a>();                           <span class="comment">// Trim leading zeros of quot.</span>
<a name="l01268"></a>01268     r.<a class="code" href="classvnl__bignum.html#add53f9bf637802844f6a9f33c284a030" title="trim non-infinite vnl_bignum of excess data allotment.">trim</a>();                           <span class="comment">// Trim leading zeros of rem.</span>
<a name="l01269"></a>01269   }
<a name="l01270"></a>01270   q.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = r.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = b1.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> * b2.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;  <span class="comment">// Calculate signs</span>
<a name="l01271"></a>01271 }
<a name="l01272"></a>01272 
<a name="l01273"></a>01273 <span class="comment">//: left shift (arithmetic) non-infinite vnl_bignum by positive number.</span>
<a name="l01274"></a>01274 <span class="comment">// - Inputs:  reference to vnl_bignum, positive shift value</span>
<a name="l01275"></a>01275 <span class="comment">// - Outputs: vnl_bignum, multiplied by the corresponding power of two</span>
<a name="l01276"></a>01276 
<a name="l01277"></a><a class="code" href="vnl__bignum_8h.html#a8c3b604532a229147489a3797fc96080">01277</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> <a class="code" href="vnl__bignum_8cxx.html#a8c3b604532a229147489a3797fc96080" title="left shift (arithmetic) non-infinite vnl_bignum by positive number.">left_shift</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <span class="keywordtype">int</span> l)
<a name="l01278"></a>01278 {
<a name="l01279"></a>01279   <span class="comment">// to carry out this arithmetic left shift, we cheat.  Instead of physically</span>
<a name="l01280"></a>01280   <span class="comment">// shifting the data array l bits to the left, we shift just enough to get</span>
<a name="l01281"></a>01281   <span class="comment">// the correct word alignment, and then pad the array on the right with as</span>
<a name="l01282"></a>01282   <span class="comment">// many zeros as we need.</span>
<a name="l01283"></a>01283   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> rslt;                      <span class="comment">// result of shift</span>
<a name="l01284"></a>01284   rslt.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = b1.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;                  <span class="comment">// result follows sign of input</span>
<a name="l01285"></a>01285   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> growth = <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>(l / 16);     <span class="comment">// # of words rslt will grow by</span>
<a name="l01286"></a>01286   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> shift = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(l % 16);            <span class="comment">// amount to actually shift</span>
<a name="l01287"></a>01287   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> rshift = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(16 - shift);       <span class="comment">// amount to shift next word by</span>
<a name="l01288"></a>01288   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> carry = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(                    <span class="comment">// value that will be shifted</span>
<a name="l01289"></a>01289     b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1] &gt;&gt; (16 - shift));<span class="comment">// out end of current array</span>
<a name="l01290"></a>01290   rslt.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> + growth + (carry ? 1u : 0u)); <span class="comment">// allocate new data array</span>
<a name="l01291"></a>01291   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l01292"></a>01292   <span class="keywordflow">while</span> (i &lt; growth)                            <span class="comment">// zero out padded elements</span>
<a name="l01293"></a>01293     rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i++] = 0;
<a name="l01294"></a>01294   rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i++] = b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[0] &lt;&lt; shift;         <span class="comment">// shift first non-zero element</span>
<a name="l01295"></a>01295   <span class="keywordflow">while</span> (i &lt; rslt.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1) {                  <span class="comment">// for remaining data words</span>
<a name="l01296"></a>01296     rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - growth] &lt;&lt; shift) + <span class="comment">// shift current data word</span>
<a name="l01297"></a>01297       (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1 - growth] &gt;&gt; rshift);          <span class="comment">// propagate adjacent</span>
<a name="l01298"></a>01298     i++;                                        <span class="comment">// carry into current word</span>
<a name="l01299"></a>01299   }
<a name="l01300"></a>01300   <span class="keywordflow">if</span> (i &lt; rslt.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) {
<a name="l01301"></a>01301     <span class="keywordflow">if</span> (carry)                                  <span class="comment">// if last word had overflow</span>
<a name="l01302"></a>01302       rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = carry;                     <span class="comment">//   store it new data</span>
<a name="l01303"></a>01303     <span class="keywordflow">else</span>                                        <span class="comment">// otherwise,</span>
<a name="l01304"></a>01304       rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - growth] &lt;&lt; shift) <span class="comment">// do like the rest</span>
<a name="l01305"></a>01305                    + (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i - 1 - growth] &gt;&gt; rshift);
<a name="l01306"></a>01306   }
<a name="l01307"></a>01307   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; result = *((<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>*) &amp;rslt);<span class="comment">// same physical object</span>
<a name="l01308"></a>01308   <span class="keywordflow">return</span> result;                              <span class="comment">// shallow swap on return</span>
<a name="l01309"></a>01309 }
<a name="l01310"></a>01310 
<a name="l01311"></a>01311 <span class="comment">//: right shift (arithmetic) non-infinite vnl_bignum by positive number.</span>
<a name="l01312"></a>01312 <span class="comment">// - Inputs:  reference to vnl_bignum, positive shift value</span>
<a name="l01313"></a>01313 <span class="comment">// - Outputs: vnl_bignum, divided by the corresponding power of two</span>
<a name="l01314"></a>01314 
<a name="l01315"></a><a class="code" href="vnl__bignum_8h.html#af93d4395d73af5768ee6d3dc4b3d6148">01315</a> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> <a class="code" href="vnl__bignum_8cxx.html#af93d4395d73af5768ee6d3dc4b3d6148" title="right shift (arithmetic) non-infinite vnl_bignum by positive number.">right_shift</a>(<span class="keyword">const</span> <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; b1, <span class="keywordtype">int</span> l)
<a name="l01316"></a>01316 {
<a name="l01317"></a>01317   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a> rslt;                              <span class="comment">// result of shift</span>
<a name="l01318"></a>01318   <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> shrinkage = <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a>(l / 16);          <span class="comment">// # of words rslt will shrink</span>
<a name="l01319"></a>01319   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> shift = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(l % 16);                    <span class="comment">// amount to actually shift</span>
<a name="l01320"></a>01320   <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> dregs = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>-1] &gt;&gt; shift);<span class="comment">// high end data to save</span>
<a name="l01321"></a>01321   <span class="keywordflow">if</span> (shrinkage + (dregs == 0) &lt; b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a>) {    <span class="comment">// if not all data shifted out</span>
<a name="l01322"></a>01322     rslt.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a> = b1.<a class="code" href="classvnl__bignum.html#aaed7c7909d3ca47c4b59c4172d77c648">sign</a>;                        <span class="comment">// rslt follows sign of input</span>
<a name="l01323"></a>01323     rslt.<a class="code" href="classvnl__bignum.html#a7e875cc4b9bef2e2fc199e01aa85164d" title="change the data allotment for a vnl_bignum.">resize</a>(b1.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - shrinkage - (dregs == 0 ? 1 : 0)); <span class="comment">// allocate new data</span>
<a name="l01324"></a>01324     <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a> lshift = <a class="code" href="vnl__bignum_8cxx.html#ae2003cfda56952986d0b08996fb2697c">Data</a>(16 - shift);             <span class="comment">// amount to shift high word</span>
<a name="l01325"></a>01325     <a class="code" href="vnl__bignum_8cxx.html#a0c72535aaa90ec564d101f7a797193ef">Counter</a> i = 0;
<a name="l01326"></a>01326     <span class="keywordflow">while</span> (i &lt; rslt.<a class="code" href="classvnl__bignum.html#a1ed7b696cf9b668cba9c16675b6c1b41">count</a> - 1) {                <span class="comment">// shift current word</span>
<a name="l01327"></a>01327       rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + shrinkage] &gt;&gt; shift) + <span class="comment">// propagate adjacent</span>
<a name="l01328"></a>01328         (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + shrinkage + 1u] &lt;&lt; lshift); <span class="comment">// word into current word</span>
<a name="l01329"></a>01329       i++;
<a name="l01330"></a>01330     }
<a name="l01331"></a>01331     <span class="keywordflow">if</span> (dregs)                                  <span class="comment">// don&#39;t lose dregs</span>
<a name="l01332"></a>01332       rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = dregs;
<a name="l01333"></a>01333     <span class="keywordflow">else</span> {
<a name="l01334"></a>01334       rslt.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i] = (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + shrinkage] &gt;&gt; shift) +
<a name="l01335"></a>01335         (b1.<a class="code" href="classvnl__bignum.html#a80ee0e4d1f10adb7fbae8decbd8cdf26">data</a>[i + shrinkage + 1u] &lt;&lt; lshift);
<a name="l01336"></a>01336     }
<a name="l01337"></a>01337   }
<a name="l01338"></a>01338   <a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>&amp; result = *((<a class="code" href="classvnl__bignum.html" title="Infinite precision integers.">vnl_bignum</a>*) &amp;rslt);  <span class="comment">// same physical object</span>
<a name="l01339"></a>01339   <span class="keywordflow">return</span> result;                                <span class="comment">// shallow swap on return</span>
<a name="l01340"></a>01340 }
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:31:01 for core/vnl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
