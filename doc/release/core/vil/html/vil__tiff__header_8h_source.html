<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>core/vil/file_formats/vil_tiff_header.h Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">core/vil/file_formats/vil_tiff_header.h</div>  </div>
</div>
<div class="contents">
<a href="vil__tiff__header_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is core/vil/file_formats/vil_tiff_header.h</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef vil_tiff_header_h_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#define vil_tiff_header_h_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#ifdef VCL_NEEDS_PRAGMA_INTERFACE</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#pragma interface</span>
<a name="l00006"></a>00006 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span><span class="comment">//:</span>
<a name="l00008"></a>00008 <span class="comment">// \file</span>
<a name="l00009"></a>00009 <span class="comment">// \author    J.L. Mundy</span>
<a name="l00010"></a>00010 <span class="comment">// \date 22 Dec 2005</span>
<a name="l00011"></a>00011 <span class="comment">// \brief A header structure for tiff files</span>
<a name="l00012"></a>00012 <span class="comment">//</span>
<a name="l00013"></a>00013 <span class="comment">// This class is responsible for extracting (putting) information</span>
<a name="l00014"></a>00014 <span class="comment">// from (into) the tiff header that is required to specify a vil_image_resource</span>
<a name="l00015"></a>00015 <span class="comment">// There are bool flags that indicate that the item has been successfully</span>
<a name="l00016"></a>00016 <span class="comment">// read (written) to the open tiff file.</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">// Notes:</span>
<a name="l00019"></a>00019 <span class="comment">//   -  The size of each strip can be different and less than the full</span>
<a name="l00020"></a>00020 <span class="comment">//      strip, i.e. bytes_per_line * rows_per_strip, would require.</span>
<a name="l00021"></a>00021 <span class="comment">//      Perhaps this case should be rejected, but</span>
<a name="l00022"></a>00022 <span class="comment">//      it has occurred in images that IrfanView and ImageMagick CAN read.</span>
<a name="l00023"></a>00023 <span class="comment">//      In this case, the buffers are set up with capacity for a full strip.</span>
<a name="l00024"></a>00024 <span class="comment">//   -  The number of rows in a strip can exceed the image length. The actual</span>
<a name="l00025"></a>00025 <span class="comment">//      byte count is equal to the number of bytes in the image. In this</span>
<a name="l00026"></a>00026 <span class="comment">//      case, the block size is truncated to the image_length.</span>
<a name="l00027"></a>00027 <span class="comment">//   -  The width and height of a tile must be a multiple of 16</span>
<a name="l00028"></a>00028 <span class="comment">//   -  The current implementation can&#39;t handle Planar Configuration =2,</span>
<a name="l00029"></a>00029 <span class="comment">//      which is RGB in separate color bands.</span>
<a name="l00030"></a>00030 <span class="comment">//   -  If rows_per_strip is missing, it is assumed to be infinity</span>
<a name="l00031"></a>00031 <span class="comment">//      (http://www.awaresystems.be/imaging/tiff/tifftags/rowsperstrip.html)</span>
<a name="l00032"></a>00032 <span class="comment">//</span>
<a name="l00033"></a>00033 <span class="comment">// \verbatim</span>
<a name="l00034"></a>00034 <span class="comment">//  Modifications</span>
<a name="l00035"></a>00035 <span class="comment">//   November 8, 2007 - Added the case of four planes that is necessary to</span>
<a name="l00036"></a>00036 <span class="comment">//                      read and write satellite multispectral image data - JLM</span>
<a name="l00037"></a>00037 <span class="comment">//   January 9, 2012  - Use default value (1) for images that do not have SamplesPerPixel tag - GY</span>
<a name="l00038"></a>00038 <span class="comment">// \endverbatim</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;vcl_string.h&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;vcl_vector.h&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;vxl_config.h&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;vcl_cmath.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;vil/vil_config.h&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="vil__pixel__format_8h.html">vil/vil_pixel_format.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;tiffio.h&gt;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="structushort__tag.html">00048</a> <span class="keyword">struct </span><a class="code" href="structushort__tag.html">ushort_tag</a>
<a name="l00049"></a>00049 {
<a name="l00050"></a><a class="code" href="structushort__tag.html#aa010dbd2f514d69784aa7e0a1709f4a7">00050</a>   <a class="code" href="structushort__tag.html#aa010dbd2f514d69784aa7e0a1709f4a7">ushort_tag</a>(): <a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>(false) {}
<a name="l00051"></a><a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">00051</a>   vxl_uint_16 <a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>;
<a name="l00052"></a><a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">00052</a>   <span class="keywordtype">bool</span> <a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>;
<a name="l00053"></a>00053 };
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="structulong__tag.html">00055</a> <span class="keyword">struct </span><a class="code" href="structulong__tag.html">ulong_tag</a>
<a name="l00056"></a>00056 {
<a name="l00057"></a><a class="code" href="structulong__tag.html#ae4b1e3adaa42430674bfbed9bdb373fa">00057</a>   <a class="code" href="structulong__tag.html#ae4b1e3adaa42430674bfbed9bdb373fa">ulong_tag</a>() : <a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>(false) {}
<a name="l00058"></a><a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">00058</a>   vxl_uint_32 <a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>;
<a name="l00059"></a><a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">00059</a>   <span class="keywordtype">bool</span> <a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>;
<a name="l00060"></a>00060 };
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">// The tiff header elements (tags)</span>
<a name="l00063"></a>00063 <span class="comment">// planar_configuration determines the layout of many of the</span>
<a name="l00064"></a>00064 <span class="comment">// structures</span>
<a name="l00065"></a>00065 <span class="comment">//  1 - pixel samples are contiguous, e.g. RGBRGB...</span>
<a name="l00066"></a>00066 <span class="comment">//  2 - samples are in separate planes (analogous to vil nplanes)</span>
<a name="l00067"></a><a class="code" href="classvil__tiff__header.html">00067</a> <span class="keyword">class </span><a class="code" href="classvil__tiff__header.html">vil_tiff_header</a>
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069  <span class="keyword">public</span>:
<a name="l00070"></a><a class="code" href="classvil__tiff__header.html#acb179c8e5db5681a6b5686c88ea25f3e">00070</a>   <a class="code" href="classvil__tiff__header.html#acb179c8e5db5681a6b5686c88ea25f3e">vil_tiff_header</a>(TIFF* tif): <a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>(tif) {<a class="code" href="classvil__tiff__header.html#ae257906aa45a86bd4d22d89d8e6b93eb" title="true if the specified format can be read or written.">format_supported</a> = <a class="code" href="classvil__tiff__header.html#aa8270f9ca712eb4f4786e281b1ab90e5" title="read/write mode true for read.">read_header</a>();}
<a name="l00071"></a>00071 
<a name="l00072"></a>00072   <a class="code" href="classvil__tiff__header.html#acb179c8e5db5681a6b5686c88ea25f3e">vil_tiff_header</a>(TIFF* tif, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ni, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nj,
<a name="l00073"></a>00073                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a>, <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <span class="keyword">const</span>&amp; fmt,
<a name="l00074"></a>00074                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_j);
<a name="l00075"></a>00075 <span class="comment">// the baseline tiff header stucture</span>
<a name="l00076"></a><a class="code" href="classvil__tiff__header.html#aefa46b7de5ab26e85d30aac509e11edb">00076</a>   vcl_string <a class="code" href="classvil__tiff__header.html#aefa46b7de5ab26e85d30aac509e11edb">artist</a>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078   <span class="comment">//**Issue** spec says this should be an array[samples_per_pixel] but</span>
<a name="l00079"></a>00079   <span class="comment">//actual multi-sample tiff file headers have this as an</span>
<a name="l00080"></a>00080   <span class="comment">//vxl_uint_16 CHECK (JLM)</span>
<a name="l00081"></a><a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">00081</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>;
<a name="l00082"></a><a class="code" href="classvil__tiff__header.html#a2e7737dee5656355b47034b59fd49bc5">00082</a>   vxl_uint_16 <a class="code" href="classvil__tiff__header.html#a2e7737dee5656355b47034b59fd49bc5">bytes_per_sample</a>()<span class="keyword"> const</span>
<a name="l00083"></a>00083 <span class="keyword">  </span>{ <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> ? <span class="keyword">static_cast&lt;</span>vxl_uint_16<span class="keyword">&gt;</span>((<a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> + 7)/8) : 0u; }
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="classvil__tiff__header.html#adff896b3e724e6af8c3f82d6f6e950ca">00085</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#adff896b3e724e6af8c3f82d6f6e950ca">cell_length</a>;
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="classvil__tiff__header.html#a1e9f3e69d69a7279013756ae9390a505">00087</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a1e9f3e69d69a7279013756ae9390a505">cell_width</a>;
<a name="l00088"></a>00088 
<a name="l00089"></a>00089   <span class="comment">// color_map[index][pixel_sample] index ranges from 0-&gt;2^bits_per_sample-1</span>
<a name="l00090"></a>00090   <span class="comment">// pixel_sample 0-&gt;samples_per_pixel -1</span>
<a name="l00091"></a><a class="code" href="classvil__tiff__header.html#ab0d9634704041ccb6fa72e5bc11a630f">00091</a>   vcl_vector&lt;vcl_vector&lt;vxl_uint_16&gt; &gt;<a class="code" href="classvil__tiff__header.html#ab0d9634704041ccb6fa72e5bc11a630f">color_map</a>;
<a name="l00092"></a><a class="code" href="classvil__tiff__header.html#a295adba18b56f7e9f6792bebeb1a6981">00092</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a295adba18b56f7e9f6792bebeb1a6981">color_map_valid</a>;
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="classvil__tiff__header.html#a9c6f1910282716a18856a9e36841c0cb">00094</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a9c6f1910282716a18856a9e36841c0cb">compression</a>;
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classvil__tiff__header.html#a04e32033456d40ba247a27345cb49006">00096</a>   vcl_string <a class="code" href="classvil__tiff__header.html#a04e32033456d40ba247a27345cb49006">copyright</a>;
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="classvil__tiff__header.html#aa3935ef5582fbcdd8d30719e796f13ef">00098</a>   vcl_string <a class="code" href="classvil__tiff__header.html#aa3935ef5582fbcdd8d30719e796f13ef">date_time</a>;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="comment">//Additional samples per pixel, e.g. transparency</span>
<a name="l00101"></a><a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">00101</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">extra_samples</a>;
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classvil__tiff__header.html#a12c36d76bd5ac37fdc69d98c4daeec9c">00103</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a12c36d76bd5ac37fdc69d98c4daeec9c">fill_order</a>;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="comment">//for gray scale data provides a radiometry map, e.g. true reflectance</span>
<a name="l00106"></a>00106   <span class="comment">//index ranges from 0-&gt;2^bits_per_sample-1</span>
<a name="l00107"></a><a class="code" href="classvil__tiff__header.html#a0737f1297c7a2530359ab9c1b03bed1a">00107</a>   vcl_vector&lt;vxl_uint_16&gt; <a class="code" href="classvil__tiff__header.html#a0737f1297c7a2530359ab9c1b03bed1a">gray_response_curve</a>;
<a name="l00108"></a><a class="code" href="classvil__tiff__header.html#a2bfeea09ae1b581392df064c48a08125">00108</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a2bfeea09ae1b581392df064c48a08125">grey_response_curve_valid</a>;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="comment">//the unit of radiometry</span>
<a name="l00111"></a><a class="code" href="classvil__tiff__header.html#a5bb2ef4008900035d8bbf1dfcfd2db0e">00111</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a5bb2ef4008900035d8bbf1dfcfd2db0e">gray_response_unit</a>;
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="classvil__tiff__header.html#a3c1c5682847f5b6bb716d98cd4b5fb32">00113</a>   vcl_string <a class="code" href="classvil__tiff__header.html#a3c1c5682847f5b6bb716d98cd4b5fb32">host_computer</a>;
<a name="l00114"></a><a class="code" href="classvil__tiff__header.html#a90c2c00284b8cbdf0a887cc0ee349334">00114</a>   vcl_string <a class="code" href="classvil__tiff__header.html#a90c2c00284b8cbdf0a887cc0ee349334">image_description</a>;
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">00116</a>   <a class="code" href="structulong__tag.html">ulong_tag</a> <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <span class="comment">//:theoretical from samples per line</span>
<a name="l00119"></a>00119   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#aa5b28835789ced631443325f211d0c65" title="theoretical from samples per line.">bytes_per_line</a>() <span class="keyword">const</span>;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="comment">//:As returned by the TIFF library</span>
<a name="l00122"></a>00122   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ad8fcec4900bd7d1ed9ef6dfc634a69c1" title="As returned by the TIFF library.">actual_bytes_per_line</a>() <span class="keyword">const</span>;
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">00124</a>   <a class="code" href="structulong__tag.html">ulong_tag</a> <a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>;
<a name="l00125"></a>00125 
<a name="l00126"></a><a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">00126</a>   <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a>;
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="classvil__tiff__header.html#a77f6bcd55e436c1545eb570dd6708b31">00128</a>   vcl_string <a class="code" href="classvil__tiff__header.html#a77f6bcd55e436c1545eb570dd6708b31">make</a>;
<a name="l00129"></a>00129 
<a name="l00130"></a><a class="code" href="classvil__tiff__header.html#a41a331938a945ecff7babb1ab53e7b13">00130</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a41a331938a945ecff7babb1ab53e7b13">max_sample_value</a>;
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="classvil__tiff__header.html#ab79433742a4825f117eb36fd5e8a8436">00132</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#ab79433742a4825f117eb36fd5e8a8436">min_sample_value</a>;
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="classvil__tiff__header.html#ace6bdddcae612c0194bb86a0b59d6531">00134</a>   vcl_string <a class="code" href="classvil__tiff__header.html#ace6bdddcae612c0194bb86a0b59d6531">model</a>;
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="classvil__tiff__header.html#ad970c2cd1181397e6e1e2b37d9e5b773">00136</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#ad970c2cd1181397e6e1e2b37d9e5b773">orientation</a>;
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">00138</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>;
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">00140</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>;
<a name="l00141"></a>00141 
<a name="l00142"></a><a class="code" href="classvil__tiff__header.html#aa29c9139dea762d6a943afe6e505c525">00142</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#aa29c9139dea762d6a943afe6e505c525">resolution_unit</a>;
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">00144</a>   <a class="code" href="structulong__tag.html">ulong_tag</a> <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ac9918c2e1667c1948cf4960a3afa775c">rows_in_strip</a>() <span class="keyword">const</span>;
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="classvil__tiff__header.html#ae87586b188877f71fffd691016d38947">00148</a>   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ae87586b188877f71fffd691016d38947">strips_per_image</a>()<span class="keyword"> const</span>
<a name="l00149"></a>00149 <span class="keyword">  </span>{ <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> ?
<a name="l00150"></a>00150       <span class="keyword">static_cast&lt;</span>vxl_uint_32<span class="keyword">&gt;</span>(vcl_floor(1.0+(<a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>-1)/<a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>)) : 1L;
<a name="l00151"></a>00151   }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153   <span class="comment">//the actual size of the strip in the file</span>
<a name="l00154"></a>00154   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ae79ac8d933c256ff899f6f0f790646c6">actual_bytes_per_strip</a>(<span class="keyword">const</span> vxl_uint_32 strip_index) <span class="keyword">const</span>;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="comment">//the theoretical size based on rows_per_strip and bytes_per_line</span>
<a name="l00157"></a>00157   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a6b03876b43aca8f1b5bee61fcecd6733">bytes_per_strip</a>() <span class="keyword">const</span>;
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">00159</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>;
<a name="l00160"></a><a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">00160</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>;
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="classvil__tiff__header.html#a95601005840871acc703999d357417ac">00162</a>   vcl_string <a class="code" href="classvil__tiff__header.html#a95601005840871acc703999d357417ac">software</a>;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="comment">//for planar_config = 1</span>
<a name="l00165"></a>00165   <span class="comment">//[st0|st1|...|strips_per_image-1]</span>
<a name="l00166"></a>00166   <span class="comment">//for planar_config = 2</span>
<a name="l00167"></a>00167   <span class="comment">//[st0|st1|...|strips_per_image-1] ... [st0|st1|...|strips_per_image-1]</span>
<a name="l00168"></a>00168   <span class="comment">//          sample 0               ...         samples_per_pixel-1</span>
<a name="l00169"></a><a class="code" href="classvil__tiff__header.html#ac669914c904ef97ff2fe25ad5da17c2d">00169</a>   vxl_uint_32* <a class="code" href="classvil__tiff__header.html#ac669914c904ef97ff2fe25ad5da17c2d">strip_byte_counts</a>;
<a name="l00170"></a><a class="code" href="classvil__tiff__header.html#a5e33c35c79a8adae78e9cdfb0dc9b4e6">00170</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a5e33c35c79a8adae78e9cdfb0dc9b4e6">strip_byte_counts_valid</a>;
<a name="l00171"></a><a class="code" href="classvil__tiff__header.html#a344af057b87f93237bf8257b43bf69bd">00171</a>   vxl_uint_32* <a class="code" href="classvil__tiff__header.html#a344af057b87f93237bf8257b43bf69bd">strip_offsets</a>;
<a name="l00172"></a><a class="code" href="classvil__tiff__header.html#a35b071ead0e71d237a21ca72a81b695c">00172</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a35b071ead0e71d237a21ca72a81b695c">strip_offsets_valid</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="classvil__tiff__header.html#a41929a7f8660fa648edac4c09bba887c">00174</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a41929a7f8660fa648edac4c09bba887c">subfile_type</a>;
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="classvil__tiff__header.html#a49c0be2ef39695d6a411558ee189a871">00176</a>   <a class="code" href="structushort__tag.html">ushort_tag</a> <a class="code" href="classvil__tiff__header.html#a49c0be2ef39695d6a411558ee189a871">thresholding</a>;
<a name="l00177"></a>00177 
<a name="l00178"></a><a class="code" href="classvil__tiff__header.html#a2ec4820a9e21a76e5b13437792aba44c">00178</a>   <span class="keywordtype">float</span> <a class="code" href="classvil__tiff__header.html#a2ec4820a9e21a76e5b13437792aba44c">x_resolution</a>;
<a name="l00179"></a><a class="code" href="classvil__tiff__header.html#a192c54ac721c8c47c1fb406ca47b0f1a">00179</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a192c54ac721c8c47c1fb406ca47b0f1a">x_resolution_valid</a>;
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="classvil__tiff__header.html#acefe3c69c6b4faf972575462a065ccc6">00181</a>   <span class="keywordtype">float</span> <a class="code" href="classvil__tiff__header.html#acefe3c69c6b4faf972575462a065ccc6">y_resolution</a>;
<a name="l00182"></a><a class="code" href="classvil__tiff__header.html#aa4718590e675aa968421e06c5006e427">00182</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#aa4718590e675aa968421e06c5006e427">y_resolution_valid</a>;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184   <span class="comment">//tiff extension for blocking</span>
<a name="l00185"></a><a class="code" href="classvil__tiff__header.html#a1f0e82f47220affa74870c578a650929">00185</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a1f0e82f47220affa74870c578a650929">is_tiled_flag</a>;
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">00187</a>   <a class="code" href="structulong__tag.html">ulong_tag</a> <a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>;
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">00189</a>   <a class="code" href="structulong__tag.html">ulong_tag</a> <a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191   <span class="comment">//for planar_config = 1</span>
<a name="l00192"></a>00192   <span class="comment">//[st0|st1|...|tiles_per_image-1]</span>
<a name="l00193"></a>00193   <span class="comment">//for planar_config = 2</span>
<a name="l00194"></a>00194   <span class="comment">//[st0|st1|...|tiles_per_image-1] ... [st0|st1|...|tiles_per_image-1]</span>
<a name="l00195"></a>00195   <span class="comment">//          sample 0               ...         samples_per_pixel-1</span>
<a name="l00196"></a><a class="code" href="classvil__tiff__header.html#a5da98a7d22f783f6de0a08ab529e9b12">00196</a>   vxl_uint_32*  <a class="code" href="classvil__tiff__header.html#a5da98a7d22f783f6de0a08ab529e9b12">tile_offsets</a>;
<a name="l00197"></a><a class="code" href="classvil__tiff__header.html#adb70a069d4bb8fa1f3a38528c0427a5c">00197</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#adb70a069d4bb8fa1f3a38528c0427a5c">tile_offsets_valid</a>;
<a name="l00198"></a><a class="code" href="classvil__tiff__header.html#a47e50142d3d517442acdedc6560cda17">00198</a>   vxl_uint_32* <a class="code" href="classvil__tiff__header.html#a47e50142d3d517442acdedc6560cda17">tile_byte_counts</a>;
<a name="l00199"></a><a class="code" href="classvil__tiff__header.html#a1202f26c9c20eb4bb6d8f581362451d3">00199</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a1202f26c9c20eb4bb6d8f581362451d3">tile_byte_counts_valid</a>;
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="classvil__tiff__header.html#a7aaa25b8b0c48864585c883374aad559">00201</a>   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a7aaa25b8b0c48864585c883374aad559">tiles_across</a>()<span class="keyword"> const</span>
<a name="l00202"></a>00202 <span class="keyword">  </span>{ <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> ?
<a name="l00203"></a>00203       <span class="keyword">static_cast&lt;</span>vxl_uint_32<span class="keyword">&gt;</span>(vcl_floor(1.0+(<a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>-1)/<a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>)) : 0L;
<a name="l00204"></a>00204   }
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="classvil__tiff__header.html#a1cfba988e6206587c50d708836edc4c3">00206</a>   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a1cfba988e6206587c50d708836edc4c3">tiles_down</a>()<span class="keyword"> const</span>
<a name="l00207"></a>00207 <span class="keyword">  </span>{ <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> ?
<a name="l00208"></a>00208       <span class="keyword">static_cast&lt;</span>vxl_uint_32<span class="keyword">&gt;</span>(vcl_floor(1.0+(<a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>-1)/<a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>)) : 0L;
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210 
<a name="l00211"></a><a class="code" href="classvil__tiff__header.html#a537b70f2997b9749976fc89ef30e0cf2">00211</a>   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a537b70f2997b9749976fc89ef30e0cf2">tiles_per_image</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#a7aaa25b8b0c48864585c883374aad559">tiles_across</a>()*<a class="code" href="classvil__tiff__header.html#a1cfba988e6206587c50d708836edc4c3">tiles_down</a>();}
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a18e5aed0dd97e1d32f692b1538cf40f2">bytes_per_tile</a>() <span class="keyword">const</span>;
<a name="l00214"></a>00214 
<a name="l00215"></a>00215   <span class="comment">//: the actual number of separate image planes in the tiff image</span>
<a name="l00216"></a>00216   <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a85a9a8d9db1768becefe577bbb7470e1" title="the actual number of separate image planes in the tiff image.">n_separate_image_planes</a>() <span class="keyword">const</span>;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="comment">//: the number of encoded bytes in a tile or strip</span>
<a name="l00219"></a>00219   <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#acf9b3cc7b12e97a47902394ecd706a85" title="the number of encoded bytes in a tile or strip.">encoded_bytes_per_block</a>() <span class="keyword">const</span>;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221   <span class="comment">//: the number of samples in a block</span>
<a name="l00222"></a>00222   <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a79b21bea4df43d0a4391e26dfb62d6df" title="the number of samples in a block.">samples_per_line</a>() <span class="keyword">const</span>;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224   <span class="comment">//: is the image tiled</span>
<a name="l00225"></a>00225   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#aa6459cf4fac41675bac31dd16dc8879b" title="is the image tiled.">is_tiled</a>() <span class="keyword">const</span>;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="comment">//: is the image striped (one of these must be true or read failed)</span>
<a name="l00228"></a>00228   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#afd821969654eb2b461584ea5b99adad6" title="is the image striped (one of these must be true or read failed).">is_striped</a>() <span class="keyword">const</span>;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="preprocessor">#if HAS_GEOTIFF</span>
<a name="l00231"></a>00231 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> is_GEOTIFF() <span class="keyword">const</span>;
<a name="l00232"></a>00232 <span class="preprocessor">#endif</span>
<a name="l00233"></a>00233 <span class="preprocessor"></span>
<a name="l00234"></a><a class="code" href="classvil__tiff__header.html#af5ff5807e6c332c970125178090e381b">00234</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#af5ff5807e6c332c970125178090e381b">need_byte_swap</a>()
<a name="l00235"></a>00235   { <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#afed1062f528e35fee5a9389e2ccdf751">file_is_big_endian_</a>!=<a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a> &amp;&amp;
<a name="l00236"></a>00236            <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>%8 != 0;
<a name="l00237"></a>00237   }
<a name="l00238"></a>00238 
<a name="l00239"></a><a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">00239</a>   <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a>;
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="comment">//: true if the specified format can be read or written.</span>
<a name="l00242"></a>00242   <span class="comment">// check and return a null resource if false</span>
<a name="l00243"></a><a class="code" href="classvil__tiff__header.html#ae257906aa45a86bd4d22d89d8e6b93eb">00243</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#ae257906aa45a86bd4d22d89d8e6b93eb" title="true if the specified format can be read or written.">format_supported</a>;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   <span class="comment">//: the number of images in the file</span>
<a name="l00246"></a>00246   vxl_uint_16  <a class="code" href="classvil__tiff__header.html#a9752fc1c91654e1497776bb52711176e" title="the number of images in the file.">n_images</a>();
<a name="l00247"></a>00247  <span class="keyword">private</span>:
<a name="l00248"></a><a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">00248</a>   TIFF* <a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>;
<a name="l00249"></a>00249   <span class="comment">//: read/write mode true for read.</span>
<a name="l00250"></a>00250   <span class="comment">// returns false if the format cannot be read by current version</span>
<a name="l00251"></a>00251   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#aa8270f9ca712eb4f4786e281b1ab90e5" title="read/write mode true for read.">read_header</a>();
<a name="l00252"></a>00252   <span class="comment">//:returns false if the format cannot be written by current version</span>
<a name="l00253"></a>00253   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a6c936c90c7da395d098aab22e86fe554" title="returns false if the format cannot be written by current version.">set_header</a>(<span class="keywordtype">unsigned</span> ni, <span class="keywordtype">unsigned</span> nj, <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a>,
<a name="l00254"></a>00254                   <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <span class="keyword">const</span>&amp; fmt,
<a name="l00255"></a>00255                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_i,
<a name="l00256"></a>00256                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_j);
<a name="l00257"></a>00257   <span class="comment">//:returns false if the format not handled by this reader</span>
<a name="l00258"></a>00258   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a2cc20df664f1acb4423f99688542957a" title="returns false if the format not handled by this reader.">compute_pixel_format</a>();
<a name="l00259"></a>00259   <span class="comment">//:returns false if the format not handled by this writer</span>
<a name="l00260"></a>00260   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a1f59d26f5cc3613f9b08a57327d70051" title="returns false if the format not handled by this writer.">parse_pixel_format</a>(<a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <span class="keyword">const</span>&amp; fmt);
<a name="l00261"></a><a class="code" href="classvil__tiff__header.html#afed1062f528e35fee5a9389e2ccdf751">00261</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#afed1062f528e35fee5a9389e2ccdf751">file_is_big_endian_</a>;
<a name="l00262"></a><a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">00262</a>   <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a>;
<a name="l00263"></a>00263 };
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="preprocessor">#endif //vil_tiff_header_h_</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:31:47 for core/vil by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
