<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>core/vil/file_formats/vil_tiff_header.cxx Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">core/vil/file_formats/vil_tiff_header.cxx</div>  </div>
</div>
<div class="contents">
<a href="vil__tiff__header_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;<a class="code" href="vil__tiff__header_8h.html" title="A header structure for tiff files.">vil_tiff_header.h</a>&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;vcl_iostream.h&gt;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;vcl_cstdio.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;vcl_ctime.h&gt;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#if HAS_GEOTIFF</span>
<a name="l00007"></a>00007 <span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="vil__geotiff__header_8h.html" title="A header structure for geotiff files.">vil/file_formats/vil_geotiff_header.h</a>&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#endif</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="keyword">static</span> vcl_string date_and_time()
<a name="l00011"></a>00011 {
<a name="l00012"></a>00012   vcl_time_t clock;
<a name="l00013"></a>00013   <span class="keyword">struct </span>vcl_tm *t_m;
<a name="l00014"></a>00014   clock = vcl_time(NULL);
<a name="l00015"></a>00015   t_m = vcl_localtime(&amp;clock);
<a name="l00016"></a>00016   <span class="keywordtype">char</span> tmp[20];
<a name="l00017"></a>00017   <span class="keywordtype">char</span> datetime[20];
<a name="l00018"></a>00018   vcl_strftime(tmp,<span class="keyword">sizeof</span>(datetime),<span class="stringliteral">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,t_m);
<a name="l00019"></a>00019   <span class="comment">// changed from &quot;%c&quot;, to make it generic, size=19, and avoid compiler warning</span>
<a name="l00020"></a>00020   vcl_sprintf(datetime,<span class="stringliteral">&quot;%19s&quot;</span>,tmp);
<a name="l00021"></a>00021   <span class="keywordflow">return</span> vcl_string(datetime);
<a name="l00022"></a>00022 }
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="keyword">static</span> <span class="keywordtype">void</span> read_string(TIFF* tif, ttag_t tag, vcl_string&amp; stag, vcl_string <span class="keyword">const</span>&amp; deflt = <span class="stringliteral">&quot;not_defined&quot;</span>)
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026   <span class="keywordtype">char</span>* adr = 0;
<a name="l00027"></a>00027   TIFFGetField(tif, tag, &amp;adr);
<a name="l00028"></a>00028   <span class="keywordflow">if</span> (adr)
<a name="l00029"></a>00029     stag = vcl_string(adr);
<a name="l00030"></a>00030   <span class="keywordflow">else</span>
<a name="l00031"></a>00031     stag = deflt;
<a name="l00032"></a>00032 }
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">static</span> <span class="keywordtype">void</span> read_short_tag(TIFF* tif, ttag_t tag, <a class="code" href="structushort__tag.html">ushort_tag</a>&amp; utag, vxl_uint_16 deflt =0)
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036   utag.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = TIFFGetField(tif, tag, &amp;(utag.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>))&gt;0;
<a name="l00037"></a>00037   <span class="keywordflow">if</span> (!utag.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>)
<a name="l00038"></a>00038     utag.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = deflt;
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="keyword">static</span> <span class="keywordtype">void</span> read_long_tag(TIFF* tif, ttag_t tag, <a class="code" href="structulong__tag.html">ulong_tag</a>&amp; utag, vxl_uint_32 deflt = 0)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043   utag.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> = TIFFGetField(tif, tag, &amp;(utag.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>))&gt;0;
<a name="l00044"></a>00044   <span class="keywordflow">if</span> (!utag.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00045"></a>00045     utag.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> = deflt;
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keyword">static</span> <span class="keywordtype">void</span> read_float_tag(TIFF* tif, ttag_t tag, <span class="keywordtype">float</span>&amp; val, <span class="keywordtype">bool</span>&amp; valid, <span class="keywordtype">float</span> deflt = 0)
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050   valid = TIFFGetField(tif, tag, &amp;(val))&gt;0;
<a name="l00051"></a>00051   <span class="keywordflow">if</span> (!valid)
<a name="l00052"></a>00052     val = deflt;
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#if 0 // unused static function</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="comment">//assumes array is resized properly</span>
<a name="l00057"></a>00057 <span class="keyword">static</span> <span class="keywordtype">bool</span> read_long_array(TIFF* tif, ttag_t tag,
<a name="l00058"></a>00058                             vcl_vector&lt;vxl_uint_32&gt;&amp; array)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060   vxl_uint_32 * a;
<a name="l00061"></a>00061   <span class="keywordflow">if</span> (TIFFGetField(tif, tag, &amp;a))
<a name="l00062"></a>00062   {
<a name="l00063"></a>00063     <span class="keywordflow">for</span> (vxl_uint_32 i=0; i&lt;array.size(); ++i) { array[i]=a[i]; }
<a name="l00064"></a>00064     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00065"></a>00065   }
<a name="l00066"></a>00066   <span class="keywordflow">else</span> <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 <span class="preprocessor">#endif // unused static function</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span>
<a name="l00070"></a>00070 <span class="keyword">static</span> <span class="keywordtype">void</span> write_short_tag(TIFF* tif, ttag_t tag, <a class="code" href="structushort__tag.html">ushort_tag</a> <span class="keyword">const</span>&amp; ustag)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   <span class="keywordflow">if</span> (ustag.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>)
<a name="l00073"></a>00073     TIFFSetField(tif, tag, ustag.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>);
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keyword">static</span> <span class="keywordtype">void</span> write_long_tag(TIFF* tif, ttag_t tag, <a class="code" href="structulong__tag.html">ulong_tag</a> <span class="keyword">const</span>&amp; ultag)
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078   <span class="keywordflow">if</span> (ultag.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00079"></a>00079     TIFFSetField(tif, tag, ultag.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>);
<a name="l00080"></a>00080 }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="preprocessor">#if 0 // not currently used...</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span> write_float_tag(TIFF* tif, ttag_t tag, <span class="keywordtype">float</span> <span class="keyword">const</span> val, <span class="keywordtype">bool</span> <span class="keyword">const</span> valid)
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (valid)
<a name="l00086"></a>00086     TIFFSetField(tif, tag, val);
<a name="l00087"></a>00087 }
<a name="l00088"></a>00088 <span class="preprocessor">#endif</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span>
<a name="l00090"></a>00090 <span class="keyword">static</span> <span class="keywordtype">void</span> write_string(TIFF* tif, ttag_t tag, vcl_string <span class="keyword">const</span>&amp; stag)
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092   TIFFSetField(tif, tag, stag.c_str());
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classvil__tiff__header.html#aa8270f9ca712eb4f4786e281b1ab90e5">00096</a> <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#aa8270f9ca712eb4f4786e281b1ab90e5" title="read/write mode true for read.">vil_tiff_header::read_header</a>()
<a name="l00097"></a>00097 {
<a name="l00098"></a>00098   <span class="comment">//DEBUG</span>
<a name="l00099"></a>00099 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>  vcl_cout &lt;&lt; date_and_time() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00101"></a>00101 <span class="preprocessor">#endif</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>  <span class="comment">//====</span>
<a name="l00103"></a>00103   <span class="comment">//Determine the endian state of the file and machine</span>
<a name="l00104"></a>00104   <a class="code" href="classvil__tiff__header.html#afed1062f528e35fee5a9389e2ccdf751">file_is_big_endian_</a> = TIFFIsByteSwapped(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>)&gt;0;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106   <span class="comment">//also need machine endian</span>
<a name="l00107"></a>00107 <span class="preprocessor">#if VXL_BIG_ENDIAN</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>    <a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a> = <span class="keyword">true</span>;
<a name="l00109"></a>00109 <span class="preprocessor">#else</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span>    <a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a> = <span class="keyword">false</span>;
<a name="l00111"></a>00111 <span class="preprocessor">#endif</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>  <span class="comment">//the following group must be read first since they</span>
<a name="l00113"></a>00113   <span class="comment">//dictate subsequent tag structures</span><span class="comment"></span>
<a name="l00114"></a>00114 <span class="comment">  ///-----------------------------------------------///</span>
<a name="l00115"></a>00115 <span class="comment"></span>  read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_PHOTOMETRIC, <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>);
<a name="l00116"></a>00116   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_PLANARCONFIG, <a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>, 1);
<a name="l00117"></a>00117   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_SAMPLESPERPIXEL, <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>, 1);
<a name="l00118"></a>00118   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_BITSPERSAMPLE, <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>, 8);
<a name="l00119"></a>00119   <a class="code" href="classvil__tiff__header.html#a1f0e82f47220affa74870c578a650929">is_tiled_flag</a> = TIFFIsTiled(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>)&gt;0;<span class="comment"></span>
<a name="l00120"></a>00120 <span class="comment">  ///-----------------------------------------------///</span>
<a name="l00121"></a>00121 <span class="comment"></span>  read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_ARTIST , <a class="code" href="classvil__tiff__header.html#aefa46b7de5ab26e85d30aac509e11edb">artist</a>);
<a name="l00122"></a>00122   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_CELLLENGTH, <a class="code" href="classvil__tiff__header.html#adff896b3e724e6af8c3f82d6f6e950ca">cell_length</a>);
<a name="l00123"></a>00123   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_CELLWIDTH, <a class="code" href="classvil__tiff__header.html#a1e9f3e69d69a7279013756ae9390a505">cell_width</a>);
<a name="l00124"></a>00124   <a class="code" href="classvil__tiff__header.html#a295adba18b56f7e9f6792bebeb1a6981">color_map_valid</a> = <span class="keyword">false</span>;
<a name="l00125"></a>00125   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> &amp;&amp;
<a name="l00126"></a>00126       <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> &amp;&amp;
<a name="l00127"></a>00127       <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> == PHOTOMETRIC_PALETTE)
<a name="l00128"></a>00128   {
<a name="l00129"></a>00129     vxl_uint_16* cm[3];
<a name="l00130"></a>00130     TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_COLORMAP, &amp;cm[0], &amp;cm[1], &amp;cm[2]);
<a name="l00131"></a>00131     <span class="keywordtype">unsigned</span> size = 1&lt;&lt;<a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>;
<a name="l00132"></a>00132     <a class="code" href="classvil__tiff__header.html#ab0d9634704041ccb6fa72e5bc11a630f">color_map</a>.resize(size);
<a name="l00133"></a>00133     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i&lt;size; ++i)
<a name="l00134"></a>00134     {
<a name="l00135"></a>00135       vcl_vector&lt;vxl_uint_16&gt; <a class="code" href="vil__rgb_8h.html#a53ebd0eabadf8cd53f5c55958d57b355">rgb</a>(3);
<a name="l00136"></a>00136       rgb[0]=cm[0][i];  rgb[1]=cm[1][i];  rgb[2]=cm[2][i];
<a name="l00137"></a>00137       <a class="code" href="classvil__tiff__header.html#ab0d9634704041ccb6fa72e5bc11a630f">color_map</a>[i] = <a class="code" href="vil__rgb_8h.html#a53ebd0eabadf8cd53f5c55958d57b355">rgb</a>;
<a name="l00138"></a>00138 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00139"></a>00139 <span class="preprocessor"></span>      vcl_cout &lt;&lt; <span class="stringliteral">&quot;RGB[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=(&quot;</span> &lt;&lt; rgb[0] &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; rgb[1] &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; rgb[2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;
<a name="l00140"></a>00140 <span class="preprocessor">#endif</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>    }
<a name="l00142"></a>00142     <a class="code" href="classvil__tiff__header.html#a295adba18b56f7e9f6792bebeb1a6981">color_map_valid</a> = <span class="keyword">true</span>;
<a name="l00143"></a>00143   }
<a name="l00144"></a>00144   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_COMPRESSION, <a class="code" href="classvil__tiff__header.html#a9c6f1910282716a18856a9e36841c0cb">compression</a>);
<a name="l00145"></a>00145   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_COPYRIGHT, <a class="code" href="classvil__tiff__header.html#a04e32033456d40ba247a27345cb49006">copyright</a>);
<a name="l00146"></a>00146   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_DATETIME,<a class="code" href="classvil__tiff__header.html#aa3935ef5582fbcdd8d30719e796f13ef">date_time</a>);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <span class="comment">// EXTRASAMPLES tag requires two input arguments, which is different</span>
<a name="l00149"></a>00149   <span class="comment">// from other 16bit values.</span>
<a name="l00150"></a>00150   vxl_uint_16* sample_info=0;
<a name="l00151"></a>00151   <a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">extra_samples</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>=0;
<a name="l00152"></a>00152   <a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">extra_samples</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">false</span>;
<a name="l00153"></a>00153   <span class="keywordtype">int</span> <span class="keyword">const</span> ret_extrasamples = TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_EXTRASAMPLES, &amp;<a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">extra_samples</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>, &amp;sample_info);
<a name="l00154"></a>00154   <span class="keywordflow">if</span> (ret_extrasamples &amp;&amp; <a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">extra_samples</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> &gt; 0)
<a name="l00155"></a>00155     <a class="code" href="classvil__tiff__header.html#a544a91e2dc3f76b5d15163e634b99874">extra_samples</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_FILLORDER, <a class="code" href="classvil__tiff__header.html#a12c36d76bd5ac37fdc69d98c4daeec9c">fill_order</a>);
<a name="l00158"></a>00158   vxl_uint_16* gc=0;
<a name="l00159"></a>00159   TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_GRAYRESPONSECURVE, &amp;gc);
<a name="l00160"></a>00160   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_GRAYRESPONSEUNIT, <a class="code" href="classvil__tiff__header.html#a5bb2ef4008900035d8bbf1dfcfd2db0e">gray_response_unit</a>);
<a name="l00161"></a>00161   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_HOSTCOMPUTER, <a class="code" href="classvil__tiff__header.html#a3c1c5682847f5b6bb716d98cd4b5fb32">host_computer</a>);
<a name="l00162"></a>00162   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_IMAGEDESCRIPTION, <a class="code" href="classvil__tiff__header.html#a90c2c00284b8cbdf0a887cc0ee349334">image_description</a>);
<a name="l00163"></a>00163   read_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_IMAGELENGTH, <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>);
<a name="l00164"></a>00164   read_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_IMAGEWIDTH, <a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>);
<a name="l00165"></a>00165   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_MAKE, <a class="code" href="classvil__tiff__header.html#a77f6bcd55e436c1545eb570dd6708b31">make</a>);
<a name="l00166"></a>00166   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_MAXSAMPLEVALUE, <a class="code" href="classvil__tiff__header.html#a41a331938a945ecff7babb1ab53e7b13">max_sample_value</a>, 255);
<a name="l00167"></a>00167   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_MINSAMPLEVALUE, <a class="code" href="classvil__tiff__header.html#ab79433742a4825f117eb36fd5e8a8436">min_sample_value</a>, 0);
<a name="l00168"></a>00168   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_MODEL, <a class="code" href="classvil__tiff__header.html#ace6bdddcae612c0194bb86a0b59d6531">model</a>);
<a name="l00169"></a>00169   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_SUBFILETYPE, <a class="code" href="classvil__tiff__header.html#a41929a7f8660fa648edac4c09bba887c">subfile_type</a>);
<a name="l00170"></a>00170   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_ORIENTATION, <a class="code" href="classvil__tiff__header.html#ad970c2cd1181397e6e1e2b37d9e5b773">orientation</a>, 1);
<a name="l00171"></a>00171   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_RESOLUTIONUNIT, <a class="code" href="classvil__tiff__header.html#aa29c9139dea762d6a943afe6e505c525">resolution_unit</a>);
<a name="l00172"></a>00172   read_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_ROWSPERSTRIP, <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>);
<a name="l00173"></a>00173   read_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_SOFTWARE, <a class="code" href="classvil__tiff__header.html#a95601005840871acc703999d357417ac">software</a>);
<a name="l00174"></a>00174   read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_SAMPLEFORMAT, <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>, 1);
<a name="l00175"></a>00175   <a class="code" href="classvil__tiff__header.html#a5e33c35c79a8adae78e9cdfb0dc9b4e6">strip_byte_counts_valid</a> = <span class="keyword">false</span>;
<a name="l00176"></a>00176   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00177"></a>00177   {
<a name="l00178"></a>00178     <a class="code" href="classvil__tiff__header.html#a5e33c35c79a8adae78e9cdfb0dc9b4e6">strip_byte_counts_valid</a> =
<a name="l00179"></a>00179       TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_STRIPBYTECOUNTS , &amp;<a class="code" href="classvil__tiff__header.html#ac669914c904ef97ff2fe25ad5da17c2d">strip_byte_counts</a>)&gt;0;
<a name="l00180"></a>00180 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>    <span class="comment">//      vxl_uint_32 size = strips_per_image()*samples_per_pixel.val;</span>
<a name="l00182"></a>00182     vxl_uint_32 size = <a class="code" href="classvil__tiff__header.html#ae87586b188877f71fffd691016d38947">strips_per_image</a>();
<a name="l00183"></a>00183     <span class="keywordflow">for</span> (vxl_uint_32 i = 0; i&lt;size; ++i)
<a name="l00184"></a>00184       vcl_cout &lt;&lt; <span class="stringliteral">&quot;SBC[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; <a class="code" href="classvil__tiff__header.html#ac669914c904ef97ff2fe25ad5da17c2d">strip_byte_counts</a>[i] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00185"></a>00185 <span class="preprocessor">#endif</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span>  }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188   <a class="code" href="classvil__tiff__header.html#a35b071ead0e71d237a21ca72a81b695c">strip_offsets_valid</a> = <span class="keyword">false</span>;
<a name="l00189"></a>00189 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00191"></a>00191   {
<a name="l00192"></a>00192     <a class="code" href="classvil__tiff__header.html#a35b071ead0e71d237a21ca72a81b695c">strip_offsets_valid</a> =
<a name="l00193"></a>00193       TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_STRIPOFFSETS, &amp;<a class="code" href="classvil__tiff__header.html#a344af057b87f93237bf8257b43bf69bd">strip_offsets</a>)&gt;0;
<a name="l00194"></a>00194     <span class="comment">//      vxl_uint_32 size = strips_per_image()*samples_per_pixel.val;</span>
<a name="l00195"></a>00195     vxl_uint_32 size = <a class="code" href="classvil__tiff__header.html#ae87586b188877f71fffd691016d38947">strips_per_image</a>();
<a name="l00196"></a>00196       <span class="keywordflow">for</span> (vxl_uint_32 i = 0; i&lt;size; ++i)
<a name="l00197"></a>00197       vcl_cout &lt;&lt; <span class="stringliteral">&quot;SOFF[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; <a class="code" href="classvil__tiff__header.html#a344af057b87f93237bf8257b43bf69bd">strip_offsets</a>[i] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00198"></a>00198   }
<a name="l00199"></a>00199 <span class="preprocessor">#endif</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>  read_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_THRESHHOLDING, <a class="code" href="classvil__tiff__header.html#a49c0be2ef39695d6a411558ee189a871">thresholding</a>);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202   read_float_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_XRESOLUTION, <a class="code" href="classvil__tiff__header.html#a2ec4820a9e21a76e5b13437792aba44c">x_resolution</a>, <a class="code" href="classvil__tiff__header.html#a192c54ac721c8c47c1fb406ca47b0f1a">x_resolution_valid</a>);
<a name="l00203"></a>00203   read_float_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_YRESOLUTION, <a class="code" href="classvil__tiff__header.html#acefe3c69c6b4faf972575462a065ccc6">y_resolution</a>, <a class="code" href="classvil__tiff__header.html#aa4718590e675aa968421e06c5006e427">y_resolution_valid</a>);
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   read_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_TILEWIDTH, <a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>, 0);
<a name="l00206"></a>00206   read_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_TILELENGTH, <a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>, 0);
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   <a class="code" href="classvil__tiff__header.html#adb70a069d4bb8fa1f3a38528c0427a5c">tile_offsets_valid</a> = <span class="keyword">false</span>;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00211"></a>00211 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>&amp;&amp;<a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00212"></a>00212   {
<a name="l00213"></a>00213     <a class="code" href="classvil__tiff__header.html#adb70a069d4bb8fa1f3a38528c0427a5c">tile_offsets_valid</a> =
<a name="l00214"></a>00214       TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_TILEOFFSETS, &amp;<a class="code" href="classvil__tiff__header.html#a5da98a7d22f783f6de0a08ab529e9b12">tile_offsets</a>)&gt;0;
<a name="l00215"></a>00215     <span class="comment">//      vxl_uint_32 size = tiles_per_image()*samples_per_pixel.val;</span>
<a name="l00216"></a>00216     vxl_uint_32 size = <a class="code" href="classvil__tiff__header.html#a537b70f2997b9749976fc89ef30e0cf2">tiles_per_image</a>();
<a name="l00217"></a>00217     <span class="keywordflow">for</span> (vxl_uint_32 i = 0; i&lt;size; ++i)
<a name="l00218"></a>00218       vcl_cout &lt;&lt; <span class="stringliteral">&quot;TOFF[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; <a class="code" href="classvil__tiff__header.html#a5da98a7d22f783f6de0a08ab529e9b12">tile_offsets</a>[i] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00219"></a>00219   }
<a name="l00220"></a>00220 <span class="preprocessor">#endif</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span>
<a name="l00222"></a>00222   <a class="code" href="classvil__tiff__header.html#a1202f26c9c20eb4bb6d8f581362451d3">tile_byte_counts_valid</a> = <span class="keyword">false</span>;
<a name="l00223"></a>00223 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>&amp;&amp;<a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00225"></a>00225   {
<a name="l00226"></a>00226     <a class="code" href="classvil__tiff__header.html#a1202f26c9c20eb4bb6d8f581362451d3">tile_byte_counts_valid</a> =
<a name="l00227"></a>00227      TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_TILEBYTECOUNTS, &amp;<a class="code" href="classvil__tiff__header.html#a47e50142d3d517442acdedc6560cda17">tile_byte_counts</a>)&gt;0;
<a name="l00228"></a>00228     <span class="comment">//      vxl_uint_32 size = tiles_per_image()*samples_per_pixel.val;</span>
<a name="l00229"></a>00229     vxl_uint_32 size = <a class="code" href="classvil__tiff__header.html#a537b70f2997b9749976fc89ef30e0cf2">tiles_per_image</a>();
<a name="l00230"></a>00230     <span class="keywordflow">for</span> (vxl_uint_32 i = 0; i&lt;size; ++i)
<a name="l00231"></a>00231       vcl_cout &lt;&lt; <span class="stringliteral">&quot;TBC[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; <a class="code" href="classvil__tiff__header.html#a47e50142d3d517442acdedc6560cda17">tile_byte_counts</a>[i] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00232"></a>00232   }
<a name="l00233"></a>00233 <span class="preprocessor">#endif</span>
<a name="l00234"></a>00234 <span class="preprocessor"></span>  <span class="keywordflow">return</span> this-&gt;<a class="code" href="classvil__tiff__header.html#a2cc20df664f1acb4423f99688542957a" title="returns false if the format not handled by this reader.">compute_pixel_format</a>();
<a name="l00235"></a>00235   <span class="comment">// int success = TIFFReadDirectory(tif_);</span>
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="comment">// the number of separate sample planes defined by the tiff file</span>
<a name="l00239"></a>00239 <span class="comment">// for example a multi-band image.</span>
<a name="l00240"></a><a class="code" href="classvil__tiff__header.html#a85a9a8d9db1768becefe577bbb7470e1">00240</a> <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a85a9a8d9db1768becefe577bbb7470e1" title="the actual number of separate image planes in the tiff image.">vil_tiff_header::n_separate_image_planes</a>()<span class="keyword"> const</span>
<a name="l00241"></a>00241 <span class="keyword"></span>{
<a name="l00242"></a>00242   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>)
<a name="l00243"></a>00243   {
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> == PLANARCONFIG_SEPARATE)
<a name="l00245"></a>00245       <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>;
<a name="l00246"></a>00246     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> == PLANARCONFIG_CONTIG)
<a name="l00247"></a>00247       <span class="keywordflow">return</span> 1;
<a name="l00248"></a>00248     <span class="keywordflow">else</span>
<a name="l00249"></a>00249       <span class="keywordflow">return</span> 0;
<a name="l00250"></a>00250   }
<a name="l00251"></a>00251   <span class="keywordflow">else</span>
<a name="l00252"></a>00252     <span class="keywordflow">return</span> 0;
<a name="l00253"></a>00253 }
<a name="l00254"></a>00254 
<a name="l00255"></a><a class="code" href="classvil__tiff__header.html#aa6459cf4fac41675bac31dd16dc8879b">00255</a> <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#aa6459cf4fac41675bac31dd16dc8879b" title="is the image tiled.">vil_tiff_header::is_tiled</a>()<span class="keyword"> const</span>
<a name="l00256"></a>00256 <span class="keyword"></span>{
<a name="l00257"></a>00257   <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#a1f0e82f47220affa74870c578a650929">is_tiled_flag</a> ||
<a name="l00258"></a>00258     (<a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>&amp;&amp;<a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>&amp;&amp;<a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>&gt;0&amp;&amp;<a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>&gt;0);
<a name="l00259"></a>00259 }
<a name="l00260"></a>00260 
<a name="l00261"></a><a class="code" href="classvil__tiff__header.html#afd821969654eb2b461584ea5b99adad6">00261</a> <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#afd821969654eb2b461584ea5b99adad6" title="is the image striped (one of these must be true or read failed).">vil_tiff_header::is_striped</a>()<span class="keyword"> const</span>
<a name="l00262"></a>00262 <span class="keyword"></span>{
<a name="l00263"></a>00263   <span class="comment">// Assume if rows_per_strip is not provided, assume it is infinity,</span>
<a name="l00264"></a>00264   <span class="comment">// and that the image is striped.</span>
<a name="l00265"></a>00265   <span class="keywordflow">return</span> (<a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> &amp;&amp; <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> &gt; 0) || !<a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>;
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="preprocessor">#if HAS_GEOTIFF</span>
<a name="l00269"></a>00269 <span class="preprocessor"></span><span class="keywordtype">bool</span> vil_tiff_header::is_GEOTIFF()<span class="keyword"> const</span>
<a name="l00270"></a>00270 <span class="keyword"></span>{
<a name="l00271"></a>00271   <span class="keywordtype">short</span> *data;
<a name="l00272"></a>00272   <span class="keywordtype">short</span> count;
<a name="l00273"></a>00273   <span class="keywordflow">return</span> TIFFGetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, 34735 <span class="comment">/*TIFFTAG_GEOKEYDIRECTORY*/</span>, &amp;count, &amp;data)!=0;
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 <span class="preprocessor">#endif</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>
<a name="l00277"></a><a class="code" href="classvil__tiff__header.html#acf9b3cc7b12e97a47902394ecd706a85">00277</a> <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#acf9b3cc7b12e97a47902394ecd706a85" title="the number of encoded bytes in a tile or strip.">vil_tiff_header::encoded_bytes_per_block</a>()<span class="keyword"> const</span>
<a name="l00278"></a>00278 <span class="keyword"></span>{
<a name="l00279"></a>00279   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#aa6459cf4fac41675bac31dd16dc8879b" title="is the image tiled.">is_tiled</a>())
<a name="l00280"></a>00280     <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(<a class="code" href="classvil__tiff__header.html#a18e5aed0dd97e1d32f692b1538cf40f2">bytes_per_tile</a>());
<a name="l00281"></a>00281   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#afd821969654eb2b461584ea5b99adad6" title="is the image striped (one of these must be true or read failed).">is_striped</a>())
<a name="l00282"></a>00282     <span class="keywordflow">return</span> static_cast&lt;unsigned&gt;(<a class="code" href="classvil__tiff__header.html#a6b03876b43aca8f1b5bee61fcecd6733">bytes_per_strip</a>());
<a name="l00283"></a>00283   <span class="keywordflow">else</span>
<a name="l00284"></a>00284     <span class="keywordflow">return</span> 0;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="comment">// the number of samples in a scan line</span>
<a name="l00288"></a><a class="code" href="classvil__tiff__header.html#a79b21bea4df43d0a4391e26dfb62d6df">00288</a> <span class="keywordtype">unsigned</span> <a class="code" href="classvil__tiff__header.html#a79b21bea4df43d0a4391e26dfb62d6df" title="the number of samples in a block.">vil_tiff_header::samples_per_line</a>()<span class="keyword"> const</span>
<a name="l00289"></a>00289 <span class="keyword"></span>{
<a name="l00290"></a>00290   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00291"></a>00291     <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>*<a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>;
<a name="l00292"></a>00292   <span class="keywordflow">return</span> 0;
<a name="l00293"></a>00293 }
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="classvil__tiff__header.html#aa5b28835789ced631443325f211d0c65">00295</a> vxl_uint_32 <a class="code" href="classvil__tiff__header.html#aa5b28835789ced631443325f211d0c65" title="theoretical from samples per line.">vil_tiff_header::bytes_per_line</a>()<span class="keyword"> const</span>
<a name="l00296"></a>00296 <span class="keyword"></span>{
<a name="l00297"></a>00297   <span class="keywordtype">unsigned</span> nsamp = this-&gt;<a class="code" href="classvil__tiff__header.html#a79b21bea4df43d0a4391e26dfb62d6df" title="the number of samples in a block.">samples_per_line</a>();
<a name="l00298"></a>00298   <span class="keywordtype">unsigned</span> bits_per_line = <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>*nsamp;
<a name="l00299"></a>00299   <span class="keywordflow">return</span> (bits_per_line + 7)/8;
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="classvil__tiff__header.html#ad8fcec4900bd7d1ed9ef6dfc634a69c1">00302</a> vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ad8fcec4900bd7d1ed9ef6dfc634a69c1" title="As returned by the TIFF library.">vil_tiff_header::actual_bytes_per_line</a>()<span class="keyword"> const</span>
<a name="l00303"></a>00303 <span class="keyword"></span>{
<a name="l00304"></a>00304     <span class="keywordflow">return</span> TIFFScanlineSize(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>);
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a><a class="code" href="classvil__tiff__header.html#ac9918c2e1667c1948cf4960a3afa775c">00307</a> vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ac9918c2e1667c1948cf4960a3afa775c">vil_tiff_header::rows_in_strip</a>()<span class="keyword"> const</span>
<a name="l00308"></a>00308 <span class="keyword"></span>{
<a name="l00309"></a>00309   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>&amp;&amp;<a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00310"></a>00310   {
<a name="l00311"></a>00311     vxl_uint_32 rps = <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>;
<a name="l00312"></a>00312     <span class="keywordflow">if</span> (rps&gt;<a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>)
<a name="l00313"></a>00313       <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>;
<a name="l00314"></a>00314     <span class="keywordflow">return</span> rps;
<a name="l00315"></a>00315   }
<a name="l00316"></a>00316   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a>)
<a name="l00317"></a>00317   {
<a name="l00318"></a>00318     <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a>;
<a name="l00319"></a>00319   }
<a name="l00320"></a>00320   <span class="keywordflow">return</span> 0;
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="comment">//this value can vary from one strip to the next</span>
<a name="l00324"></a>00324 vxl_uint_32 <a class="code" href="classvil__tiff__header.html#ae79ac8d933c256ff899f6f0f790646c6">vil_tiff_header::</a>
<a name="l00325"></a><a class="code" href="classvil__tiff__header.html#ae79ac8d933c256ff899f6f0f790646c6">00325</a> <a class="code" href="classvil__tiff__header.html#ae79ac8d933c256ff899f6f0f790646c6">actual_bytes_per_strip</a>(<span class="keyword">const</span> vxl_uint_32 strip_index)<span class="keyword"> const</span>
<a name="l00326"></a>00326 <span class="keyword"></span>{
<a name="l00327"></a>00327   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a5e33c35c79a8adae78e9cdfb0dc9b4e6">strip_byte_counts_valid</a>)
<a name="l00328"></a>00328   <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#ac669914c904ef97ff2fe25ad5da17c2d">strip_byte_counts</a>[strip_index];
<a name="l00329"></a>00329   <span class="keywordflow">return</span> 0;
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="comment">//the theoretical amount needed</span>
<a name="l00333"></a><a class="code" href="classvil__tiff__header.html#a6b03876b43aca8f1b5bee61fcecd6733">00333</a> vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a6b03876b43aca8f1b5bee61fcecd6733">vil_tiff_header::bytes_per_strip</a>()<span class="keyword"> const</span>
<a name="l00334"></a>00334 <span class="keyword"></span>{
<a name="l00335"></a>00335   <span class="keywordflow">return</span> <a class="code" href="classvil__tiff__header.html#ac9918c2e1667c1948cf4960a3afa775c">rows_in_strip</a>()*<a class="code" href="classvil__tiff__header.html#aa5b28835789ced631443325f211d0c65" title="theoretical from samples per line.">bytes_per_line</a>();
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 
<a name="l00338"></a><a class="code" href="classvil__tiff__header.html#a18e5aed0dd97e1d32f692b1538cf40f2">00338</a> vxl_uint_32 <a class="code" href="classvil__tiff__header.html#a18e5aed0dd97e1d32f692b1538cf40f2">vil_tiff_header::bytes_per_tile</a>()<span class="keyword"> const</span>
<a name="l00339"></a>00339 <span class="keyword"></span>{
<a name="l00340"></a>00340   <span class="keywordflow">return</span> TIFFTileSize(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>);
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 <span class="comment">//The number of images in the tiff file</span>
<a name="l00344"></a><a class="code" href="classvil__tiff__header.html#a9752fc1c91654e1497776bb52711176e">00344</a> vxl_uint_16  <a class="code" href="classvil__tiff__header.html#a9752fc1c91654e1497776bb52711176e" title="the number of images in the file.">vil_tiff_header::n_images</a>()
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346   <span class="keywordflow">return</span> TIFFNumberOfDirectories(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>);
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 <span class="comment">//assemble the information to define the vil_pixel_format</span>
<a name="l00350"></a>00350 <span class="comment">//return false if the format cannot be handled</span>
<a name="l00351"></a><a class="code" href="classvil__tiff__header.html#a2cc20df664f1acb4423f99688542957a">00351</a> <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a2cc20df664f1acb4423f99688542957a" title="returns false if the format not handled by this reader.">vil_tiff_header::compute_pixel_format</a>()
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353   <span class="comment">//also need sample_format.valid but use default (1) for images that don&#39;t have it</span>
<a name="l00354"></a>00354   <span class="comment">// -GY- use default (1) for images that do not have SamplesPerPixel tag</span>
<a name="l00355"></a>00355   <span class="keywordflow">if</span> (!(<a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>) || <span class="comment">/*!(samples_per_pixel.valid) ||*/</span>
<a name="l00356"></a>00356       !(<a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>) || !<a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>           )
<a name="l00357"></a>00357   {
<a name="l00358"></a>00358     <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00359"></a>00359     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00360"></a>00360   }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362   vxl_uint_16 b = <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>;
<a name="l00363"></a>00363   vxl_uint_16 bbs = <a class="code" href="classvil__tiff__header.html#a2e7737dee5656355b47034b59fd49bc5">bytes_per_sample</a>();
<a name="l00364"></a>00364   <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 1;
<a name="l00365"></a>00365   <span class="comment">//Let&#39;s do the easy case first -- scalar pixels but various types</span>
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>==1)
<a name="l00367"></a>00367   {
<a name="l00368"></a>00368     <span class="comment">//handle sample formats (unsigned, signed, float, double)</span>
<a name="l00369"></a>00369     <span class="keywordflow">switch</span> (<a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>)
<a name="l00370"></a>00370     {
<a name="l00371"></a>00371       <span class="keywordflow">case</span> 2: <span class="comment">//2s complement signed</span>
<a name="l00372"></a>00372         <span class="keywordflow">switch</span> (b)
<a name="l00373"></a>00373         {
<a name="l00374"></a>00374           <span class="keywordflow">case</span> 8:
<a name="l00375"></a>00375             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da20c3ae85fdecfa20b5ecf12f8894efeb">VIL_PIXEL_FORMAT_SBYTE</a>;
<a name="l00376"></a>00376             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00377"></a>00377           <span class="keywordflow">case</span> 16:
<a name="l00378"></a>00378             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800daba50e1cdc6e602c7e314fa82066027a3">VIL_PIXEL_FORMAT_INT_16</a>;
<a name="l00379"></a>00379             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00380"></a>00380           <span class="keywordflow">case</span> 32:
<a name="l00381"></a>00381             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da65f175b4a4049f8457bc8c4f772b9f5d">VIL_PIXEL_FORMAT_INT_32</a>;
<a name="l00382"></a>00382             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00383"></a>00383           <span class="keywordflow">default</span>: <span class="comment">//other bit sizes don&#39;t make sense</span>
<a name="l00384"></a>00384             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00385"></a>00385             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387       <span class="keywordflow">case</span> 3: <span class="comment">// floating point</span>
<a name="l00388"></a>00388         <span class="keywordflow">switch</span> (bbs)
<a name="l00389"></a>00389         {
<a name="l00390"></a>00390           <span class="keywordflow">case</span> (<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)):
<a name="l00391"></a>00391             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da8d2e38094a68770dcad0e6637d5ce3ba">VIL_PIXEL_FORMAT_FLOAT</a>;
<a name="l00392"></a>00392             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00393"></a>00393           <span class="keywordflow">case</span> (<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)):
<a name="l00394"></a>00394             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da57e197d362a17a1777b1ff69ee82e8ec">VIL_PIXEL_FORMAT_DOUBLE</a>;
<a name="l00395"></a>00395             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00396"></a>00396           <span class="keywordflow">default</span>: <span class="comment">//other bit sizes don&#39;t make sense</span>
<a name="l00397"></a>00397             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00398"></a>00398             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00399"></a>00399         }
<a name="l00400"></a>00400       <span class="keywordflow">case</span> 4: <span class="comment">//undefined format</span>
<a name="l00401"></a>00401       <span class="keywordflow">case</span> 1: <span class="comment">//unsigned values</span>
<a name="l00402"></a>00402       <span class="keywordflow">default</span>:
<a name="l00403"></a>00403         <span class="keywordflow">if</span> (b==1){
<a name="l00404"></a>00404           <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da270ef8e69c137b9bed10074d2726ffa9">VIL_PIXEL_FORMAT_BOOL</a>;
<a name="l00405"></a>00405           <span class="keywordflow">return</span> <span class="keyword">true</span>;}
<a name="l00406"></a>00406         <span class="keywordflow">else</span>
<a name="l00407"></a>00407           <span class="keywordflow">switch</span> (bbs)
<a name="l00408"></a>00408           {
<a name="l00409"></a>00409            <span class="keywordflow">case</span> 1:
<a name="l00410"></a>00410             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da7e558fc5ba55dbb9c32658e7960b83f4">VIL_PIXEL_FORMAT_BYTE</a>;
<a name="l00411"></a>00411             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00412"></a>00412            <span class="keywordflow">case</span> 2:
<a name="l00413"></a>00413             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800dabecb5c0033517756dc112ccd18f97073">VIL_PIXEL_FORMAT_UINT_16</a>;
<a name="l00414"></a>00414             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00415"></a>00415            <span class="keywordflow">case</span> 3:
<a name="l00416"></a>00416            <span class="keywordflow">case</span> 4:
<a name="l00417"></a>00417             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da355f2de6abb4cb81d9ca9cfcad7dd0fa">VIL_PIXEL_FORMAT_UINT_32</a>;
<a name="l00418"></a>00418             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00419"></a>00419            <span class="keywordflow">default</span>:
<a name="l00420"></a>00420             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00421"></a>00421             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00422"></a>00422           }
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424   }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <span class="comment">// The next easiest case is palette images</span>
<a name="l00427"></a>00427   <span class="comment">// vil doesn&#39;t currently support color maps so need to convert to</span>
<a name="l00428"></a>00428   <span class="comment">// regular three component RGB image (LATER)</span>
<a name="l00429"></a>00429   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>==1 &amp;&amp; <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>==PHOTOMETRIC_RGB &amp;&amp;
<a name="l00430"></a>00430       <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> == 1) <span class="comment">//only support unsigned</span>
<a name="l00431"></a>00431     <span class="keywordflow">switch</span> (bbs)
<a name="l00432"></a>00432     {
<a name="l00433"></a>00433       <span class="keywordflow">case</span> 1:
<a name="l00434"></a>00434         <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da7e558fc5ba55dbb9c32658e7960b83f4">VIL_PIXEL_FORMAT_BYTE</a>;
<a name="l00435"></a>00435         <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00436"></a>00436         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00437"></a>00437       <span class="keywordflow">case</span> 2:
<a name="l00438"></a>00438         <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800dabecb5c0033517756dc112ccd18f97073">VIL_PIXEL_FORMAT_UINT_16</a>;
<a name="l00439"></a>00439         <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00440"></a>00440         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00441"></a>00441       <span class="keywordflow">default</span>:<span class="comment">//other palette dynamic ranges don&#39;t make sense</span>
<a name="l00442"></a>00442         <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00443"></a>00443         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445   <span class="comment">// Now for regular color images</span>
<a name="l00446"></a>00446   <span class="comment">// handle sample formats (unsigned, signed, float, double)</span>
<a name="l00447"></a>00447   <span class="comment">// vil normally doesn&#39;t directly express these interleaved formats but</span>
<a name="l00448"></a>00448   <span class="comment">// pretends the samples are in different planes.</span>
<a name="l00449"></a>00449   <span class="comment">// The current implementation can&#39;t handle planar_config ==2, which is</span>
<a name="l00450"></a>00450   <span class="comment">// separate color bands.</span>
<a name="l00451"></a>00451   vxl_uint_16 s = <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>;
<a name="l00452"></a>00452   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>&gt;1 &amp;&amp; <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>==2 &amp;&amp; <a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> == 1 )
<a name="l00453"></a>00453   {
<a name="l00454"></a>00454     <span class="keywordflow">switch</span> (<a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>)
<a name="l00455"></a>00455     {
<a name="l00456"></a>00456       <span class="keywordflow">case</span> 1: <span class="comment">//unsigned values</span>
<a name="l00457"></a>00457         <span class="keywordflow">switch</span> (b)
<a name="l00458"></a>00458         {
<a name="l00459"></a>00459           <span class="keywordflow">case</span> 8:
<a name="l00460"></a>00460             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da7e558fc5ba55dbb9c32658e7960b83f4">VIL_PIXEL_FORMAT_BYTE</a>;
<a name="l00461"></a>00461             <span class="keywordflow">switch</span> (s)
<a name="l00462"></a>00462             {
<a name="l00463"></a>00463               <span class="keywordflow">case</span> 3:
<a name="l00464"></a>00464                 <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00465"></a>00465                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00466"></a>00466               <span class="keywordflow">case</span> 4:
<a name="l00467"></a>00467                 <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00468"></a>00468                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00469"></a>00469               <span class="keywordflow">default</span>:
<a name="l00470"></a>00470                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00471"></a>00471                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00472"></a>00472             }
<a name="l00473"></a>00473           <span class="keywordflow">case</span> 16:
<a name="l00474"></a>00474             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800dabecb5c0033517756dc112ccd18f97073">VIL_PIXEL_FORMAT_UINT_16</a>;
<a name="l00475"></a>00475             <span class="keywordflow">switch</span> (s)
<a name="l00476"></a>00476             {
<a name="l00477"></a>00477               <span class="keywordflow">case</span> 3:
<a name="l00478"></a>00478                 <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00479"></a>00479                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00480"></a>00480               <span class="keywordflow">case</span> 4:
<a name="l00481"></a>00481                 <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00482"></a>00482                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00483"></a>00483               <span class="keywordflow">default</span>:
<a name="l00484"></a>00484                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00485"></a>00485                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00486"></a>00486             }
<a name="l00487"></a>00487           <span class="keywordflow">case</span> 32:
<a name="l00488"></a>00488             <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da355f2de6abb4cb81d9ca9cfcad7dd0fa">VIL_PIXEL_FORMAT_UINT_32</a>;
<a name="l00489"></a>00489             <span class="keywordflow">switch</span> (s)
<a name="l00490"></a>00490             {
<a name="l00491"></a>00491               <span class="keywordflow">case</span> 3:
<a name="l00492"></a>00492                 <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00493"></a>00493                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00494"></a>00494               <span class="keywordflow">case</span> 4:
<a name="l00495"></a>00495                 <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00496"></a>00496                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00497"></a>00497               <span class="keywordflow">default</span>:
<a name="l00498"></a>00498                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00499"></a>00499                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00500"></a>00500             }
<a name="l00501"></a>00501           <span class="keywordflow">default</span>: <span class="comment">//other dynamic ranges, e.g. 12 bits/sample</span>
<a name="l00502"></a>00502             <span class="keywordflow">switch</span> (bbs)
<a name="l00503"></a>00503             {
<a name="l00504"></a>00504               <span class="keywordflow">case</span> 1:
<a name="l00505"></a>00505                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800dac22318e7f1a4239660dc210b8ba6dfbc">VIL_PIXEL_FORMAT_RGB_BYTE</a>;
<a name="l00506"></a>00506                 <span class="keywordflow">switch</span> (s)
<a name="l00507"></a>00507                 {
<a name="l00508"></a>00508                   <span class="keywordflow">case</span> 3:
<a name="l00509"></a>00509                     <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00510"></a>00510                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00511"></a>00511                   <span class="keywordflow">case</span> 4:
<a name="l00512"></a>00512                     <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00513"></a>00513                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00514"></a>00514                   <span class="keywordflow">default</span>:
<a name="l00515"></a>00515                     <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00516"></a>00516                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00517"></a>00517                 }
<a name="l00518"></a>00518               <span class="keywordflow">case</span> 2:
<a name="l00519"></a>00519                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800dabecb5c0033517756dc112ccd18f97073">VIL_PIXEL_FORMAT_UINT_16</a>;
<a name="l00520"></a>00520                 <span class="keywordflow">switch</span> (s)
<a name="l00521"></a>00521                 {
<a name="l00522"></a>00522                   <span class="keywordflow">case</span> 3:
<a name="l00523"></a>00523                     <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00524"></a>00524                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00525"></a>00525                   <span class="keywordflow">case</span> 4:
<a name="l00526"></a>00526                     <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00527"></a>00527                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00528"></a>00528                   <span class="keywordflow">default</span>:
<a name="l00529"></a>00529                     <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00530"></a>00530                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00531"></a>00531                 }
<a name="l00532"></a>00532               <span class="keywordflow">case</span> 4:
<a name="l00533"></a>00533                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da355f2de6abb4cb81d9ca9cfcad7dd0fa">VIL_PIXEL_FORMAT_UINT_32</a>;
<a name="l00534"></a>00534                 <span class="keywordflow">switch</span> (s)
<a name="l00535"></a>00535                 {
<a name="l00536"></a>00536                   <span class="keywordflow">case</span> 3:
<a name="l00537"></a>00537                     <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 3;
<a name="l00538"></a>00538                     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00539"></a>00539                   <span class="keywordflow">case</span> 4:
<a name="l00540"></a>00540                     <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = 4;
<a name="l00541"></a>00541                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00542"></a>00542                   <span class="keywordflow">default</span>:
<a name="l00543"></a>00543                     <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00544"></a>00544                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00545"></a>00545                 }
<a name="l00546"></a>00546               <span class="keywordflow">default</span>:
<a name="l00547"></a>00547                 <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00548"></a>00548                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00549"></a>00549             }
<a name="l00550"></a>00550         }
<a name="l00551"></a>00551       <span class="keywordflow">case</span> 2: <span class="comment">//do signed color images make sense?</span>
<a name="l00552"></a>00552         <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00553"></a>00553         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555       <span class="keywordflow">case</span> 3: <span class="comment">// do floating point color images make sense?</span>
<a name="l00556"></a>00556         <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da8d2e38094a68770dcad0e6637d5ce3ba">VIL_PIXEL_FORMAT_FLOAT</a>; <span class="comment">// DEC changed from vil_pixel_format_unknown</span>
<a name="l00557"></a>00557         <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = s; <span class="comment">// DEC</span>
<a name="l00558"></a>00558         <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// DEC changed from false</span>
<a name="l00559"></a>00559       <span class="keywordflow">case</span> 4: <span class="comment">//undefined format</span>
<a name="l00560"></a>00560       <span class="keywordflow">default</span>:
<a name="l00561"></a>00561         <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00562"></a>00562         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564   }
<a name="l00565"></a>00565   <span class="comment">//Separate TIFF transparency mask - not handled</span>
<a name="l00566"></a>00566   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>==PHOTOMETRIC_MASK)
<a name="l00567"></a>00567   {
<a name="l00568"></a>00568     <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00569"></a>00569     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00570"></a>00570   }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   <span class="comment">//TIFF color separations - not handled</span>
<a name="l00573"></a>00573   <span class="keywordflow">if</span> (<a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a>==PHOTOMETRIC_SEPARATED)
<a name="l00574"></a>00574   {
<a name="l00575"></a>00575     <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00576"></a>00576     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00577"></a>00577   }
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da763ec54acd5a8d28519252c706986209">VIL_PIXEL_FORMAT_UNKNOWN</a>;
<a name="l00580"></a>00580   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00581"></a>00581 }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">//Returns false if the pixel format cannot be written</span>
<a name="l00584"></a><a class="code" href="classvil__tiff__header.html#a1f59d26f5cc3613f9b08a57327d70051">00584</a> <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a1f59d26f5cc3613f9b08a57327d70051" title="returns false if the format not handled by this writer.">vil_tiff_header::parse_pixel_format</a>(<a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <span class="keyword">const</span>&amp; fmt)
<a name="l00585"></a>00585 {
<a name="l00586"></a>00586   <span class="comment">//Check for supported types</span>
<a name="l00587"></a>00587   <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 1; <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00588"></a>00588   <span class="keywordflow">switch</span> ( fmt )
<a name="l00589"></a>00589   {
<a name="l00590"></a>00590     <span class="keywordflow">case</span> <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da270ef8e69c137b9bed10074d2726ffa9">VIL_PIXEL_FORMAT_BOOL</a>:
<a name="l00591"></a>00591       <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 1; <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00592"></a>00592       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00593"></a>00593     <span class="keywordflow">case</span> <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da7e558fc5ba55dbb9c32658e7960b83f4">VIL_PIXEL_FORMAT_BYTE</a>:
<a name="l00594"></a>00594       <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 8; <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00595"></a>00595       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00596"></a>00596     <span class="keywordflow">case</span> <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800dabecb5c0033517756dc112ccd18f97073">VIL_PIXEL_FORMAT_UINT_16</a>:
<a name="l00597"></a>00597       <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 16; <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00598"></a>00598       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00599"></a>00599     <span class="keywordflow">case</span> <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da355f2de6abb4cb81d9ca9cfcad7dd0fa">VIL_PIXEL_FORMAT_UINT_32</a>:
<a name="l00600"></a>00600       <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 32; <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00601"></a>00601       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00602"></a>00602     <span class="keywordflow">case</span> <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da8d2e38094a68770dcad0e6637d5ce3ba">VIL_PIXEL_FORMAT_FLOAT</a>:
<a name="l00603"></a>00603       <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 8*<span class="keyword">sizeof</span>(float); <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00604"></a>00604       <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 3;
<a name="l00605"></a>00605       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00606"></a>00606     <span class="keywordflow">case</span> <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800da57e197d362a17a1777b1ff69ee82e8ec">VIL_PIXEL_FORMAT_DOUBLE</a>:
<a name="l00607"></a>00607       <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 8*<span class="keyword">sizeof</span>(double); <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00608"></a>00608       <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 3;
<a name="l00609"></a>00609       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00610"></a>00610     <span class="keywordflow">default</span>:
<a name="l00611"></a>00611       <span class="keywordflow">break</span>;
<a name="l00612"></a>00612   }
<a name="l00613"></a>00613   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00614"></a>00614 }
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 <span class="comment">//Setup the required header information in preparation for writing to</span>
<a name="l00617"></a>00617 <span class="comment">//the tiff file header</span>
<a name="l00618"></a><a class="code" href="classvil__tiff__header.html#a6c936c90c7da395d098aab22e86fe554">00618</a> <span class="keywordtype">bool</span> <a class="code" href="classvil__tiff__header.html#a6c936c90c7da395d098aab22e86fe554" title="returns false if the format cannot be written by current version.">vil_tiff_header::set_header</a>(<span class="keywordtype">unsigned</span> ni, <span class="keywordtype">unsigned</span> nj, <span class="keywordtype">unsigned</span> nplns,
<a name="l00619"></a>00619                                  <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <span class="keyword">const</span>&amp; fmt,
<a name="l00620"></a>00620                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_i,
<a name="l00621"></a>00621                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_j)
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623   <span class="comment">//also need machine endian</span>
<a name="l00624"></a>00624 <span class="preprocessor">#if VXL_BIG_ENDIAN</span>
<a name="l00625"></a>00625 <span class="preprocessor"></span>    <a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a> = <span class="keyword">true</span>;
<a name="l00626"></a>00626 <span class="preprocessor">#else</span>
<a name="l00627"></a>00627 <span class="preprocessor"></span>    <a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a> = <span class="keyword">false</span>;
<a name="l00628"></a>00628 <span class="preprocessor">#endif</span>
<a name="l00629"></a>00629 <span class="preprocessor"></span>    <span class="comment">//write file with same endian state as the machine</span>
<a name="l00630"></a>00630     <a class="code" href="classvil__tiff__header.html#afed1062f528e35fee5a9389e2ccdf751">file_is_big_endian_</a> = <a class="code" href="classvil__tiff__header.html#a1cd87b06639d008c4ef68ca3dc9fcf1c">machine_is_big_endian_</a>;
<a name="l00631"></a>00631   <a class="code" href="classvil__tiff__header.html#af0fa636e35f1b3eda30fe6054e7e5c90">pix_fmt</a> = fmt;
<a name="l00632"></a>00632   <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classvil__tiff__header.html#a1f59d26f5cc3613f9b08a57327d70051" title="returns false if the format not handled by this writer.">parse_pixel_format</a>(fmt))
<a name="l00633"></a>00633     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00634"></a>00634   <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> = nplns;
<a name="l00635"></a>00635   <span class="comment">//check for color type</span>
<a name="l00636"></a>00636   <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00637"></a>00637   <span class="keywordflow">switch</span> ( <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a> )
<a name="l00638"></a>00638   {
<a name="l00639"></a>00639     <span class="keywordflow">case</span> 1:
<a name="l00640"></a>00640     <span class="keywordflow">case</span> 2:
<a name="l00641"></a>00641       <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 1;
<a name="l00642"></a>00642       <span class="keywordflow">break</span>;
<a name="l00643"></a>00643     <span class="keywordflow">case</span> 3:
<a name="l00644"></a>00644     <span class="keywordflow">case</span> 4:
<a name="l00645"></a>00645       <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 2;
<a name="l00646"></a>00646       <span class="keywordflow">break</span>;
<a name="l00647"></a>00647     <span class="keywordflow">default</span>:
<a name="l00648"></a>00648       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00649"></a>00649   }
<a name="l00650"></a>00650   <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> = nj; <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> = <span class="keyword">true</span>;
<a name="l00651"></a>00651   <a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> = ni; <a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> = <span class="keyword">true</span>;
<a name="l00652"></a>00652   <span class="keywordflow">if</span> (size_block_i&gt;0&amp;&amp;size_block_j&gt;0)
<a name="l00653"></a>00653   {
<a name="l00654"></a>00654     <a class="code" href="classvil__tiff__header.html#a1f0e82f47220affa74870c578a650929">is_tiled_flag</a> = <span class="keyword">true</span>;
<a name="l00655"></a>00655     <a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> = size_block_i; <a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> = <span class="keyword">true</span>;
<a name="l00656"></a>00656     <a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> = size_block_j; <a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> = <span class="keyword">true</span>;
<a name="l00657"></a>00657   }
<a name="l00658"></a>00658   <span class="keywordflow">else</span>
<a name="l00659"></a>00659   {
<a name="l00660"></a>00660     <a class="code" href="classvil__tiff__header.html#a1f0e82f47220affa74870c578a650929">is_tiled_flag</a> = <span class="keyword">false</span>;
<a name="l00661"></a>00661     <span class="comment">//Check for default -- one scanline per row</span>
<a name="l00662"></a>00662     <span class="keywordtype">unsigned</span> n_rows = size_block_j;
<a name="l00663"></a>00663     <span class="keywordflow">if</span> (n_rows == 0)
<a name="l00664"></a>00664       n_rows = 1u;
<a name="l00665"></a>00665     <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a38bc7050346ba5bc797c2bdf33ebbd3a">val</a> = n_rows; <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>.<a class="code" href="structulong__tag.html#a34e63522d64829b928481ff86d6e97ca">valid</a> = <span class="keyword">true</span>;
<a name="l00666"></a>00666   }
<a name="l00667"></a>00667   <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = <a class="code" href="classvil__tiff__header.html#a2b7770f1bc9eae570e3c4ae7d495fb12">nplanes</a>; <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a>=<span class="keyword">true</span>;
<a name="l00668"></a>00668   <span class="comment">// Can&#39;t handle separate color planes</span>
<a name="l00669"></a>00669   <a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = 1; <a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00670"></a>00670   <span class="comment">// The sensible way ..</span>
<a name="l00671"></a>00671   <a class="code" href="classvil__tiff__header.html#ad970c2cd1181397e6e1e2b37d9e5b773">orientation</a>.<a class="code" href="structushort__tag.html#a4dab147b315bc7411362ec02dc3c9baf">val</a> = ORIENTATION_TOPLEFT; <a class="code" href="classvil__tiff__header.html#ad970c2cd1181397e6e1e2b37d9e5b773">orientation</a>.<a class="code" href="structushort__tag.html#ab8415c113cd14ef3d4560204b430369f">valid</a> = <span class="keyword">true</span>;
<a name="l00672"></a>00672   <a class="code" href="classvil__tiff__header.html#a95601005840871acc703999d357417ac">software</a> = <span class="stringliteral">&quot;http://vxl.sourceforge.net/  vil image library&quot;</span>;
<a name="l00673"></a>00673   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <span class="comment">// Constructor - writes the necessary header information to the open tiff file</span>
<a name="l00677"></a>00677 <a class="code" href="classvil__tiff__header.html#acb179c8e5db5681a6b5686c88ea25f3e">vil_tiff_header::</a>
<a name="l00678"></a><a class="code" href="classvil__tiff__header.html#a9d457e67f0a8a09d2b76413ce0a937da">00678</a> <a class="code" href="classvil__tiff__header.html#acb179c8e5db5681a6b5686c88ea25f3e">vil_tiff_header</a>(TIFF* tif, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ni, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nj,
<a name="l00679"></a>00679                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nplanes, <a class="code" href="vil__pixel__format_8h.html#a6f749d91364b0bcb661189f4a154800d" title="Describes the type of the concrete data.">vil_pixel_format</a> <span class="keyword">const</span>&amp; fmt,
<a name="l00680"></a>00680                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_i, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> size_block_j)
<a name="l00681"></a>00681 {
<a name="l00682"></a>00682   <a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a> = tif;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684   <a class="code" href="classvil__tiff__header.html#ae257906aa45a86bd4d22d89d8e6b93eb" title="true if the specified format can be read or written.">format_supported</a> =
<a name="l00685"></a>00685     this-&gt;<a class="code" href="classvil__tiff__header.html#a6c936c90c7da395d098aab22e86fe554" title="returns false if the format cannot be written by current version.">set_header</a>(ni, nj, nplanes, fmt, size_block_i, size_block_j);
<a name="l00686"></a>00686   <span class="keywordflow">if</span> (!<a class="code" href="classvil__tiff__header.html#ae257906aa45a86bd4d22d89d8e6b93eb" title="true if the specified format can be read or written.">format_supported</a>)
<a name="l00687"></a>00687     <span class="keywordflow">return</span>;
<a name="l00688"></a>00688   write_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_PHOTOMETRIC, <a class="code" href="classvil__tiff__header.html#a50c9d35eb4f786c8386a50f2ad84ca38">photometric</a>);
<a name="l00689"></a>00689   write_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_PLANARCONFIG, <a class="code" href="classvil__tiff__header.html#a036dc5c499345b4c5775bd3a8d75c317">planar_config</a>);
<a name="l00690"></a>00690   write_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_SAMPLESPERPIXEL, <a class="code" href="classvil__tiff__header.html#aef6cdafcbfc1f55276a67262ab2e0e3f">samples_per_pixel</a>);
<a name="l00691"></a>00691   write_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_BITSPERSAMPLE, <a class="code" href="classvil__tiff__header.html#a43a07822927313b423dcbe6196e79662">bits_per_sample</a>);
<a name="l00692"></a>00692   write_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_DATETIME, date_and_time());
<a name="l00693"></a>00693   write_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_IMAGELENGTH, <a class="code" href="classvil__tiff__header.html#ad1f9c34171e830a9c507c316991a0f11">image_length</a>);
<a name="l00694"></a>00694   write_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_IMAGEWIDTH, <a class="code" href="classvil__tiff__header.html#ae2fa3ced3823ac89d0606a0446cb508c">image_width</a>);
<a name="l00695"></a>00695   write_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_ORIENTATION, <a class="code" href="classvil__tiff__header.html#ad970c2cd1181397e6e1e2b37d9e5b773">orientation</a>);
<a name="l00696"></a>00696   write_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_ROWSPERSTRIP, <a class="code" href="classvil__tiff__header.html#a7cd9b8c57efe037300f5056c62111456">rows_per_strip</a>);
<a name="l00697"></a>00697   write_string(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_SOFTWARE, <a class="code" href="classvil__tiff__header.html#a95601005840871acc703999d357417ac">software</a>);
<a name="l00698"></a>00698   write_short_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>,TIFFTAG_SAMPLEFORMAT, <a class="code" href="classvil__tiff__header.html#a0981a04c7c930da40eb4470e07bcbabc">sample_format</a>);
<a name="l00699"></a>00699   write_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_TILEWIDTH, <a class="code" href="classvil__tiff__header.html#a2a6aa95bb7a3463a92ca8b9563ce0a28">tile_width</a>);
<a name="l00700"></a>00700   write_long_tag(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_TILELENGTH, <a class="code" href="classvil__tiff__header.html#a00ee32feb69acd7070dbef011c5205e8">tile_length</a>);
<a name="l00701"></a>00701 <span class="preprocessor">#if 1  // Handle Alpha channel, assuming it is the last channel</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (nplanes == 2 || nplanes == 4)
<a name="l00703"></a>00703   {
<a name="l00704"></a>00704     <span class="comment">//extra_samples.val = 1;</span>
<a name="l00705"></a>00705     <span class="comment">//extra_samples.valid = true;</span>
<a name="l00706"></a>00706     vxl_uint_32 num_extra_samples = 1;
<a name="l00707"></a>00707     vxl_uint_16 extra_sample_values[] = { EXTRASAMPLE_ASSOCALPHA<span class="comment">/*1*/</span> };  <span class="comment">// Indicate Associated Alpha Data</span>
<a name="l00708"></a>00708     TIFFSetField(<a class="code" href="classvil__tiff__header.html#a9da9f6c4bb7dc9b6b08aa6a25c119728">tif_</a>, TIFFTAG_EXTRASAMPLES, num_extra_samples, extra_sample_values);
<a name="l00709"></a>00709   }
<a name="l00710"></a>00710 <span class="preprocessor">#endif</span>
<a name="l00711"></a>00711 <span class="preprocessor"></span>  <span class="comment">//initialize other flags to false</span>
<a name="l00712"></a>00712   <a class="code" href="classvil__tiff__header.html#a295adba18b56f7e9f6792bebeb1a6981">color_map_valid</a> = <span class="keyword">false</span>;
<a name="l00713"></a>00713   <a class="code" href="classvil__tiff__header.html#a2bfeea09ae1b581392df064c48a08125">grey_response_curve_valid</a> = <span class="keyword">false</span>;
<a name="l00714"></a>00714   <a class="code" href="classvil__tiff__header.html#a5e33c35c79a8adae78e9cdfb0dc9b4e6">strip_byte_counts_valid</a> = <span class="keyword">false</span>;
<a name="l00715"></a>00715   <a class="code" href="classvil__tiff__header.html#a35b071ead0e71d237a21ca72a81b695c">strip_offsets_valid</a> = <span class="keyword">false</span>;
<a name="l00716"></a>00716   <a class="code" href="classvil__tiff__header.html#adb70a069d4bb8fa1f3a38528c0427a5c">tile_offsets_valid</a> = <span class="keyword">false</span>;
<a name="l00717"></a>00717   <a class="code" href="classvil__tiff__header.html#a1202f26c9c20eb4bb6d8f581362451d3">tile_byte_counts_valid</a> = <span class="keyword">false</span>;
<a name="l00718"></a>00718 }
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:31:47 for core/vil by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
