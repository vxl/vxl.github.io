<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>contrib/gel/vdgl/vdgl_digital_region.cxx Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">contrib/gel/vdgl/vdgl_digital_region.cxx</div>  </div>
</div>
<div class="contents">
<a href="vdgl__digital__region_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is gel/vdgl/vdgl_digital_region.cxx</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;<a class="code" href="vdgl__digital__region_8h.html" title="A representation of the digital interior of a region.">vdgl_digital_region.h</a>&quot;</span>
<a name="l00003"></a>00003 <span class="comment">//:</span>
<a name="l00004"></a>00004 <span class="comment">// \file</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;vcl_cmath.h&gt;</span> <span class="comment">// for fabs and sqrt</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;vcl_cassert.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__svd_8h.html">vnl/algo/vnl_svd.h</a>&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__float__3_8h.html">vnl/vnl_float_3.h</a>&gt;</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#ifndef MAX_ROUNDOFF</span>
<a name="l00012"></a><a class="code" href="vdgl__digital__region_8cxx.html#a88c14b0ad54b7b5aacaedc4578fe7771">00012</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_ROUNDOFF .000025</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a><a class="code" href="vdgl__digital__region_8cxx.html#a50be3f1ac8410f37a73b819bafc57e8a">00015</a> <span class="preprocessor">#define near_zero(a) (vcl_fabs (a) &lt; MAX_ROUNDOFF)</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a><a class="code" href="classvdgl__digital__region.html#af272a1aeb6e6cca84491520d440732ad">00017</a> <a class="codeRef" doxygen="contrib_gel_vsol.tag:../../../../contrib/gel/vsol/html" href="../../../../contrib/gel/vsol/html/classvsol__spatial__object__2d.html">vsol_spatial_object_2d</a>* <a class="code" href="classvdgl__digital__region.html#af272a1aeb6e6cca84491520d440732ad">vdgl_digital_region::clone</a>()<span class="keyword"> const</span>
<a name="l00018"></a>00018 <span class="keyword"></span>{
<a name="l00019"></a>00019   <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classvdgl__digital__region.html#a64bba7ca16c550afb2a206660e14962c">vdgl_digital_region</a>(*<span class="keyword">this</span>);
<a name="l00020"></a>00020 }
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">//-------------------------------------------------------------------------</span>
<a name="l00023"></a>00023 <span class="comment">// Constructors</span>
<a name="l00024"></a>00024 <span class="comment">//</span>
<a name="l00025"></a><a class="code" href="classvdgl__digital__region.html#acd481efde7e85db245edb0249c363c12">00025</a> <a class="code" href="classvdgl__digital__region.html#a64bba7ca16c550afb2a206660e14962c">vdgl_digital_region::vdgl_digital_region</a>(<a class="code" href="classvdgl__digital__region.html">vdgl_digital_region</a> <span class="keyword">const</span>&amp; r)
<a name="l00026"></a>00026   : <a class="codeRef" doxygen="contrib_gel_vsol.tag:../../../../contrib/gel/vsol/html" href="../../../../contrib/gel/vsol/html/classvsol__region__2d.html">vsol_region_2d</a>(r),
<a name="l00027"></a>00027     npts_(0), pixel_size_(1.f), xp_(0), yp_(0), pix_(0),
<a name="l00028"></a>00028     max_(0), min_((unsigned short)(-1)), xo_(0.f), yo_(0.f),
<a name="l00029"></a>00029     io_(0.f), io_stdev_(0.0f), pix_index_(0),
<a name="l00030"></a>00030     fit_valid_(false), scatter_matrix_valid_(false),
<a name="l00031"></a>00031     X2_(0), Y2_(0), I2_(0), XY_(0), XI_(0), YI_(0), error_(0), sigma_sq_(0)
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i&lt;r.<a class="code" href="classvdgl__digital__region.html#a35c62be034e78a05052d81b47b5949c7">Npix</a>(); ++i)
<a name="l00034"></a>00034     this-&gt;<a class="code" href="classvdgl__digital__region.html#ab2f4fb1b8dfe40b91fa83c9a06c0f84c" title="Used to scan through a set of pixels and acquire mean values for coordinates and intensity.">IncrementMeans</a>(r.<a class="code" href="classvdgl__digital__region.html#aec7dea239ce61bda0790608c3dce3162" title="The region pixel coordinates and intensities.">Xj</a>()[i], r.<a class="code" href="classvdgl__digital__region.html#a5b566f7937030febdd809a52ae9fd629">Yj</a>()[i], r.<a class="code" href="classvdgl__digital__region.html#aa273738d4a57d11f67390a69d42f41f1">Ij</a>()[i]);
<a name="l00035"></a>00035   this-&gt;<a class="code" href="classvdgl__digital__region.html#a49264ac951a946bfb9c46f1856ed5bdc" title="Now we have the number of pixels so we can create the storage arrays.">InitPixelArrays</a>();
<a name="l00036"></a>00036   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i&lt;r.<a class="code" href="classvdgl__digital__region.html#a35c62be034e78a05052d81b47b5949c7">Npix</a>(); i++)
<a name="l00037"></a>00037     this-&gt;<a class="code" href="classvdgl__digital__region.html#a038ecbdbcc5a016541e3c0842148e683" title="Insert pixel data into the face arrays.">InsertInPixelArrays</a>(r.<a class="code" href="classvdgl__digital__region.html#aec7dea239ce61bda0790608c3dce3162" title="The region pixel coordinates and intensities.">Xj</a>()[i], r.<a class="code" href="classvdgl__digital__region.html#a5b566f7937030febdd809a52ae9fd629">Yj</a>()[i], r.<a class="code" href="classvdgl__digital__region.html#aa273738d4a57d11f67390a69d42f41f1">Ij</a>()[i]);
<a name="l00038"></a>00038   this-&gt;<a class="code" href="classvdgl__digital__region.html#aeaaf87fca8f92d18a5ab20c01b8222bb" title="Compute the intensity stdev for the region.">ComputeIntensityStdev</a>();
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classvdgl__digital__region.html#a655e55768f71e1506752b2cadad67b1e">00041</a> <a class="code" href="classvdgl__digital__region.html#a64bba7ca16c550afb2a206660e14962c">vdgl_digital_region::vdgl_digital_region</a>(<span class="keywordtype">int</span> npts, <span class="keyword">const</span> <span class="keywordtype">float</span>* xp, <span class="keyword">const</span> <span class="keywordtype">float</span>* yp,
<a name="l00042"></a>00042                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *pix)
<a name="l00043"></a>00043   : <a class="codeRef" doxygen="contrib_gel_vsol.tag:../../../../contrib/gel/vsol/html" href="../../../../contrib/gel/vsol/html/classvsol__region__2d.html">vsol_region_2d</a>(),
<a name="l00044"></a>00044     npts_(0), pixel_size_(1.f), xp_(0), yp_(0), pix_(0),
<a name="l00045"></a>00045     max_(0), min_((unsigned short)(-1)), xo_(0.f), yo_(0.f),
<a name="l00046"></a>00046     io_(0.f), io_stdev_(0.0f), pix_index_(0),
<a name="l00047"></a>00047     fit_valid_(false), scatter_matrix_valid_(false),
<a name="l00048"></a>00048     X2_(0), Y2_(0), I2_(0), XY_(0), XI_(0), YI_(0), error_(0), sigma_sq_(0)
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050   assert(npts &gt; 0);
<a name="l00051"></a>00051   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;npts; i++)
<a name="l00052"></a>00052     this-&gt;<a class="code" href="classvdgl__digital__region.html#ab2f4fb1b8dfe40b91fa83c9a06c0f84c" title="Used to scan through a set of pixels and acquire mean values for coordinates and intensity.">IncrementMeans</a>(xp[i], yp[i], pix[i]);
<a name="l00053"></a>00053   this-&gt;<a class="code" href="classvdgl__digital__region.html#a49264ac951a946bfb9c46f1856ed5bdc" title="Now we have the number of pixels so we can create the storage arrays.">InitPixelArrays</a>();
<a name="l00054"></a>00054   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i&lt;<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>; i++)
<a name="l00055"></a>00055     this-&gt;<a class="code" href="classvdgl__digital__region.html#a038ecbdbcc5a016541e3c0842148e683" title="Insert pixel data into the face arrays.">InsertInPixelArrays</a>(xp[i], yp[i], pix[i]);
<a name="l00056"></a>00056   this-&gt;<a class="code" href="classvdgl__digital__region.html#aeaaf87fca8f92d18a5ab20c01b8222bb" title="Compute the intensity stdev for the region.">ComputeIntensityStdev</a>();
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">//-------------------------------------------------------------------------</span>
<a name="l00060"></a>00060 <span class="comment">//</span>
<a name="l00061"></a>00061 <span class="comment">// Destructor.</span>
<a name="l00062"></a>00062 <span class="comment">//</span>
<a name="l00063"></a><a class="code" href="classvdgl__digital__region.html#a756b98835f0b32cd3139921c2074a94e">00063</a> <a class="code" href="classvdgl__digital__region.html#a756b98835f0b32cd3139921c2074a94e">vdgl_digital_region::~vdgl_digital_region</a>()
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <span class="keyword">delete</span>[] <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>;
<a name="l00066"></a>00066   <span class="keyword">delete</span>[] <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>;
<a name="l00067"></a>00067   <span class="keyword">delete</span>[] <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>;
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">//-------------------------------------------------------</span>
<a name="l00071"></a>00071 <span class="comment">//: The X pixel coordinate</span>
<a name="l00072"></a><a class="code" href="classvdgl__digital__region.html#a39d6fe8a734a237274ab9a3f71c6a019">00072</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#a39d6fe8a734a237274ab9a3f71c6a019" title="The x pixel coordinate.">vdgl_digital_region::X</a>()<span class="keyword"> const</span>
<a name="l00073"></a>00073 <span class="keyword"></span>{
<a name="l00074"></a>00074   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00075"></a>00075     <span class="keywordflow">return</span> 0.0f;
<a name="l00076"></a>00076   <span class="keywordflow">else</span>
<a name="l00077"></a>00077     <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>];
<a name="l00078"></a>00078 }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="comment">//-------------------------------------------------------</span>
<a name="l00081"></a>00081 <span class="comment">//: The Y pixel coordinate</span>
<a name="l00082"></a><a class="code" href="classvdgl__digital__region.html#a20764864de301589f336aa5c1db3bc63">00082</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#a20764864de301589f336aa5c1db3bc63" title="The y pixel coordinate.">vdgl_digital_region::Y</a>()<span class="keyword"> const</span>
<a name="l00083"></a>00083 <span class="keyword"></span>{
<a name="l00084"></a>00084   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00085"></a>00085     <span class="keywordflow">return</span> 0.0f;
<a name="l00086"></a>00086   <span class="keywordflow">else</span>
<a name="l00087"></a>00087     <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>];
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">//-------------------------------------------------------</span>
<a name="l00091"></a>00091 <span class="comment">//: The pixel Intensity</span>
<a name="l00092"></a><a class="code" href="classvdgl__digital__region.html#a99f5c33aacd63f94c23b103ac752ecd7">00092</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="classvdgl__digital__region.html#a99f5c33aacd63f94c23b103ac752ecd7" title="The pixel intensity.">vdgl_digital_region::I</a>()<span class="keyword"> const</span>
<a name="l00093"></a>00093 <span class="keyword"></span>{
<a name="l00094"></a>00094   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00095"></a>00095     <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)0;
<a name="l00096"></a>00096   <span class="keywordflow">else</span>
<a name="l00097"></a>00097     <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>];
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">//-------------------------------------------------------</span>
<a name="l00101"></a>00101 <span class="comment">//: Modify the X pixel coordinate</span>
<a name="l00102"></a><a class="code" href="classvdgl__digital__region.html#a6255b4bcc656a82e6771e0aa2873958d">00102</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a6255b4bcc656a82e6771e0aa2873958d" title="change x pixel coordinate">vdgl_digital_region::set_X</a>(<span class="keywordtype">float</span> x)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00105"></a>00105     <span class="keywordflow">return</span>;
<a name="l00106"></a>00106   <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>]=x;
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">//-------------------------------------------------------</span>
<a name="l00110"></a>00110 <span class="comment">//: Modify the Y pixel coordinate</span>
<a name="l00111"></a><a class="code" href="classvdgl__digital__region.html#a43486f7f78070ff4ba0234a06492b78e">00111</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a43486f7f78070ff4ba0234a06492b78e" title="change y pixel coordinate">vdgl_digital_region::set_Y</a>(<span class="keywordtype">float</span> y)
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00114"></a>00114     <span class="keywordflow">return</span>;
<a name="l00115"></a>00115   <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>]=y;
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">//-------------------------------------------------------</span>
<a name="l00119"></a>00119 <span class="comment">//: Modify the pixel intensity</span>
<a name="l00120"></a><a class="code" href="classvdgl__digital__region.html#ab147029588d564e7588b4ea76752b9b4">00120</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#ab147029588d564e7588b4ea76752b9b4" title="change pixel intensity">vdgl_digital_region::set_I</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> I)
<a name="l00121"></a>00121 {
<a name="l00122"></a>00122   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00123"></a>00123     <span class="keywordflow">return</span>;
<a name="l00124"></a>00124   <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>]=<a class="code" href="classvdgl__digital__region.html#a99f5c33aacd63f94c23b103ac752ecd7" title="The pixel intensity.">I</a>;
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">//--------------------------------------------------------</span>
<a name="l00128"></a>00128 <span class="comment">//:</span>
<a name="l00129"></a>00129 <span class="comment">//  Initialize the region for accepting a stream of pixels</span>
<a name="l00130"></a>00130 <span class="comment">//  through repeated calls to ::IncrementMeans(..)</span>
<a name="l00131"></a><a class="code" href="classvdgl__digital__region.html#ae4f237a102938b004820c02e1e0b8810">00131</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#ae4f237a102938b004820c02e1e0b8810" title="Initialize the region for accepting a stream of pixels through repeated calls to ::IncrementMeans(..)">vdgl_digital_region::ResetPixelData</a>()
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133   <a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> = 0;
<a name="l00134"></a>00134   <span class="keyword">delete</span> [] <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>; <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a> = NULL;
<a name="l00135"></a>00135   <span class="keyword">delete</span> [] <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>; <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a> = NULL;
<a name="l00136"></a>00136   <span class="keyword">delete</span> [] <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>; <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a> = NULL;
<a name="l00137"></a>00137   <a class="code" href="classvdgl__digital__region.html#afc8c91683c0569ced639896811e78814">xo_</a> = <a class="code" href="classvdgl__digital__region.html#a77284420f237160586a1f5b05e8e9e02">yo_</a> = <a class="code" href="classvdgl__digital__region.html#a5601c0ab8eeb84483531a651b17b9ae0" title="Mean Values.">io_</a> = <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a>=0.0f;
<a name="l00138"></a>00138 }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 <span class="comment">//-----------------------------------------------------------------</span>
<a name="l00141"></a>00141 <span class="comment">//:</span>
<a name="l00142"></a>00142 <span class="comment">//    Used to scan through a set of pixels and acquire mean values</span>
<a name="l00143"></a>00143 <span class="comment">//    for coordinates and intensity.  This approach is necessary to</span>
<a name="l00144"></a>00144 <span class="comment">//    accumulate scatter matrices which have zero mean. One scans</span>
<a name="l00145"></a>00145 <span class="comment">//    the region pixels twice. First to get the means and number of</span>
<a name="l00146"></a>00146 <span class="comment">//    region pixels and then to insert the pixel data into fixed arrays</span>
<a name="l00147"></a><a class="code" href="classvdgl__digital__region.html#ab2f4fb1b8dfe40b91fa83c9a06c0f84c">00147</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#ab2f4fb1b8dfe40b91fa83c9a06c0f84c" title="Used to scan through a set of pixels and acquire mean values for coordinates and intensity.">vdgl_digital_region::IncrementMeans</a>(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y,
<a name="l00148"></a>00148                                          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pix)
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150   ++<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00151"></a>00151   <a class="code" href="classvdgl__digital__region.html#afc8c91683c0569ced639896811e78814">xo_</a> += x;
<a name="l00152"></a>00152   <a class="code" href="classvdgl__digital__region.html#a77284420f237160586a1f5b05e8e9e02">yo_</a> += y;
<a name="l00153"></a>00153   <a class="code" href="classvdgl__digital__region.html#a5601c0ab8eeb84483531a651b17b9ae0" title="Mean Values.">io_</a> += pix;
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 <span class="comment">//-----------------------------------------------------------------</span>
<a name="l00157"></a>00157 <span class="comment">//:</span>
<a name="l00158"></a>00158 <span class="comment">// Calculate the standard deviation of intensity for the region.</span>
<a name="l00159"></a>00159 <span class="comment">//</span>
<a name="l00160"></a><a class="code" href="classvdgl__digital__region.html#aeaaf87fca8f92d18a5ab20c01b8222bb">00160</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#aeaaf87fca8f92d18a5ab20c01b8222bb" title="Compute the intensity stdev for the region.">vdgl_digital_region::ComputeIntensityStdev</a>()
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162   <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a> = 0.0f; <span class="comment">// start from scratch each time</span>
<a name="l00163"></a>00163   <span class="keywordtype">float</span> <a class="codeRef" doxygen="core_vbl.tag:../../../../core/vbl/html" href="../../../../core/vbl/html/vbl__attributes_8h.html#aff40d56ffd24a93c2217fa86ef856927">mean</a> = this-&gt;<a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017" title="The mean intensity value of the region.">Io</a>(); <span class="comment">// get the mean.</span>
<a name="l00164"></a>00164   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>; i++) {
<a name="l00165"></a>00165     <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a> += (<a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>[i]-mean)*(<a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>[i]-mean);
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167   <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a> = <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a> * 1.0f/(npts_ - 1.0f);
<a name="l00168"></a>00168   <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a> = vcl_sqrt(<a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a>);
<a name="l00169"></a>00169   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a>;
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 <span class="comment">//-----------------------------------------------------------------</span>
<a name="l00173"></a>00173 <span class="comment">//:</span>
<a name="l00174"></a>00174 <span class="comment">// Now we have the number of pixels so we can create the storage arrays.</span>
<a name="l00175"></a><a class="code" href="classvdgl__digital__region.html#a49264ac951a946bfb9c46f1856ed5bdc">00175</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a49264ac951a946bfb9c46f1856ed5bdc" title="Now we have the number of pixels so we can create the storage arrays.">vdgl_digital_region::InitPixelArrays</a>()
<a name="l00176"></a>00176 {
<a name="l00177"></a>00177   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt; 0);
<a name="l00178"></a>00178   <span class="keyword">delete</span> [] <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>;  <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>];
<a name="l00179"></a>00179   <span class="keyword">delete</span> [] <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>;  <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>];
<a name="l00180"></a>00180   <span class="keyword">delete</span> [] <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>; <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a> = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>[<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>];
<a name="l00181"></a>00181   <a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a> = 0;
<a name="l00182"></a>00182   <a class="code" href="classvdgl__digital__region.html#a1c476b192f74b6aaf1bff1206a358177" title="Upper and lower bounds.">min_</a> = (<span class="keywordtype">unsigned</span> short)(-1);
<a name="l00183"></a>00183   <a class="code" href="classvdgl__digital__region.html#abc902f2b7d9183ac190aaf7c63899389">max_</a> = 0;
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment">//------------------------------------------------------------------------</span>
<a name="l00187"></a>00187 <span class="comment">//: Insert pixel data into the face arrays.</span>
<a name="l00188"></a><a class="code" href="classvdgl__digital__region.html#a038ecbdbcc5a016541e3c0842148e683">00188</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a038ecbdbcc5a016541e3c0842148e683" title="Insert pixel data into the face arrays.">vdgl_digital_region::InsertInPixelArrays</a>(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y,
<a name="l00189"></a>00189                                               <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pix)
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt; 0);
<a name="l00192"></a>00192   <span class="keywordflow">if</span> (pix_index_&lt;0||pix_index_&gt;(<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>) <span class="keywordflow">return</span>;
<a name="l00193"></a>00193   <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>] = x; <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>] = y;
<a name="l00194"></a>00194   <a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>[<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>] = pix;
<a name="l00195"></a>00195   <span class="keywordflow">if</span> (pix&lt;<a class="code" href="classvdgl__digital__region.html#a1c476b192f74b6aaf1bff1206a358177" title="Upper and lower bounds.">min_</a>) <a class="code" href="classvdgl__digital__region.html#a1c476b192f74b6aaf1bff1206a358177" title="Upper and lower bounds.">min_</a> = pix;
<a name="l00196"></a>00196   <span class="keywordflow">if</span> (pix&gt;<a class="code" href="classvdgl__digital__region.html#abc902f2b7d9183ac190aaf7c63899389">max_</a>) <a class="code" href="classvdgl__digital__region.html#abc902f2b7d9183ac190aaf7c63899389">max_</a> = pix;
<a name="l00197"></a>00197   ++<a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>;
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="classvdgl__digital__region.html#ad37cac5eca979c9f044ce69d47fe2b43">00200</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#ad37cac5eca979c9f044ce69d47fe2b43" title="The mean X value of the region.">vdgl_digital_region::Xo</a>()<span class="keyword"> const</span>
<a name="l00201"></a>00201 <span class="keyword"></span>{
<a name="l00202"></a>00202   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt; 0);
<a name="l00203"></a>00203   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#afc8c91683c0569ced639896811e78814">xo_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00204"></a>00204 }
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="classvdgl__digital__region.html#a3b99d42fad1d6b780c5f7955cf4e992d">00206</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#a3b99d42fad1d6b780c5f7955cf4e992d" title="The mean Y value of the region.">vdgl_digital_region::Yo</a>()<span class="keyword"> const</span>
<a name="l00207"></a>00207 <span class="keyword"></span>{
<a name="l00208"></a>00208   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt; 0);
<a name="l00209"></a>00209   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a77284420f237160586a1f5b05e8e9e02">yo_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017">00212</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017" title="The mean intensity value of the region.">vdgl_digital_region::Io</a>()<span class="keyword"> const</span>
<a name="l00213"></a>00213 <span class="keyword"></span>{
<a name="l00214"></a>00214   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt; 0);
<a name="l00215"></a>00215   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a5601c0ab8eeb84483531a651b17b9ae0" title="Mean Values.">io_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classvdgl__digital__region.html#a8c1cc39573dd67da1c874f35d458e5c4">00218</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#a8c1cc39573dd67da1c874f35d458e5c4" title="The intensity standard deviation value of the region.">vdgl_digital_region::Io_sd</a>()<span class="keyword"> const</span>
<a name="l00219"></a>00219 <span class="keyword"></span>{
<a name="l00220"></a>00220   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt; 0);
<a name="l00221"></a>00221   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a730417313425016ee2b71baa121d7706" title="Intensity standard deviation for region.">io_stdev_</a>;
<a name="l00222"></a>00222 }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="comment">//: Individual scatter matrix elements</span>
<a name="l00225"></a><a class="code" href="classvdgl__digital__region.html#a4529ac90c929be7b372f291cfe1dcd30">00225</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#a4529ac90c929be7b372f291cfe1dcd30" title="The second order X moment of the region.">vdgl_digital_region::X2</a>()<span class="keyword"> const</span>
<a name="l00226"></a>00226 <span class="keyword"></span>{
<a name="l00227"></a>00227   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00228"></a>00228     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00229"></a>00229   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a5e7e5f711a6eed364a7ae1084bf9876a" title="The sums of various monomials to form the scatter matrix.">X2_</a>;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="classvdgl__digital__region.html#ace64726235e5ff29be32fe509b1b05d7">00232</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#ace64726235e5ff29be32fe509b1b05d7" title="The second order Y moment of the region.">vdgl_digital_region::Y2</a>()<span class="keyword"> const</span>
<a name="l00233"></a>00233 <span class="keyword"></span>{
<a name="l00234"></a>00234   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00235"></a>00235     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00236"></a>00236   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a3fa11fc5bb2042c507058ef8abd0a46c">Y2_</a>;
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a><a class="code" href="classvdgl__digital__region.html#ad6e46c6ff70bf090ae7129486f5c3ab8">00239</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#ad6e46c6ff70bf090ae7129486f5c3ab8" title="The second order X,Y moment of the region.">vdgl_digital_region::XY</a>()<span class="keyword"> const</span>
<a name="l00240"></a>00240 <span class="keyword"></span>{
<a name="l00241"></a>00241   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00242"></a>00242     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00243"></a>00243   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a0248971d10e52152f43d8d94058aff59">XY_</a>;
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="classvdgl__digital__region.html#a15f8c6c892bc4916784ea0308867cefd">00246</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#a15f8c6c892bc4916784ea0308867cefd" title="The second order intensity moment of the region.">vdgl_digital_region::I2</a>()<span class="keyword"> const</span>
<a name="l00247"></a>00247 <span class="keyword"></span>{
<a name="l00248"></a>00248   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00249"></a>00249     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00250"></a>00250   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a3ccc836ec1b00451b7ec0c7932ed1601">I2_</a>;
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a><a class="code" href="classvdgl__digital__region.html#ac7c77494ba58491b9aa6fb30e31686b0">00253</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#ac7c77494ba58491b9aa6fb30e31686b0" title="The second order X,intensity moment of the region.">vdgl_digital_region::XI</a>()<span class="keyword"> const</span>
<a name="l00254"></a>00254 <span class="keyword"></span>{
<a name="l00255"></a>00255   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00256"></a>00256     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00257"></a>00257   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a60552ac70a598eb70491cab86e2d60d6">XI_</a>;
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="classvdgl__digital__region.html#a1861836768c8fae41421789bb5f45480">00260</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#a1861836768c8fae41421789bb5f45480" title="The second order Y,intensity moment of the region.">vdgl_digital_region::YI</a>()<span class="keyword"> const</span>
<a name="l00261"></a>00261 <span class="keyword"></span>{
<a name="l00262"></a>00262   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00263"></a>00263     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00264"></a>00264   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#ad96675d817c2536c343d6c3f51ffed29">YI_</a>;
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">//------------------------------------------------------------</span>
<a name="l00268"></a>00268 <span class="comment">//: Compute the diameter from the scatter matrix</span>
<a name="l00269"></a><a class="code" href="classvdgl__digital__region.html#a9f74fe678dd0f1cc8082bbfcc3f0966b">00269</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#a9f74fe678dd0f1cc8082bbfcc3f0966b" title="Compute the diameter from the scatter matrix.">vdgl_digital_region::Diameter</a>()<span class="keyword"> const</span>
<a name="l00270"></a>00270 <span class="keyword"></span>{
<a name="l00271"></a>00271   <span class="comment">// make sure the scatter matrix is valid</span>
<a name="l00272"></a>00272   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00273"></a>00273     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00274"></a>00274   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvdgl__digital__region.html#a35c62be034e78a05052d81b47b5949c7">Npix</a>() &lt; 4)
<a name="l00275"></a>00275     <span class="keywordflow">return</span> 1.0f;
<a name="l00276"></a>00276   <span class="comment">// construct the lower right 2x2 matrix of S, s.</span>
<a name="l00277"></a>00277   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a> s(2, 2, 0.0);
<a name="l00278"></a>00278   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r&lt;=2; r++)
<a name="l00279"></a>00279     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 1; c&lt;=2; c++)
<a name="l00280"></a>00280       s(r-1,c-1) = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(r,c);
<a name="l00281"></a>00281   <span class="comment">//Compute SVD of s to get diameter</span>
<a name="l00282"></a>00282   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html">vnl_svd&lt;double&gt;</a> svd(s);
<a name="l00283"></a>00283   <span class="keywordflow">if</span> (svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a8bd7961063ebeda214bfb7fad8e63c3c">rank</a>()!=2)
<a name="l00284"></a>00284     <span class="keywordflow">return</span> <span class="keywordtype">float</span>(vcl_sqrt(this-&gt;<a class="code" href="classvdgl__digital__region.html#acb0e3b5e0793905eb90eda78e71ebd22">area</a>()));
<a name="l00285"></a>00285   <span class="comment">//The factor of two is to estimate the extreme limit of the distribution</span>
<a name="l00286"></a>00286   <span class="keywordtype">double</span> radius = 2*vcl_sqrt(vcl_fabs(svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a3b3197be0858ae3315117e6d49cfa4ff">W</a>(0))+ vcl_fabs(svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a3b3197be0858ae3315117e6d49cfa4ff">W</a>(1)));
<a name="l00287"></a>00287   <span class="keywordflow">return</span> float(2*radius);<span class="comment">//diameter</span>
<a name="l00288"></a>00288 }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <span class="comment">//------------------------------------------------------------</span>
<a name="l00291"></a>00291 <span class="comment">//: Compute the aspect ratio from the scatter matrix</span>
<a name="l00292"></a><a class="code" href="classvdgl__digital__region.html#a162bfa19708c51fa8a7388e747f69dc0">00292</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#a162bfa19708c51fa8a7388e747f69dc0" title="Compute the aspect ratio from the scatter matrix.">vdgl_digital_region::AspectRatio</a>()<span class="keyword"> const</span>
<a name="l00293"></a>00293 <span class="keyword"></span>{
<a name="l00294"></a>00294   <span class="comment">// make sure the scatter matrix is valid</span>
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00296"></a>00296     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00297"></a>00297   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvdgl__digital__region.html#a35c62be034e78a05052d81b47b5949c7">Npix</a>() &lt; 4)
<a name="l00298"></a>00298     <span class="keywordflow">return</span> 1.0f;
<a name="l00299"></a>00299   <span class="comment">// construct the lower right 2x2 matrix of S, s.</span>
<a name="l00300"></a>00300   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a> s(2, 2, 0.0);
<a name="l00301"></a>00301   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r&lt;=2; r++)
<a name="l00302"></a>00302     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 1; c&lt;=2; c++)
<a name="l00303"></a>00303       s(r-1,c-1) = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(r,c);
<a name="l00304"></a>00304   <span class="comment">//Compute SVD of s to get aspect ratio</span>
<a name="l00305"></a>00305   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html">vnl_svd&lt;double&gt;</a> svd(s);
<a name="l00306"></a>00306   <span class="keywordflow">if</span> (svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a8bd7961063ebeda214bfb7fad8e63c3c">rank</a>()!=2)
<a name="l00307"></a>00307     <span class="keywordflow">return</span> 1.0f;
<a name="l00308"></a>00308   <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)vcl_sqrt(svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a3b3197be0858ae3315117e6d49cfa4ff">W</a>(0)/svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a3b3197be0858ae3315117e6d49cfa4ff">W</a>(1));
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">//------------------------------------------------------------</span>
<a name="l00312"></a>00312 <span class="comment">//: Compute the principal orientation of the region.</span>
<a name="l00313"></a>00313 <span class="comment">//   major_axis is a 2-d vector representing the orientation.</span>
<a name="l00314"></a><a class="code" href="classvdgl__digital__region.html#a5dcfdb926fdcdcc9a88795d51953be15">00314</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a5dcfdb926fdcdcc9a88795d51953be15" title="Compute the principal orientation of the region.">vdgl_digital_region::PrincipalOrientation</a>(vnl_float_2&amp; major_axis)
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316   <span class="comment">// make sure the scatter matrix is valid</span>
<a name="l00317"></a>00317   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00318"></a>00318     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00319"></a>00319   <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classvdgl__digital__region.html#a35c62be034e78a05052d81b47b5949c7">Npix</a>() &lt; 4)
<a name="l00320"></a>00320   {
<a name="l00321"></a>00321     vcl_cout &lt;&lt; <span class="stringliteral">&quot;In vdgl_digital_region::PrincipalOrientation(..) Npts&lt;4\n&quot;</span>;
<a name="l00322"></a>00322     major_axis[0]=1.0; major_axis[1]=0.0;
<a name="l00323"></a>00323     <span class="keywordflow">return</span>;
<a name="l00324"></a>00324   }
<a name="l00325"></a>00325   <span class="comment">// construct the lower right 2x2 matrix of S, s.</span>
<a name="l00326"></a>00326   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a> s(2, 2, 0.0);
<a name="l00327"></a>00327   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 1; r&lt;=2; r++)
<a name="l00328"></a>00328     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 1; c&lt;=2; c++)
<a name="l00329"></a>00329       s(r-1,c-1) = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(r,c);
<a name="l00330"></a>00330   <span class="comment">//Compute SVD of s to get aspect ratio</span>
<a name="l00331"></a>00331   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html">vnl_svd&lt;double&gt;</a> svd(s);
<a name="l00332"></a>00332   <span class="keywordflow">if</span> (svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a8bd7961063ebeda214bfb7fad8e63c3c">rank</a>()!=2)
<a name="l00333"></a>00333   {
<a name="l00334"></a>00334     vcl_cout &lt;&lt; <span class="stringliteral">&quot;In vdgl_digital_region::PrincipalOrientation(..) Insufficient rank\n&quot;</span>;
<a name="l00335"></a>00335     major_axis[0]=1.0; major_axis[1]=0.0;
<a name="l00336"></a>00336     <span class="keywordflow">return</span>;
<a name="l00337"></a>00337   }
<a name="l00338"></a>00338   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/vgl__vector__2d_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a> = svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#ac5495ca5d9689cbcbb147b5e63e8ee6a">V</a>();
<a name="l00339"></a>00339   <span class="comment">//2 sigma gives a good estimate of axis length (sigma = principal eigenvalue)</span>
<a name="l00340"></a>00340   <span class="keywordtype">double</span> radius = 2*vcl_sqrt(vcl_fabs(svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#a3b3197be0858ae3315117e6d49cfa4ff">W</a>(0)));
<a name="l00341"></a>00341   major_axis[0]=float(v(0,0)*radius);
<a name="l00342"></a>00342   major_axis[1]=float(v(1,0)*radius);
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="classvdgl__digital__region.html#a2ef32961f635a9ca51d7c1da78fb1b88">00345</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#a2ef32961f635a9ca51d7c1da78fb1b88" title="First derivative of intensity wrt x.">vdgl_digital_region::Ix</a>()<span class="keyword"> const</span>
<a name="l00346"></a>00346 <span class="keyword"></span>{
<a name="l00347"></a>00347   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>)
<a name="l00348"></a>00348     this-&gt;<a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">DoPlaneFit</a>();
<a name="l00349"></a>00349   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a>;
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 
<a name="l00352"></a><a class="code" href="classvdgl__digital__region.html#aa57a33548b030a9da42d175be7abb35f">00352</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#aa57a33548b030a9da42d175be7abb35f" title="First derivative of intensity wrt y.">vdgl_digital_region::Iy</a>()<span class="keyword"> const</span>
<a name="l00353"></a>00353 <span class="keyword"></span>{
<a name="l00354"></a>00354   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>)
<a name="l00355"></a>00355     this-&gt;<a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">DoPlaneFit</a>();
<a name="l00356"></a>00356   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a>;
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 <span class="comment">//--------------------------------------------------------------</span>
<a name="l00361"></a>00361 <span class="comment">//: Update the scatter matrix elements.</span>
<a name="l00362"></a>00362 <span class="comment">// The means are subtracted from the input values before incrementing.</span>
<a name="l00363"></a>00363 <span class="comment">// Thus the scatter matrix is formed with a coordinate system at the origin.</span>
<a name="l00364"></a><a class="code" href="classvdgl__digital__region.html#ad0ad10ca453ff12a6804aae524e6dfdd">00364</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#ad0ad10ca453ff12a6804aae524e6dfdd" title="Update the scatter matrix elements.">vdgl_digital_region::IncrByXYI</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">int</span> intens)<span class="keyword"> const</span>
<a name="l00365"></a>00365 <span class="keyword"></span>{
<a name="l00366"></a>00366   <a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>=<span class="keyword">false</span>;
<a name="l00367"></a>00367   <a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>=<span class="keyword">false</span>;
<a name="l00368"></a>00368   <span class="keywordtype">double</span> dbx = x - this-&gt;<a class="code" href="classvdgl__digital__region.html#ad37cac5eca979c9f044ce69d47fe2b43" title="The mean X value of the region.">Xo</a>(), dby = y - this-&gt;<a class="code" href="classvdgl__digital__region.html#a3b99d42fad1d6b780c5f7955cf4e992d" title="The mean Y value of the region.">Yo</a>();
<a name="l00369"></a>00369   <span class="keywordtype">double</span> dint = (double)intens- this-&gt;<a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017" title="The mean intensity value of the region.">Io</a>();
<a name="l00370"></a>00370   <a class="code" href="classvdgl__digital__region.html#a5e7e5f711a6eed364a7ae1084bf9876a" title="The sums of various monomials to form the scatter matrix.">X2_</a> += dbx*dbx;  <a class="code" href="classvdgl__digital__region.html#a3fa11fc5bb2042c507058ef8abd0a46c">Y2_</a> += dby*dby;  <a class="code" href="classvdgl__digital__region.html#a3ccc836ec1b00451b7ec0c7932ed1601">I2_</a> += dint*dint;
<a name="l00371"></a>00371   <a class="code" href="classvdgl__digital__region.html#a0248971d10e52152f43d8d94058aff59">XY_</a> += dbx*dby;  <a class="code" href="classvdgl__digital__region.html#a60552ac70a598eb70491cab86e2d60d6">XI_</a> += dbx*dint;  <a class="code" href="classvdgl__digital__region.html#ad96675d817c2536c343d6c3f51ffed29">YI_</a> += dby*dint;
<a name="l00372"></a>00372 }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374 <span class="comment">//-------------------------------------------</span>
<a name="l00375"></a>00375 <span class="comment">//: The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means.</span>
<a name="l00376"></a><a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f">00376</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">vdgl_digital_region::ComputeScatterMatrix</a>()<span class="keyword"> const</span>
<a name="l00377"></a>00377 <span class="keyword"></span>{
<a name="l00378"></a>00378   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00379"></a>00379   {
<a name="l00380"></a>00380     vcl_cout &lt;&lt; <span class="stringliteral">&quot;In vdgl_digital_region::ComputeScatterMatrix() - no pixels\n&quot;</span>;
<a name="l00381"></a>00381     <span class="keywordflow">return</span>;
<a name="l00382"></a>00382   }
<a name="l00383"></a>00383   <a class="code" href="classvdgl__digital__region.html#a5e7e5f711a6eed364a7ae1084bf9876a" title="The sums of various monomials to form the scatter matrix.">X2_</a> = 0;  <a class="code" href="classvdgl__digital__region.html#a3fa11fc5bb2042c507058ef8abd0a46c">Y2_</a> = 0;  <a class="code" href="classvdgl__digital__region.html#a3ccc836ec1b00451b7ec0c7932ed1601">I2_</a> = 0;
<a name="l00384"></a>00384   <a class="code" href="classvdgl__digital__region.html#a0248971d10e52152f43d8d94058aff59">XY_</a> = 0;  <a class="code" href="classvdgl__digital__region.html#a60552ac70a598eb70491cab86e2d60d6">XI_</a> = 0;  <a class="code" href="classvdgl__digital__region.html#ad96675d817c2536c343d6c3f51ffed29">YI_</a> = 0;
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <span class="keywordflow">for</span> (this-&gt;<a class="code" href="classvdgl__digital__region.html#a5e4a3a28ef6b1d83ec95f19237d3efa8" title="reset the iterator for accessing region pixels.">reset</a>(); this-&gt;<a class="code" href="classvdgl__digital__region.html#a4be64e2c6292372f16711ca919d3fcbe" title="increment to next pixel and check if iterator is finished.">next</a>();)
<a name="l00387"></a>00387     this-&gt;<a class="code" href="classvdgl__digital__region.html#ad0ad10ca453ff12a6804aae524e6dfdd" title="Update the scatter matrix elements.">IncrByXYI</a>(this-&gt;<a class="code" href="classvdgl__digital__region.html#a39d6fe8a734a237274ab9a3f71c6a019" title="The x pixel coordinate.">X</a>(), this-&gt;<a class="code" href="classvdgl__digital__region.html#a20764864de301589f336aa5c1db3bc63" title="The y pixel coordinate.">Y</a>(), this-&gt;<a class="code" href="classvdgl__digital__region.html#a99f5c33aacd63f94c23b103ac752ecd7" title="The pixel intensity.">I</a>());
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 
<a name="l00390"></a>00390   <span class="comment">//The Scatter Matrix</span>
<a name="l00391"></a>00391   <span class="comment">//</span>
<a name="l00392"></a>00392   <span class="comment">//   -             -</span>
<a name="l00393"></a>00393   <span class="comment">//  | I^2  XI   YI  |</span>
<a name="l00394"></a>00394   <span class="comment">//  |               |</span>
<a name="l00395"></a>00395   <span class="comment">//  | XI   X^2  XY  |</span>
<a name="l00396"></a>00396   <span class="comment">//  |               |</span>
<a name="l00397"></a>00397   <span class="comment">//  | YI   XY   Y^2 |</span>
<a name="l00398"></a>00398   <span class="comment">//   -             -</span>
<a name="l00399"></a>00399   <span class="comment">//</span>
<a name="l00400"></a>00400   <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,0) = <a class="code" href="classvdgl__digital__region.html#a3ccc836ec1b00451b7ec0c7932ed1601">I2_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00401"></a>00401   <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,0) = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,1) = <a class="code" href="classvdgl__digital__region.html#a60552ac70a598eb70491cab86e2d60d6">XI_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00402"></a>00402   <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,0) = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,2) = <a class="code" href="classvdgl__digital__region.html#ad96675d817c2536c343d6c3f51ffed29">YI_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00403"></a>00403   <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,1) = <a class="code" href="classvdgl__digital__region.html#a5e7e5f711a6eed364a7ae1084bf9876a" title="The sums of various monomials to form the scatter matrix.">X2_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00404"></a>00404   <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,1) = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,2) = <a class="code" href="classvdgl__digital__region.html#a0248971d10e52152f43d8d94058aff59">XY_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00405"></a>00405   <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,2) = <a class="code" href="classvdgl__digital__region.html#a3fa11fc5bb2042c507058ef8abd0a46c">Y2_</a>/<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00406"></a>00406   <a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a> = <span class="keyword">true</span>;
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">//---------------------------------------------------------------</span>
<a name="l00410"></a>00410 <span class="comment">//: Computes the squared deviation from the sample mean</span>
<a name="l00411"></a>00411 <span class="comment">//</span>
<a name="l00412"></a><a class="code" href="classvdgl__digital__region.html#a537923208a04643571df01080a97b8b2">00412</a> <span class="keywordtype">double</span> <a class="code" href="classvdgl__digital__region.html#a537923208a04643571df01080a97b8b2" title="Computes the squared deviation from the sample mean.">vdgl_digital_region::ComputeSampleResidual</a>()<span class="keyword"> const</span>
<a name="l00413"></a>00413 <span class="keyword"></span>{
<a name="l00414"></a>00414   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>)
<a name="l00415"></a>00415     this-&gt;<a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">DoPlaneFit</a>();
<a name="l00416"></a>00416   <span class="keywordflow">return</span> <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,0) + <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,1) + <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,2);
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="comment">//: Solve for the fitted plane.</span>
<a name="l00420"></a>00420 <span class="comment">//  Closed form solution in terms of the scatter matrix.</span>
<a name="l00421"></a><a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c">00421</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">vdgl_digital_region::DoPlaneFit</a>()<span class="keyword"> const</span>
<a name="l00422"></a>00422 <span class="keyword"></span>{
<a name="l00423"></a>00423   assert(<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &gt;= 4);
<a name="l00424"></a>00424   <a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a> = <span class="keyword">true</span>;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>)
<a name="l00427"></a>00427     this-&gt;<a class="code" href="classvdgl__digital__region.html#a298b02e76511947d305b0db9783b840f" title="The scatter matrix (upper 3x3) is transformed to the origin by subtracting off the means...">ComputeScatterMatrix</a>();
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <span class="keywordtype">double</span> den = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,1)*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,2)
<a name="l00430"></a>00430              - <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,2)*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,1);
<a name="l00431"></a>00431   <span class="keywordflow">if</span> (<a class="code" href="vdgl__digital__region_8cxx.html#a50be3f1ac8410f37a73b819bafc57e8a">near_zero</a>(den))
<a name="l00432"></a>00432   {
<a name="l00433"></a>00433     vcl_cout &lt;&lt; <span class="stringliteral">&quot;In vdgl_digital_region::SolveForPlane(..) determinant near zero\n&quot;</span>;
<a name="l00434"></a>00434     <a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a> = <a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a> = 0;
<a name="l00435"></a>00435     <a class="code" href="classvdgl__digital__region.html#a478913e7097e1586670536b75627688a">error_</a> = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,0);
<a name="l00436"></a>00436     <a class="code" href="classvdgl__digital__region.html#ae5eb34d5dc2954fa727332370cc0f2e1" title="fitting errors">sigma_sq_</a> = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,0) + <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,1) + <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,2);
<a name="l00437"></a>00437     <span class="keywordflow">return</span>;
<a name="l00438"></a>00438   }
<a name="l00439"></a>00439   <span class="keywordtype">double</span> adet = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,1)*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,2)
<a name="l00440"></a>00440               - <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,2)*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,1);
<a name="l00441"></a>00441   <span class="keywordtype">double</span> bdet = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,2)*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,1)
<a name="l00442"></a>00442               - <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,1)*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,2);
<a name="l00443"></a>00443   <a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a> = adet/den;
<a name="l00444"></a>00444   <a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a> = bdet/den;
<a name="l00445"></a>00445   <a class="code" href="classvdgl__digital__region.html#a478913e7097e1586670536b75627688a">error_</a> = <a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,0) - 2*<a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a>*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,1) - 2*<a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a>*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(0,2)
<a name="l00446"></a>00446          + <a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a>*<a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a>*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,1) + 2*<a class="code" href="classvdgl__digital__region.html#a96cf52802d02538120192d7f9980cc82" title="dI/dx">Ix_</a>*<a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a>*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(1,2) + <a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a>*<a class="code" href="classvdgl__digital__region.html#ae6083890e4c48ae664c345919c73510e" title="dI/dy">Iy_</a>*<a class="code" href="classvdgl__digital__region.html#adad88e08b6bf1effb17a57117d37b9cd" title="scatter matrix">Si_</a>(2,2);
<a name="l00447"></a>00447   <a class="code" href="classvdgl__digital__region.html#ae5eb34d5dc2954fa727332370cc0f2e1" title="fitting errors">sigma_sq_</a> =  this-&gt;<a class="code" href="classvdgl__digital__region.html#a537923208a04643571df01080a97b8b2" title="Computes the squared deviation from the sample mean.">ComputeSampleResidual</a>();
<a name="l00448"></a>00448 }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 
<a name="l00451"></a><a class="code" href="classvdgl__digital__region.html#a7e45d07da028d9765e1944038613fa9e">00451</a> <span class="keywordtype">void</span> <a class="code" href="classvdgl__digital__region.html#a7e45d07da028d9765e1944038613fa9e">vdgl_digital_region::PrintFit</a>()<span class="keyword"> const</span>
<a name="l00452"></a>00452 <span class="keyword"></span>{
<a name="l00453"></a>00453   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>)
<a name="l00454"></a>00454     this-&gt;<a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">DoPlaneFit</a>();
<a name="l00455"></a>00455   vcl_cout &lt;&lt; <span class="stringliteral">&quot;IntensityFit(In Plane Coordinates): &quot;</span>
<a name="l00456"></a>00456            &lt;&lt; <span class="stringliteral">&quot;Number of Points =&quot;</span> &lt;&lt;  <a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> &lt;&lt; vcl_endl
<a name="l00457"></a>00457            &lt;&lt; <span class="stringliteral">&quot;Scatter Matrix:\n&quot;</span>
<a name="l00458"></a>00458            &lt;&lt; <span class="stringliteral">&quot;X2 Y2 I2   &quot;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#a4529ac90c929be7b372f291cfe1dcd30" title="The second order X moment of the region.">X2</a>() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#ace64726235e5ff29be32fe509b1b05d7" title="The second order Y moment of the region.">Y2</a>() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#a15f8c6c892bc4916784ea0308867cefd" title="The second order intensity moment of the region.">I2</a>() &lt;&lt; vcl_endl
<a name="l00459"></a>00459            &lt;&lt; <span class="stringliteral">&quot;XY XI YI = &quot;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#ad6e46c6ff70bf090ae7129486f5c3ab8" title="The second order X,Y moment of the region.">XY</a>() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#ac7c77494ba58491b9aa6fb30e31686b0" title="The second order X,intensity moment of the region.">XI</a>() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#a1861836768c8fae41421789bb5f45480" title="The second order Y,intensity moment of the region.">YI</a>() &lt;&lt; vcl_endl
<a name="l00460"></a>00460            &lt;&lt; <span class="stringliteral">&quot;Xo Yo Io   &quot;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#ad37cac5eca979c9f044ce69d47fe2b43" title="The mean X value of the region.">Xo</a>() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#a3b99d42fad1d6b780c5f7955cf4e992d" title="The mean Y value of the region.">Yo</a>() &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017" title="The mean intensity value of the region.">Io</a>() &lt;&lt; vcl_endl
<a name="l00461"></a>00461            &lt;&lt; <span class="stringliteral">&quot;fitted Plane:\n&quot;</span>
<a name="l00462"></a>00462            &lt;&lt; <span class="stringliteral">&quot;di/dx &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classvdgl__digital__region.html#a2ef32961f635a9ca51d7c1da78fb1b88" title="First derivative of intensity wrt x.">Ix</a>() &lt;&lt; vcl_endl
<a name="l00463"></a>00463            &lt;&lt; <span class="stringliteral">&quot;di/dy &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classvdgl__digital__region.html#aa57a33548b030a9da42d175be7abb35f" title="First derivative of intensity wrt y.">Iy</a>() &lt;&lt; vcl_endl
<a name="l00464"></a>00464            &lt;&lt; <span class="stringliteral">&quot;sample variance: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classvdgl__digital__region.html#a57762084639234fc59ff4ba689c58647" title="The plane fitting error.">Var</a>()&lt;&lt; vcl_endl
<a name="l00465"></a>00465            &lt;&lt; <span class="stringliteral">&quot;squared cost: &quot;</span> &lt;&lt; <a class="code" href="classvdgl__digital__region.html#a478913e7097e1586670536b75627688a">error_</a> &lt;&lt; vcl_endl
<a name="l00466"></a>00466            &lt;&lt; <span class="stringliteral">&quot;average cost: &quot;</span> &lt;&lt; vcl_sqrt(<a class="code" href="classvdgl__digital__region.html#a478913e7097e1586670536b75627688a">error_</a>) &lt;&lt; vcl_endl &lt;&lt; vcl_endl;
<a name="l00467"></a>00467 }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 <span class="preprocessor">#if 0</span>
<a name="l00470"></a>00470 <span class="preprocessor"></span><span class="comment">//-----------------------------------------------------------</span>
<a name="l00471"></a>00471 <span class="comment">//: Return a package of fitted coefficients</span>
<a name="l00472"></a>00472 <span class="comment">//</span>
<a name="l00473"></a>00473 IntensityCoef_ref vdgl_digital_region::GetIntCoef()<span class="keyword"> const</span>
<a name="l00474"></a>00474 <span class="keyword"></span>{
<a name="l00475"></a>00475   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>)
<a name="l00476"></a>00476     this-&gt;<a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">DoPlaneFit</a>();
<a name="l00477"></a>00477   <span class="keywordflow">return</span> <span class="keyword">new</span> IntensityCoef(this-&gt;<a class="code" href="classvdgl__digital__region.html#a35c62be034e78a05052d81b47b5949c7">Npix</a>(), <span class="keywordtype">float</span>(this-&gt;<a class="code" href="classvdgl__digital__region.html#a57762084639234fc59ff4ba689c58647" title="The plane fitting error.">Var</a>()),
<a name="l00478"></a>00478                            <span class="keywordtype">float</span>(this-&gt;<a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017" title="The mean intensity value of the region.">Io</a>()), <span class="keywordtype">float</span>(this-&gt;<a class="code" href="classvdgl__digital__region.html#a2ef32961f635a9ca51d7c1da78fb1b88" title="First derivative of intensity wrt x.">Ix</a>()),
<a name="l00479"></a>00479                            <span class="keywordtype">float</span>(this-&gt;<a class="code" href="classvdgl__digital__region.html#aa57a33548b030a9da42d175be7abb35f" title="First derivative of intensity wrt y.">Iy</a>()));
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 <span class="preprocessor">#endif</span>
<a name="l00482"></a>00482 <span class="preprocessor"></span>
<a name="l00483"></a>00483 <span class="comment">//-------------------------------------------------------</span>
<a name="l00484"></a>00484 <span class="comment">//: The Residual Intensity</span>
<a name="l00485"></a><a class="code" href="classvdgl__digital__region.html#adcc4b6fc024fddab7a2706df8fff8dc0">00485</a> <span class="keywordtype">float</span> <a class="code" href="classvdgl__digital__region.html#adcc4b6fc024fddab7a2706df8fff8dc0" title="The pixel intensity with the plane subtracted.">vdgl_digital_region::Ir</a>()<span class="keyword"> const</span>
<a name="l00486"></a>00486 <span class="keyword"></span>{
<a name="l00487"></a>00487   <span class="keywordflow">if</span> (pix_index_&lt;0 || pix_index_ &gt;= (<span class="keywordtype">int</span>)<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>)
<a name="l00488"></a>00488     <span class="keywordflow">return</span> 0.0f;
<a name="l00489"></a>00489   <span class="keywordflow">if</span> (npts_&lt;4)
<a name="l00490"></a>00490     <span class="keywordflow">return</span> 0.0f;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="keywordflow">if</span> (!<a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a>)
<a name="l00493"></a>00493   {
<a name="l00494"></a>00494     <span class="keywordtype">int</span> initial_pix_index = <a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a>;<span class="comment">//Save the current pix_index_ state</span>
<a name="l00495"></a>00495     this-&gt;<a class="code" href="classvdgl__digital__region.html#a6e4a7bad49b984c0f36151d7d798de2c" title="Fit a plane to the region intensities.">DoPlaneFit</a>();
<a name="l00496"></a>00496     <a class="code" href="classvdgl__digital__region.html#a61d663d7c14bea8af7b784983375314f" title="Index in pixel array (iterator)">pix_index_</a> = initial_pix_index;<span class="comment">//Restore the pix_index_ state</span>
<a name="l00497"></a>00497   }
<a name="l00498"></a>00498   <span class="keywordtype">float</span> val = float(this-&gt;<a class="code" href="classvdgl__digital__region.html#a99f5c33aacd63f94c23b103ac752ecd7" title="The pixel intensity.">I</a>());
<a name="l00499"></a>00499   <span class="keywordtype">float</span> io = this-&gt;<a class="code" href="classvdgl__digital__region.html#af109ca8b892b5adfe79ea602ba922017" title="The mean intensity value of the region.">Io</a>(),
<a name="l00500"></a>00500         ix = float(this-&gt;<a class="code" href="classvdgl__digital__region.html#a2ef32961f635a9ca51d7c1da78fb1b88" title="First derivative of intensity wrt x.">Ix</a>()), x = this-&gt;<a class="code" href="classvdgl__digital__region.html#a39d6fe8a734a237274ab9a3f71c6a019" title="The x pixel coordinate.">X</a>(), xo = this-&gt;<a class="code" href="classvdgl__digital__region.html#ad37cac5eca979c9f044ce69d47fe2b43" title="The mean X value of the region.">Xo</a>(),
<a name="l00501"></a>00501         iy = float(this-&gt;<a class="code" href="classvdgl__digital__region.html#aa57a33548b030a9da42d175be7abb35f" title="First derivative of intensity wrt y.">Iy</a>()), y = this-&gt;<a class="code" href="classvdgl__digital__region.html#a20764864de301589f336aa5c1db3bc63" title="The y pixel coordinate.">Y</a>(), yo = this-&gt;<a class="code" href="classvdgl__digital__region.html#a3b99d42fad1d6b780c5f7955cf4e992d" title="The mean Y value of the region.">Yo</a>();
<a name="l00502"></a>00502   <span class="keywordtype">float</span> plane_int = io + ix*(x - xo) + iy*(y-yo);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="keywordflow">return</span> val - plane_int;
<a name="l00505"></a>00505 }
<a name="l00506"></a>00506 
<a name="l00507"></a><a class="code" href="classvdgl__digital__region.html#a4fddaa199565d5022e6756b08f37150b">00507</a> <span class="keywordtype">bool</span> <a class="code" href="classvdgl__digital__region.html#a4fddaa199565d5022e6756b08f37150b" title="transform this region using the given 3x3 projective transformation matrix.">vdgl_digital_region::transform</a>(<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__float__3x3_8h.html#aaf94ddb0cc4af03ae77a1827e3efdbfa">vnl_float_3x3</a> <span class="keyword">const</span>&amp; t)
<a name="l00508"></a>00508 {
<a name="l00509"></a>00509   <span class="comment">//Transform the Pixels</span>
<a name="l00510"></a>00510   <span class="keywordflow">if</span> (<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> == 0)
<a name="l00511"></a>00511     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00512"></a>00512   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>; i++)
<a name="l00513"></a>00513   {
<a name="l00514"></a>00514     vnl_float_3 p = t * vnl_float_3(<a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>[i], <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>[i], 1.0f);
<a name="l00515"></a>00515     <a class="code" href="classvdgl__digital__region.html#acc21bc606b02c611854729c87bb66f01">xp_</a>[i]=p[0]/p[2];
<a name="l00516"></a>00516     <a class="code" href="classvdgl__digital__region.html#a68de097c41a566124ee1d301ad21f549" title="The location of each pixel.">yp_</a>[i]=p[1]/p[2];
<a name="l00517"></a>00517   }
<a name="l00518"></a>00518   <span class="comment">//Transform the mean pixel position</span>
<a name="l00519"></a>00519   vnl_float_3 <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__vector_8h.html#a00626facb4f86efb8618a4c5f5c3c5f8">m</a> = t * vnl_float_3(this-&gt;<a class="code" href="classvdgl__digital__region.html#ad37cac5eca979c9f044ce69d47fe2b43" title="The mean X value of the region.">Xo</a>(), this-&gt;<a class="code" href="classvdgl__digital__region.html#a3b99d42fad1d6b780c5f7955cf4e992d" title="The mean Y value of the region.">Yo</a>(), 1.0f);
<a name="l00520"></a>00520   <a class="code" href="classvdgl__digital__region.html#afc8c91683c0569ced639896811e78814">xo_</a> = m[0]/m[2]*<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00521"></a>00521   <a class="code" href="classvdgl__digital__region.html#a77284420f237160586a1f5b05e8e9e02">yo_</a> = m[1]/m[2]*<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>;
<a name="l00522"></a>00522   <a class="code" href="classvdgl__digital__region.html#a3916eb9508a567621b3e08de50876f68" title="Has a plane fit been done?">fit_valid_</a> = <span class="keyword">false</span>;
<a name="l00523"></a>00523   <a class="code" href="classvdgl__digital__region.html#ae3eb42f1a562ade4d55efc6a431c3dd9" title="Is the scatter matrix current?">scatter_matrix_valid_</a>=<span class="keyword">false</span>;
<a name="l00524"></a>00524   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00525"></a>00525 }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 <span class="comment">//--------------------------------------------------------</span>
<a name="l00528"></a>00528 <span class="comment">//: Compute the histogram</span>
<a name="l00529"></a><a class="code" href="classvdgl__digital__region.html#a7c3a09cd18a5ad3b412bb517aa276352">00529</a> vcl_vector&lt;unsigned int&gt; <a class="code" href="classvdgl__digital__region.html#a7c3a09cd18a5ad3b412bb517aa276352" title="Compute the intensity histogram.">vdgl_digital_region::histogram</a>(<span class="keywordtype">int</span> nbins)
<a name="l00530"></a>00530 {
<a name="l00531"></a>00531   assert(nbins &gt; 0);
<a name="l00532"></a>00532   <span class="keywordflow">if</span> (nbins == 1) <span class="keywordflow">return</span> vcl_vector&lt;unsigned int&gt;(1, <a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>);
<a name="l00533"></a>00533   vcl_vector&lt;unsigned int&gt; hist(nbins, 0U);
<a name="l00534"></a>00534   <span class="keywordflow">if</span> (<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> == 0) <span class="keywordflow">return</span> hist;
<a name="l00535"></a>00535   <span class="keywordtype">float</span> res = <a class="code" href="classvdgl__digital__region.html#abc902f2b7d9183ac190aaf7c63899389">max_</a>-<a class="code" href="classvdgl__digital__region.html#a1c476b192f74b6aaf1bff1206a358177" title="Upper and lower bounds.">min_</a>, step = res/nbins + 1e-6f;
<a name="l00536"></a>00536   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i =0; i&lt;<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>; ++i)
<a name="l00537"></a>00537     ++hist[<span class="keywordtype">int</span>((<a class="code" href="classvdgl__digital__region.html#a37c87a087a8f5e38e34137a0ded1f20b" title="The pixel intensities.">pix_</a>[i]-min_)/step)];
<a name="l00538"></a>00538   <span class="keywordflow">return</span> hist;
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a><a class="code" href="classvdgl__digital__region.html#af98e9c52d5030bf3b04780ea56e2536e">00541</a> vcl_vector&lt;unsigned int&gt; <a class="code" href="classvdgl__digital__region.html#af98e9c52d5030bf3b04780ea56e2536e" title="Compute the residual intensity histogram.">vdgl_digital_region::residual_histogram</a>(<span class="keywordtype">int</span> nbins,
<a name="l00542"></a>00542                                                                  <span class="keywordtype">float</span>* min,
<a name="l00543"></a>00543                                                                  <span class="keywordtype">float</span>* max)
<a name="l00544"></a>00544 {
<a name="l00545"></a>00545   assert(nbins &gt; 0);
<a name="l00546"></a>00546   <span class="keywordflow">if</span> (nbins == 1) <span class="keywordflow">return</span> vcl_vector&lt;unsigned int&gt;(1, <a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a>);
<a name="l00547"></a>00547   vcl_vector&lt;unsigned int&gt; hist(nbins, 0U);
<a name="l00548"></a>00548   <span class="keywordflow">if</span> (<a class="code" href="classvdgl__digital__region.html#aca7d56ab523ae166e00ccdf03514288e" title="Number of pixels in the region.">npts_</a> == 0) <span class="keywordflow">return</span> hist;
<a name="l00549"></a>00549   this-&gt;<a class="code" href="classvdgl__digital__region.html#a5e4a3a28ef6b1d83ec95f19237d3efa8" title="reset the iterator for accessing region pixels.">reset</a>();
<a name="l00550"></a>00550   <span class="keywordtype">float</span> mini = this-&gt;<a class="code" href="classvdgl__digital__region.html#adcc4b6fc024fddab7a2706df8fff8dc0" title="The pixel intensity with the plane subtracted.">Ir</a>(), maxi=mini;
<a name="l00551"></a>00551   <span class="keywordflow">while</span> (this-&gt;<a class="code" href="classvdgl__digital__region.html#a4be64e2c6292372f16711ca919d3fcbe" title="increment to next pixel and check if iterator is finished.">next</a>())
<a name="l00552"></a>00552   {
<a name="l00553"></a>00553     <span class="keywordtype">float</span> ir = this-&gt;<a class="code" href="classvdgl__digital__region.html#adcc4b6fc024fddab7a2706df8fff8dc0" title="The pixel intensity with the plane subtracted.">Ir</a>();
<a name="l00554"></a>00554     <span class="keywordflow">if</span> (ir&lt;mini) mini = ir;
<a name="l00555"></a>00555     <span class="keywordflow">if</span> (ir&gt;maxi) maxi = ir;
<a name="l00556"></a>00556   }
<a name="l00557"></a>00557   <span class="keywordflow">if</span> (min) *min = mini;
<a name="l00558"></a>00558   <span class="keywordflow">if</span> (max) *max = maxi;
<a name="l00559"></a>00559   <span class="keywordtype">float</span> res = maxi-mini, step = res/nbins + 1e-6f;
<a name="l00560"></a>00560   <span class="keywordflow">for</span> (this-&gt;<a class="code" href="classvdgl__digital__region.html#a5e4a3a28ef6b1d83ec95f19237d3efa8" title="reset the iterator for accessing region pixels.">reset</a>(); this-&gt;<a class="code" href="classvdgl__digital__region.html#a4be64e2c6292372f16711ca919d3fcbe" title="increment to next pixel and check if iterator is finished.">next</a>(); )
<a name="l00561"></a>00561     ++hist[<span class="keywordtype">int</span>((this-&gt;<a class="code" href="classvdgl__digital__region.html#adcc4b6fc024fddab7a2706df8fff8dc0" title="The pixel intensity with the plane subtracted.">Ir</a>()-mini)/step)];
<a name="l00562"></a>00562   <span class="keywordflow">return</span> hist;
<a name="l00563"></a>00563 }
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:37:30 for contrib/gel/vdgl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
