<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>examples/example_convert.cxx</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">examples/example_convert.cxx</div>  </div>
</div>
<div class="contents">
<div class="fragment"><pre class="fragment"><span class="comment">//:</span>
<span class="comment">// \file</span>
<span class="comment">//  This example program shows a typical use of the vipl_convert IP class on</span>
<span class="comment">//  any image.  The input image (argv[1]) is converted to a ubyte image</span>
<span class="comment">//  and written to argv[2] which is always a PGM file image.</span>
<span class="comment">//  When the input image is RGB, its intensity is extracted.</span>
<span class="comment">//  To this end an explicit converter from vil_rgb&lt;ubyte&gt; to ubyte is necessary.</span>
<span class="comment">//  When it is short, int or float, an implicit mapping is done to 0--255.</span>
<span class="comment">//  Uses vipl_convert&lt;vil_image_view&lt;T&gt;,vil_image_view&lt;T&gt;,T,ubyte&gt;.</span>
<span class="comment">//</span>
<span class="comment">// \author Peter Vanroose, K.U.Leuven, ESAT/PSI</span>
<span class="comment">// \date   29 may 1998</span>
<span class="comment">//</span>
<span class="comment">// \verbatim</span>
<span class="comment">// Modifications:</span>
<span class="comment">//   Peter Vanroose, Aug.2000 - adapted to vxl</span>
<span class="comment">//   Peter Vanroose, Feb.2004 - replaced vil1_image by vil_image_view&lt;T&gt;</span>
<span class="comment">// \endverbatim</span>
<span class="comment">//</span>
<span class="preprocessor">#include &lt;vil/vil_rgb.h&gt;</span>
<span class="preprocessor">#include &lt;vil/vil_image_view.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="vipl__accessors__vil__image__view_8h.html">vipl/accessors/vipl_accessors_vil_image_view.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="vipl__convert_8h.html" title="convert between arbitrary image types">vipl/vipl_convert.h</a>&gt;</span>

<span class="comment">// for I/O:</span>
<span class="preprocessor">#include &lt;vil/vil_load.h&gt;</span>
<span class="preprocessor">#include &lt;vil/vil_save.h&gt;</span>
<span class="preprocessor">#include &lt;vcl_iostream.h&gt;</span>

<span class="preprocessor">#include &lt;vxl_config.h&gt;</span> <span class="comment">// for vxl_byte</span>


<span class="keywordtype">int</span>
main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)
{
  <span class="keywordflow">if</span> (argc &lt; 3) { vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Syntax: example_convert file_in file_out\n&quot;</span>; <span class="keywordflow">return</span> 1; }

  <span class="comment">// The input image:</span>
  vil_image_view_base_sptr in = vil_load(argv[1]);

  <span class="comment">// The output image:</span>
  vil_image_view&lt;vxl_byte&gt; out(in-&gt;ni(),in-&gt;nj(),in-&gt;nplanes());

  <span class="keywordflow">if</span> (in-&gt;nplanes() == 3) { <span class="comment">// colour (RGB)</span>
    <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_BYTE) {
      <a name="_a0"></a><a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_byte&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_byte,vxl_byte&gt; op;
      vil_image_view&lt;vil_rgb&lt;vxl_byte&gt; &gt; tmp = in; vil_image_view&lt;vxl_byte&gt; tmp2 = tmp;
      op.<a name="a1"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp2); op.<a name="a2"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a3"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
      vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted ubyte RGB image to PGM image &quot;</span> &lt;&lt; argv[2] &lt;&lt; vcl_endl;
    }
    <span class="keywordflow">else</span> {
      vcl_cerr&lt;&lt;<span class="stringliteral">&quot;Not yet implemented conversion for non-8-bit colour pixels\n&quot;</span>;
      <span class="keywordflow">return</span> 1;
    }
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;nplanes() != 1) { <span class="comment">// not monochrome nore RGB</span>
    vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Cannot currently convert image with &quot;</span>&lt;&lt; in-&gt;nplanes() &lt;&lt;<span class="stringliteral">&quot; planes\n&quot;</span>;
    <span class="keywordflow">return</span> 1;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_COMPLEX_FLOAT ||
           in-&gt;pixel_format() == VIL_PIXEL_FORMAT_COMPLEX_DOUBLE) {
    vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Cannot currently convert complex pixel type images\n&quot;</span>;
    <span class="keywordflow">return</span> 1;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vil_pixel_format_component_format(in-&gt;pixel_format()) != in-&gt;pixel_format()) { <span class="comment">// RGB or RGBA</span>
    <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_RGB_BYTE) {
      <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_byte&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_byte,vxl_byte&gt; op;
      vil_image_view&lt;vil_rgb&lt;vxl_byte&gt; &gt; tmp = in; vil_image_view&lt;vxl_byte&gt; tmp2 = tmp;
      op.<a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp2); op.<a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
      vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted ubyte RGB image to PGM image &quot;</span> &lt;&lt; argv[2] &lt;&lt; vcl_endl;
    }
    <span class="keywordflow">else</span> {
      vcl_cerr&lt;&lt;<span class="stringliteral">&quot;Not yet implemented conversion for non-8-bit colour pixels\n&quot;</span>;
      <span class="keywordflow">return</span> 1;
    }
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_BYTE)
  {
    <span class="comment">// no conversion necessary</span>
    out = in;
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted ubyte image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt;<span class="stringliteral">&quot; (no conversion was necessary)\n&quot;</span>;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_SBYTE)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_sbyte&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_sbyte,vxl_byte&gt; op;
    vil_image_view&lt;vxl_sbyte&gt; tmp = in;
    op.<a name="a4"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a5"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a6"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted sbyte image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_UINT_16)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_uint_16&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_uint_16,vxl_byte&gt; op;
    vil_image_view&lt;vxl_uint_16&gt; tmp = in;
    op.<a name="a7"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a8"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a9"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted uint_16 image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_UINT_16)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_int_16&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_int_16,vxl_byte&gt; op;
    vil_image_view&lt;vxl_int_16&gt; tmp = in;
    op.<a name="a10"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a11"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a12"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted int_16 image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_UINT_32)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_uint_32&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_uint_32,vxl_byte&gt; op;
    vil_image_view&lt;vxl_uint_32&gt; tmp = in;
    op.<a name="a13"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a14"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a15"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted uint_32 image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_UINT_32)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_int_32&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_int_32,vxl_byte&gt; op;
    vil_image_view&lt;vxl_int_32&gt; tmp = in;
    op.<a name="a16"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a17"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a18"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted int_32 image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
<span class="preprocessor">#if VXL_HAS_INT_64</span>
<span class="preprocessor"></span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_UINT_64)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_uint_64&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_uint_64,vxl_byte&gt; op;
    vil_image_view&lt;vxl_uint_64&gt; tmp = in;
    op.<a name="a19"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a20"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a21"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted uint_64 image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_UINT_64)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;vxl_int_64&gt;</a>,vil_image_view&lt;vxl_byte&gt;,vxl_int_64,vxl_byte&gt; op;
    vil_image_view&lt;vxl_int_64&gt; tmp = in;
    op.<a name="a22"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a23"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a24"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted int_64 image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_FLOAT)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;float&gt;</a>,vil_image_view&lt;vxl_byte&gt;,float,vxl_byte&gt; op;
    vil_image_view&lt;float&gt; tmp = in;
    op.<a name="a25"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a26"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a27"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted float image to PGM image &quot;</span>&lt;&lt; argv[2] &lt;&lt; vcl_endl;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_DOUBLE)
  {
    <a class="code" href="classvipl__convert.html" title="convert between arbitrary image types.">vipl_convert&lt;vil_image_view&lt;double&gt;</a>,vil_image_view&lt;vxl_byte&gt;,double,vxl_byte&gt; op;
    vil_image_view&lt;double&gt; tmp = in;
    op.<a name="a28"></a><a class="code" href="classvipl__filter.html#a87ac6cd0164953fbd260c0c61f7477af" title="Put the given pointer into an input &quot;image&quot; at the provided index.">put_in_data_ptr</a>(&amp;tmp); op.<a name="a29"></a><a class="code" href="classvipl__filter.html#a4ff60f80ef1ff32af54edaadf3566efc" title="Put the given pointer into output data at the given index location Decrements old putput refcount...">put_out_data_ptr</a>(&amp;out); op.<a name="a30"></a><a class="code" href="classvipl__filter.html#a9d62bb892d2db736bd935a02a74cd31b" title="The main operation of the class, filters input images to produce output image.">filter</a>();
    vcl_cout &lt;&lt; <span class="stringliteral">&quot;vipl_converted double image to PGM image &quot;</span>&lt;&lt; argv[2]&lt;&lt;vcl_endl;
  }
<span class="preprocessor">#if 0</span>
<span class="preprocessor"></span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_PYRAMID) {
    vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Cannot currently convert pyramid images\n&quot;</span>;
    <span class="keywordflow">return</span> 1;
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (in-&gt;pixel_format() == VIL_PIXEL_FORMAT_BANDED) {
    vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Cannot currently convert banded images\n&quot;</span>;
    <span class="keywordflow">return</span> 1;
  }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  <span class="keywordflow">else</span> {
    vcl_cerr &lt;&lt; <span class="stringliteral">&quot;Never heared of image format &quot;</span>&lt;&lt; int(in-&gt;pixel_format())&lt;&lt;<span class="charliteral">&#39;\n&#39;</span>;
    <span class="keywordflow">return</span> 1;
  }

  vil_save(out, argv[2], <span class="stringliteral">&quot;pnm&quot;</span>);
  <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:36:18 for contrib/tbl/vipl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
