<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>contrib/brl/bseg/bmdl/bmdl_classify.h Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">contrib/brl/bseg/bmdl/bmdl_classify.h</div>  </div>
</div>
<div class="contents">
<a href="bmdl__classify_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is brl/bseg/bmdl/bmdl_classify.h</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef bmdl_classify_h_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#define bmdl_classify_h_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="comment">//:</span>
<a name="l00005"></a>00005 <span class="comment">// \file</span>
<a name="l00006"></a>00006 <span class="comment">// \brief Classify each pixel in lidar images</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// \author Matt Leotta</span>
<a name="l00009"></a>00009 <span class="comment">// \date Oct. 14, 2008</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;vcl_vector.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/vil__image__view_8h.html">vil/vil_image_view.h</a>&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00015"></a><a class="code" href="classbmdl__classify.html">00015</a> <span class="keyword">class </span><a class="code" href="classbmdl__classify.html">bmdl_classify</a>
<a name="l00016"></a>00016 {
<a name="l00017"></a>00017  <span class="keyword">public</span>:
<a name="l00018"></a>00018   <span class="comment">//: Constructor</span>
<a name="l00019"></a>00019   <span class="comment">// \param height_noise_stdev is the standard deviation in lidar height</span>
<a name="l00020"></a>00020   <span class="comment">//        This parameter can be set manually or estimated</span>
<a name="l00021"></a>00021   <span class="comment">// \param area_threshold is the minimum area allowed for buildings</span>
<a name="l00022"></a>00022   <span class="comment">// \param height_resolution is the height difference below which buildings are merged</span>
<a name="l00023"></a>00023   <span class="comment">// \param gnd_threshold is the minimum height above the ground considered for buildings and vegetation</span>
<a name="l00024"></a>00024   <span class="comment">// \param veg_threshold is the minimum distance between first and last returns for vegetation</span>
<a name="l00025"></a>00025   <a class="code" href="classbmdl__classify.html#a860e5f232a71fe98f21ba64a1f34dc49" title="Constructor.">bmdl_classify</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> area_threshold = 6,
<a name="l00026"></a>00026                 T height_resolution = 0.5,
<a name="l00027"></a>00027                 T gnd_threshold = 2.0,
<a name="l00028"></a>00028                 T <a class="code" href="classbmdl__classify.html#a84a12936ff5bb8481ceee6997e52aef2" title="The minimum distance between first and last returns for vegetation.">veg_threshold_</a> = 1.0);
<a name="l00029"></a>00029 
<a name="l00030"></a>00030   <span class="comment">//: Set the first and last return images</span>
<a name="l00031"></a>00031   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a6987f68fc6ff44b00a57cbe3ae1d557d" title="Set the first and last return images.">set_lidar_data</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#a7b71952dfafbd7b35e236937122b3d09" title="Access the first returns image.">first_return</a>,
<a name="l00032"></a>00032                       <span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#a11e666c9e850fc9f1287d0b2c4277796" title="Access the last returns image.">last_return</a>);
<a name="l00033"></a>00033 
<a name="l00034"></a>00034   <span class="comment">//: Set the bare earth image</span>
<a name="l00035"></a>00035   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a06af391863a2067c942af338a32f1353" title="Set the bare earth image.">set_bare_earth</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#a5116cf6b62f08c73e710883bef8ad458" title="Access the bare earth image.">bare_earth</a>);
<a name="l00036"></a>00036 
<a name="l00037"></a>00037   <span class="comment">//: Estimate a constant bare earth model</span>
<a name="l00038"></a>00038   <span class="comment">// This function returns the constant height</span>
<a name="l00039"></a>00039   <span class="comment">// and also uses it to fill the bare earth image</span>
<a name="l00040"></a>00040   T <a class="code" href="classbmdl__classify.html#a8aff4032dca49dde7c72d800176b748b" title="Estimate a constant bare earth model.">estimate_bare_earth</a>();
<a name="l00041"></a>00041 
<a name="l00042"></a>00042   <span class="comment">//: Estimate the standard deviation in height due to noise</span>
<a name="l00043"></a>00043   <span class="comment">//  Returns the estimate and stores it internally for later use</span>
<a name="l00044"></a>00044   T <a class="code" href="classbmdl__classify.html#afdfb81e065b00d08064e6df54970b4fc" title="Estimate the standard deviation in height due to noise.">estimate_height_noise_stdev</a>();
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="comment">//: Manually specify the standard deviation in lidar height from noise</span>
<a name="l00047"></a>00047   <span class="comment">// \note This parameter is not currently used.  Use ground and vegetation thresholds instead.</span>
<a name="l00048"></a><a class="code" href="classbmdl__classify.html#a04ce454788fe0375aea15cb581f9cb77">00048</a>   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a04ce454788fe0375aea15cb581f9cb77" title="Manually specify the standard deviation in lidar height from noise.">set_height_noise_stdev</a>(T stdev) { <a class="code" href="classbmdl__classify.html#a51ed139d0f6a7899d7cdbe7e68f162db" title="The estimated standard deviation of noise in height.">hgt_stdev_</a> = stdev; }
<a name="l00049"></a>00049   <span class="comment">//: Specify the building area threshold</span>
<a name="l00050"></a><a class="code" href="classbmdl__classify.html#a3fece0e001c2217e54d7ecd5c20502dc">00050</a>   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a3fece0e001c2217e54d7ecd5c20502dc" title="Specify the building area threshold.">set_area_threshold</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> area) { <a class="code" href="classbmdl__classify.html#a5098f3de79cf1eebfd595c19eaf06735" title="A threshold on the minimum building area.">area_threshold_</a> = area; }
<a name="l00051"></a>00051   <span class="comment">//: Specify the ground threshold</span>
<a name="l00052"></a><a class="code" href="classbmdl__classify.html#aa9c720090b292c586cd9c56ac72f5a8e">00052</a>   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#aa9c720090b292c586cd9c56ac72f5a8e" title="Specify the ground threshold.">set_ground_threshold</a>(T gnd_threshold) { <a class="code" href="classbmdl__classify.html#a83d1dfb7db960952ceca6c34990ea2ed" title="The minimum height above the ground for buildings.">gnd_threshold_</a> = gnd_threshold; }
<a name="l00053"></a>00053   <span class="comment">//: Specify the vegetation threshold</span>
<a name="l00054"></a><a class="code" href="classbmdl__classify.html#ae38ac87a75e636b399556dd999d9651d">00054</a>   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#ae38ac87a75e636b399556dd999d9651d" title="Specify the vegetation threshold.">set_vegetation_threshold</a>(T veg_threshold) { <a class="code" href="classbmdl__classify.html#a84a12936ff5bb8481ceee6997e52aef2" title="The minimum distance between first and last returns for vegetation.">veg_threshold_</a> = veg_threshold; }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056   <span class="comment">//: Access the first returns image</span>
<a name="l00057"></a><a class="code" href="classbmdl__classify.html#a7b71952dfafbd7b35e236937122b3d09">00057</a>   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#a7b71952dfafbd7b35e236937122b3d09" title="Access the first returns image.">first_return</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#aa119a3f182a7c0486ae895184c665a93" title="first return image.">first_return_</a>;}
<a name="l00058"></a>00058 
<a name="l00059"></a>00059   <span class="comment">//: Access the last returns image</span>
<a name="l00060"></a><a class="code" href="classbmdl__classify.html#a11e666c9e850fc9f1287d0b2c4277796">00060</a>   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#a11e666c9e850fc9f1287d0b2c4277796" title="Access the last returns image.">last_return</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a515fea0a49c6e6deda47be32d4036edf" title="last return image.">last_return_</a>;}
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <span class="comment">//: Access the bare earth image</span>
<a name="l00063"></a><a class="code" href="classbmdl__classify.html#a5116cf6b62f08c73e710883bef8ad458">00063</a>   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#a5116cf6b62f08c73e710883bef8ad458" title="Access the bare earth image.">bare_earth</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a02c6379c055cc98a0af9dbc24cffa766" title="bare earth estimate image.">bare_earth_</a>;}
<a name="l00064"></a>00064 
<a name="l00065"></a>00065   <span class="comment">//: Access the minimum height in the first return image</span>
<a name="l00066"></a><a class="code" href="classbmdl__classify.html#ae62b5e260caa44309cb52f85dcec1ac9">00066</a>   T <a class="code" href="classbmdl__classify.html#ae62b5e260caa44309cb52f85dcec1ac9" title="Access the minimum height in the first return image.">first_min</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a26ee3fbb16c05b9c6c340c697677e459" title="The range spanned by the first returns.">first_min_</a>;}
<a name="l00067"></a>00067   <span class="comment">//: Access the maximum height in the first return image</span>
<a name="l00068"></a><a class="code" href="classbmdl__classify.html#a0815ba3206c186a778c8f033f7f09b42">00068</a>   T <a class="code" href="classbmdl__classify.html#a0815ba3206c186a778c8f033f7f09b42" title="Access the maximum height in the first return image.">first_max</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#aaefa6ccc23210afd519c8b4616146352">first_max_</a>;}
<a name="l00069"></a>00069   <span class="comment">//: Access the minimum height in the last return image</span>
<a name="l00070"></a><a class="code" href="classbmdl__classify.html#a176961d810ffa33fceff53b2e64776a4">00070</a>   T <a class="code" href="classbmdl__classify.html#a176961d810ffa33fceff53b2e64776a4" title="Access the minimum height in the last return image.">last_min</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#ac235e3ab76559e2181a73a0f8345c823" title="The range spanned by the last returns.">last_min_</a>;}
<a name="l00071"></a>00071   <span class="comment">//: Access the maximum height in the last return image</span>
<a name="l00072"></a><a class="code" href="classbmdl__classify.html#a917b0dbd2c7216f3241432005e52ed1d">00072</a>   T <a class="code" href="classbmdl__classify.html#a917b0dbd2c7216f3241432005e52ed1d" title="Access the maximum height in the last return image.">last_max</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a453c70d4913359cb4cee9f1f2fe1e5b8">last_max_</a>;}
<a name="l00073"></a>00073 
<a name="l00074"></a>00074   <span class="comment">//: Classify each pixel as Ground (0), Vegetation (1), or Building (&gt;=2)</span>
<a name="l00075"></a>00075   <span class="comment">// Each building is given an index sequentially starting with 2</span>
<a name="l00076"></a>00076   <span class="comment">// and sorted by mean height.</span>
<a name="l00077"></a>00077   <span class="comment">// \note This is the main function you should call, it runs all the steps</span>
<a name="l00078"></a>00078   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a707e060dc4401ccb645ddaeca2f73aa8" title="Classify each pixel as Ground (0), Vegetation (1), or Building (&gt;=2).">label_lidar</a>();
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="comment">//: Perform an initial segmentation at each pixel using thresholds</span>
<a name="l00081"></a>00081   <span class="comment">// Classify each pixel as Ground (0), Vegetation (1), or Building (2)</span>
<a name="l00082"></a>00082   <span class="comment">// Results are stored in the labels image</span>
<a name="l00083"></a>00083   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a3329950a83219aae1778fead76faa50f" title="Perform an initial segmentation at each pixel using thresholds.">segment</a>();
<a name="l00084"></a>00084 
<a name="l00085"></a>00085   <span class="comment">//: Cluster pixels on buildings into groups of adjacent pixels with similar heights.</span>
<a name="l00086"></a>00086   <span class="comment">//  Assign a new label to each groups.</span>
<a name="l00087"></a>00087   <span class="comment">//  Returns building mean heights and pixel counts by reference</span>
<a name="l00088"></a>00088   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#ac19f8641c1ce2943316e9872809240b0" title="Cluster pixels on buildings into groups of adjacent pixels with similar heights.">cluster_buildings</a>();
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="comment">//: Replace small holes in buildings from ground to vegetation (unclaimed) labels</span>
<a name="l00091"></a>00091   <span class="comment">// Holes are switch if area is less than \a min_size</span>
<a name="l00092"></a>00092   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a4c69053b176c2763938f34b874507529" title="Replace small holes in buildings from ground to vegetation (unclaimed) labels.">fill_ground_holes</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> min_size);
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <span class="comment">//: Threshold buildings by area.</span>
<a name="l00095"></a>00095   <span class="comment">// All buildings with area (in pixels) less than the threshold</span>
<a name="l00096"></a>00096   <span class="comment">// are removed and replace with a vegetation label.</span>
<a name="l00097"></a>00097   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a08bde7eef070d4374cd106a9a0eff861" title="Threshold buildings by area.">threshold_building_area</a>();
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   <span class="comment">//: Dilate buildings into unclaimed (vegetation) pixel</span>
<a name="l00100"></a>00100   <span class="comment">//  Only claim a vegetation pixel if surrounded by</span>
<a name="l00101"></a>00101   <span class="comment">//  \a num pixels from the same building</span>
<a name="l00102"></a>00102   <span class="keywordtype">bool</span> <a class="code" href="classbmdl__classify.html#a0dc9355c48531404db04fb970eb8502b" title="Dilate buildings into unclaimed (vegetation) pixel.">dilate_buildings</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num=6);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104   <span class="comment">//: Greedy merging of adjacent buildings</span>
<a name="l00105"></a>00105   <span class="keywordtype">bool</span> <a class="code" href="classbmdl__classify.html#a1fe8a1e952f7b60f1d21dcb416ff449e" title="Greedy merging of adjacent buildings.">greedy_merge</a>();
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="comment">//: Refine the building regions</span>
<a name="l00108"></a>00108   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a08b12d6c926e96032d6b578a0750e067" title="Refine the building regions.">refine_buildings</a>();
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="comment">//: Access the resulting label image</span>
<a name="l00111"></a><a class="code" href="classbmdl__classify.html#adf0e828b409abd2a4dd5d9e3b49b8f51">00111</a>   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;unsigned int&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#adf0e828b409abd2a4dd5d9e3b49b8f51" title="Access the resulting label image.">labels</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#aa83dc23ed9562ef676594acc5ea4d2b1" title="computed segmentation labels.">labels_</a>; }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="comment">//: Access the resulting height image</span>
<a name="l00114"></a><a class="code" href="classbmdl__classify.html#acf30a3138dda137ec4dec7f905d24f59">00114</a>   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; <a class="code" href="classbmdl__classify.html#acf30a3138dda137ec4dec7f905d24f59" title="Access the resulting height image.">heights</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a2ed20cb389546203d3d3ab0bc1081ea2" title="clean up height estimates for use in meshing.">heights_</a>; }
<a name="l00115"></a>00115   <span class="comment">//: Access the mean building heights</span>
<a name="l00116"></a><a class="code" href="classbmdl__classify.html#a26907756effc66e2987bcb7413bb5b06">00116</a>   <span class="keyword">const</span> vcl_vector&lt;T&gt;&amp; <a class="code" href="classbmdl__classify.html#a26907756effc66e2987bcb7413bb5b06" title="Access the mean building heights.">mean_heights</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a74836bdf2551d74a2f2834ff92f56271" title="The mean height of each building.">building_mean_hgt_</a>; }
<a name="l00117"></a>00117   <span class="comment">//: Access the building areas in pixels</span>
<a name="l00118"></a><a class="code" href="classbmdl__classify.html#a1eb68b5da4c0e484af8bc53027f698c5">00118</a>   <span class="keyword">const</span> vcl_vector&lt;unsigned int&gt;&amp; <a class="code" href="classbmdl__classify.html#a1eb68b5da4c0e484af8bc53027f698c5" title="Access the building areas in pixels.">building_area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbmdl__classify.html#a05f16ed43dd713509ff90be0100b4079" title="The area in pixels of each building.">building_area_</a>; }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120  <span class="keyword">private</span>:
<a name="l00121"></a>00121   <span class="comment">//: A helper class to manage merging of buildings</span>
<a name="l00122"></a><a class="code" href="classbmdl__classify_1_1merge__map.html">00122</a>   <span class="keyword">class </span><a class="code" href="classbmdl__classify_1_1merge__map.html" title="A helper class to manage merging of buildings.">merge_map</a>
<a name="l00123"></a>00123   {
<a name="l00124"></a>00124    <span class="keyword">public</span>:
<a name="l00125"></a>00125     <span class="comment">//: Constructor</span>
<a name="l00126"></a>00126     <a class="code" href="classbmdl__classify_1_1merge__map.html#a2b83d2d514db5b80a2b15d23ee46a153" title="Constructor.">merge_map</a>(<a class="code" href="classbmdl__classify.html">bmdl_classify&lt;T&gt;</a>* c);
<a name="l00127"></a>00127     <span class="comment">//: Destructor - simplify merge map and apply to classifier</span>
<a name="l00128"></a>00128     <a class="code" href="classbmdl__classify_1_1merge__map.html#ae0b6fd4d339e55f7e601d8493e795d27" title="Destructor - simplify merge map and apply to classifier.">~merge_map</a>();
<a name="l00129"></a>00129     <span class="comment">//: translate old index to temporary merged index</span>
<a name="l00130"></a>00130     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classbmdl__classify_1_1merge__map.html#a86d1966d57335b6240d4b08597090a54" title="translate old index to temporary merged index.">translate</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx) <span class="keyword">const</span>;
<a name="l00131"></a>00131     <span class="comment">//: merge two indices</span>
<a name="l00132"></a>00132     <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify_1_1merge__map.html#ac94c04c96685cd6c5a145511016c5889" title="merge two indices.">merge</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx1, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx2);
<a name="l00133"></a>00133    <span class="keyword">private</span>:
<a name="l00134"></a><a class="code" href="classbmdl__classify_1_1merge__map.html#a19780274afa2fbdbc95a801ce4f14d94">00134</a>     <a class="code" href="classbmdl__classify.html">bmdl_classify&lt;T&gt;</a>* <a class="code" href="classbmdl__classify_1_1merge__map.html#a19780274afa2fbdbc95a801ce4f14d94">classifier_</a>;
<a name="l00135"></a><a class="code" href="classbmdl__classify_1_1merge__map.html#ae964e6c034589ad040cbb5afea119251">00135</a>     vcl_vector&lt;unsigned int&gt; <a class="code" href="classbmdl__classify_1_1merge__map.html#ae964e6c034589ad040cbb5afea119251">idx_map_</a>;
<a name="l00136"></a>00136   };
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classbmdl__classify.html#ac277f9f8cda6ff5efa9897707e84706a">00138</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classbmdl__classify_1_1merge__map.html" title="A helper class to manage merging of buildings.">merge_map</a>;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140   <span class="comment">//: Parabolic interpolation of 3 points \p y_0, \p y_1, \p y_2</span>
<a name="l00141"></a>00141   <span class="comment">//  \returns the peak value by reference in \p y_peak</span>
<a name="l00142"></a>00142   <span class="comment">//  \returns the peak location offset from the x of \p y_0</span>
<a name="l00143"></a>00143   T <a class="code" href="classbmdl__classify.html#aac31c8088eb028307633df01241308c8" title="Parabolic interpolation of 3 points y_0, y_1, y_2.">interpolate_parabola</a>(T y_1, T y_0, T y_2, T&amp; root_offset) <span class="keyword">const</span>;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <span class="comment">//: Compute a histogram of the data</span>
<a name="l00146"></a>00146   <span class="comment">// Does not reset the initial bin values to zero</span>
<a name="l00147"></a>00147   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#a53e66dbe3655ce3d643631fa2628e486" title="Compute a histogram of the data.">histogram</a>(<span class="keyword">const</span> vcl_vector&lt;T&gt;&amp; data, vcl_vector&lt;unsigned int&gt;&amp; bins,
<a name="l00148"></a>00148                  T minv, T maxv) <span class="keyword">const</span>;
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <span class="comment">//: Find the maximum peak in the data and fit a gaussian to it</span>
<a name="l00151"></a>00151   <span class="comment">// Search in the range \a minv to \a maxv</span>
<a name="l00152"></a>00152   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#abdf43a4cc963f0078b46bc9216757895" title="Find the maximum peak in the data and fit a gaussian to it.">fit_gaussian_to_peak</a>(<span class="keyword">const</span> vcl_vector&lt;T&gt;&amp; data, T minv, T maxv,
<a name="l00153"></a>00153                             T&amp; mean, T&amp; stdev) <span class="keyword">const</span>;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155   <span class="comment">//: Expand the range (minv, maxv) with the data in \a image</span>
<a name="l00156"></a>00156   <span class="comment">// Only finite values count</span>
<a name="l00157"></a>00157   <span class="keywordtype">void</span> <a class="code" href="classbmdl__classify.html#ab37f2533c93e8d14ec240325ec42d26f" title="Expand the range (minv, maxv) with the data in image.">range</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a>&amp; image,
<a name="l00158"></a>00158              T&amp; minv, T&amp; maxv) <span class="keyword">const</span>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="comment">//: Search for nearby pixel that can be added to each building</span>
<a name="l00161"></a>00161   <span class="comment">//  Return true if any changes are made</span>
<a name="l00162"></a>00162   <span class="keywordtype">bool</span> <a class="code" href="classbmdl__classify.html#a4aaf7e1f0654782bada547ad31763c91" title="Search for nearby pixel that can be added to each building.">expand_buildings</a>(vcl_vector&lt;T&gt;&amp; means,
<a name="l00163"></a>00163                         vcl_vector&lt;unsigned int&gt;&amp; sizes);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165   <span class="comment">//: Group building pixel by height into bins of size \a binsize</span>
<a name="l00166"></a>00166   <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;unsigned int&gt;</a> <a class="code" href="classbmdl__classify.html#ac19b85bcb1f3cdea3cfdb6c97fe33891" title="Group building pixel by height into bins of size binsize.">bin_heights</a>(T binsize = 0.5);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   <span class="comment">//: Morphological clean up on each building independently</span>
<a name="l00170"></a>00170   vcl_vector&lt;bool&gt; <a class="code" href="classbmdl__classify.html#a7af509b1acbd6cf445128c393bd73411" title="Morphological clean up on each building independently.">close_buildings</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_labels);
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="comment">//: first return image</span>
<a name="l00173"></a><a class="code" href="classbmdl__classify.html#aa119a3f182a7c0486ae895184c665a93">00173</a>   <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a> <a class="code" href="classbmdl__classify.html#aa119a3f182a7c0486ae895184c665a93" title="first return image.">first_return_</a>;
<a name="l00174"></a>00174   <span class="comment">//: last return image</span>
<a name="l00175"></a><a class="code" href="classbmdl__classify.html#a515fea0a49c6e6deda47be32d4036edf">00175</a>   <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a> <a class="code" href="classbmdl__classify.html#a515fea0a49c6e6deda47be32d4036edf" title="last return image.">last_return_</a>;
<a name="l00176"></a>00176   <span class="comment">//: bare earth estimate image</span>
<a name="l00177"></a><a class="code" href="classbmdl__classify.html#a02c6379c055cc98a0af9dbc24cffa766">00177</a>   <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a> <a class="code" href="classbmdl__classify.html#a02c6379c055cc98a0af9dbc24cffa766" title="bare earth estimate image.">bare_earth_</a>;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   <span class="comment">//: The estimated standard deviation of noise in height</span>
<a name="l00180"></a><a class="code" href="classbmdl__classify.html#a51ed139d0f6a7899d7cdbe7e68f162db">00180</a>   T <a class="code" href="classbmdl__classify.html#a51ed139d0f6a7899d7cdbe7e68f162db" title="The estimated standard deviation of noise in height.">hgt_stdev_</a>;
<a name="l00181"></a>00181   <span class="comment">//: A threshold on the minimum building area</span>
<a name="l00182"></a><a class="code" href="classbmdl__classify.html#a5098f3de79cf1eebfd595c19eaf06735">00182</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classbmdl__classify.html#a5098f3de79cf1eebfd595c19eaf06735" title="A threshold on the minimum building area.">area_threshold_</a>;
<a name="l00183"></a>00183   <span class="comment">//: The minimum height difference that does not merge</span>
<a name="l00184"></a><a class="code" href="classbmdl__classify.html#a80c9569e4e6e1b335cb6a9787ed3acb1">00184</a>   T <a class="code" href="classbmdl__classify.html#a80c9569e4e6e1b335cb6a9787ed3acb1" title="The minimum height difference that does not merge.">height_resolution_</a>;
<a name="l00185"></a>00185   <span class="comment">//: The minimum height above the ground for buildings</span>
<a name="l00186"></a><a class="code" href="classbmdl__classify.html#a83d1dfb7db960952ceca6c34990ea2ed">00186</a>   T <a class="code" href="classbmdl__classify.html#a83d1dfb7db960952ceca6c34990ea2ed" title="The minimum height above the ground for buildings.">gnd_threshold_</a>;
<a name="l00187"></a>00187   <span class="comment">//: The minimum distance between first and last returns for vegetation</span>
<a name="l00188"></a><a class="code" href="classbmdl__classify.html#a84a12936ff5bb8481ceee6997e52aef2">00188</a>   T <a class="code" href="classbmdl__classify.html#a84a12936ff5bb8481ceee6997e52aef2" title="The minimum distance between first and last returns for vegetation.">veg_threshold_</a>;
<a name="l00189"></a>00189   <span class="comment">//: The range spanned by the first returns</span>
<a name="l00190"></a><a class="code" href="classbmdl__classify.html#a26ee3fbb16c05b9c6c340c697677e459">00190</a>   T <a class="code" href="classbmdl__classify.html#a26ee3fbb16c05b9c6c340c697677e459" title="The range spanned by the first returns.">first_min_</a>, <a class="code" href="classbmdl__classify.html#aaefa6ccc23210afd519c8b4616146352">first_max_</a>;
<a name="l00191"></a>00191   <span class="comment">//: The range spanned by the last returns</span>
<a name="l00192"></a><a class="code" href="classbmdl__classify.html#ac235e3ab76559e2181a73a0f8345c823">00192</a>   T <a class="code" href="classbmdl__classify.html#ac235e3ab76559e2181a73a0f8345c823" title="The range spanned by the last returns.">last_min_</a>, <a class="code" href="classbmdl__classify.html#a453c70d4913359cb4cee9f1f2fe1e5b8">last_max_</a>;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   <span class="comment">//: The mean height of each building</span>
<a name="l00195"></a><a class="code" href="classbmdl__classify.html#a74836bdf2551d74a2f2834ff92f56271">00195</a>   vcl_vector&lt;T&gt; <a class="code" href="classbmdl__classify.html#a74836bdf2551d74a2f2834ff92f56271" title="The mean height of each building.">building_mean_hgt_</a>;
<a name="l00196"></a>00196   <span class="comment">//: The area in pixels of each building</span>
<a name="l00197"></a><a class="code" href="classbmdl__classify.html#a05f16ed43dd713509ff90be0100b4079">00197</a>   vcl_vector&lt;unsigned int&gt; <a class="code" href="classbmdl__classify.html#a05f16ed43dd713509ff90be0100b4079" title="The area in pixels of each building.">building_area_</a>;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199   <span class="comment">//: computed segmentation labels</span>
<a name="l00200"></a><a class="code" href="classbmdl__classify.html#aa83dc23ed9562ef676594acc5ea4d2b1">00200</a>   <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;unsigned int&gt;</a> <a class="code" href="classbmdl__classify.html#aa83dc23ed9562ef676594acc5ea4d2b1" title="computed segmentation labels.">labels_</a>;
<a name="l00201"></a>00201   <span class="comment">//: clean up height estimates for use in meshing</span>
<a name="l00202"></a><a class="code" href="classbmdl__classify.html#a2ed20cb389546203d3d3ab0bc1081ea2">00202</a>   <a class="codeRef" doxygen="core_vil.tag:../../../../../core/vil/html" href="../../../../../core/vil/html/classvil__image__view.html">vil_image_view&lt;T&gt;</a> <a class="code" href="classbmdl__classify.html#a2ed20cb389546203d3d3ab0bc1081ea2" title="clean up height estimates for use in meshing.">heights_</a>;
<a name="l00203"></a>00203 };
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <span class="preprocessor">#endif // bmdl_classify_h_</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Thu May 2 2013 08:54:06 for contrib/brl/bseg/bmdl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
