<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>contrib/brl/bbas/bsta/bsta_spherical_histogram.h Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">contrib/brl/bbas/bsta/bsta_spherical_histogram.h</div>  </div>
</div>
<div class="contents">
<a href="bsta__spherical__histogram_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is brl/bbas/bsta/bsta_spherical_histogram.h</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef bsta_spherical_histogram_h_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#define bsta_spherical_histogram_h_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="comment">//:</span>
<a name="l00005"></a>00005 <span class="comment">// \file</span>
<a name="l00006"></a>00006 <span class="comment">// \brief A 2-d histogram with bins defined on a unit sphere</span>
<a name="l00007"></a>00007 <span class="comment">// \author Joseph L. Mundy</span>
<a name="l00008"></a>00008 <span class="comment">// \date May 3, 2011</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">// A histogram on the sphere. There are a number of popular choices for</span>
<a name="l00011"></a>00011 <span class="comment">// spherical coordinates and units that are handled. The units for angle</span>
<a name="l00012"></a>00012 <span class="comment">// can be either degrees or radians. Also there are many choices for</span>
<a name="l00013"></a>00013 <span class="comment">// coordinate systems on the sphere. For example in geographic coordinates</span>
<a name="l00014"></a>00014 <span class="comment">// the North and South poles are at +-90 degrees. Also the azimuthal angle</span>
<a name="l00015"></a>00015 <span class="comment">// can exhibit the range 0 -&gt; 360 or -180 -&gt; 180, with discontinuities in</span>
<a name="l00016"></a>00016 <span class="comment">// the angle coordinate (a branch cut). The latter choice of branch cut is used</span>
<a name="l00017"></a>00017 <span class="comment">// for geographic coordinates where positive azimuths are East of Greenwich,</span>
<a name="l00018"></a>00018 <span class="comment">// England. More typically for physics applications the elevation is 0 at the</span>
<a name="l00019"></a>00019 <span class="comment">// North pole of the sphere and increases to 180 degrees at the South pole, with// the azimuthal range 0 -&gt; 360. Note that azimuth is undefined at the</span>
<a name="l00020"></a>00020 <span class="comment">// North and South poles and a special elevation bin centered at the poles</span>
<a name="l00021"></a>00021 <span class="comment">// is needed. The current implementation does not include such a pole bin.</span>
<a name="l00022"></a>00022 <span class="comment">//</span>
<a name="l00023"></a>00023 <span class="comment">// The histogram is implemented as a map on the linear coordinate derived</span>
<a name="l00024"></a>00024 <span class="comment">// from azimuth and elevation indices. Bins with zero count are not</span>
<a name="l00025"></a>00025 <span class="comment">// present in the map.</span>
<a name="l00026"></a>00026 <span class="comment">//</span>
<a name="l00027"></a>00027 <span class="comment">// Methods are provided for the mean and covariance matrix of the histogram</span>
<a name="l00028"></a>00028 <span class="comment">// distribution. The mean is derived from the mean Cartesian vector</span>
<a name="l00029"></a>00029 <span class="comment">// of points on the unit sphere corresponding to the populated bin centers.</span>
<a name="l00030"></a>00030 <span class="comment">// Covariance is computed on angle differences and so is valid only in the</span>
<a name="l00031"></a>00031 <span class="comment">// tangent plane to the unit sphere at the mean.</span>
<a name="l00032"></a>00032 <span class="comment">//</span>
<a name="l00033"></a>00033 <span class="comment">// \verbatim</span>
<a name="l00034"></a>00034 <span class="comment">//  Modifications</span>
<a name="l00035"></a>00035 <span class="comment">//   (none yet)</span>
<a name="l00036"></a>00036 <span class="comment">// \endverbatim</span>
<a name="l00037"></a>00037 <span class="comment">//</span>
<a name="l00038"></a>00038 <span class="comment">//</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;vcl_map.h&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;vcl_vector.h&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;vcl_iostream.h&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;vnl/vnl_math.h&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;vnl/vnl_matrix_fixed.h&gt;</span>
<a name="l00045"></a>00045 <span class="comment">//: A histogram on the unit sphere</span>
<a name="l00046"></a>00046 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00047"></a><a class="code" href="classbsta__spherical__histogram.html">00047</a> <span class="keyword">class </span><a class="code" href="classbsta__spherical__histogram.html" title="A histogram on the unit sphere.">bsta_spherical_histogram</a>
<a name="l00048"></a>00048 {
<a name="l00049"></a>00049  <span class="keyword">public</span>:
<a name="l00050"></a><a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051a820511a9e3392fc425d046073129a713">00050</a>   <span class="keyword">enum</span> <a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051">ang_units</a> {<a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051a820511a9e3392fc425d046073129a713">RADIANS</a>, <a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051aab583fb4bc276f1f8fa9f5b291ee9490">DEG</a>};
<a name="l00051"></a><a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31ba495f6ea4a42ce23d2f032a6f8f0b69b0">00051</a>   <span class="keyword">enum</span> <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> {<a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31ba5412d0bf5001c5230dfc1188c308c978">B_0_360</a>, <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31bad44f0c0447b36153aa8eda0d88876c11">B_180_180</a>, <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31baf58390985b3141bfa066adc1390d5b57">B_0_180</a>, <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31ba495f6ea4a42ce23d2f032a6f8f0b69b0">B_90_90</a>};
<a name="l00052"></a>00052   <a class="code" href="classbsta__spherical__histogram.html#af5235d3bd3286e4d62b34527f8ea244f">bsta_spherical_histogram</a>();
<a name="l00053"></a>00053   <a class="code" href="classbsta__spherical__histogram.html#af5235d3bd3286e4d62b34527f8ea244f">bsta_spherical_histogram</a>(<span class="keywordtype">unsigned</span> <a class="code" href="classbsta__spherical__histogram.html#a6d267866e0efab0bf072baa07b156bf7" title="number of bins allowed.">n_azimuth</a>, <span class="keywordtype">unsigned</span> <a class="code" href="classbsta__spherical__histogram.html#a528716f42ef0a0a29c6fbba212ca0c9f">n_elevation</a>,
<a name="l00054"></a>00054                            T <a class="code" href="classbsta__spherical__histogram.html#a2742b1a3fdfc7c509023dccbc27a41bc" title="azimuth bounds.">azimuth_start</a>, T <a class="code" href="classbsta__spherical__histogram.html#a237eb1b791307b3e4c52272eaefb52d0">azimuth_range</a>,
<a name="l00055"></a>00055                            T <a class="code" href="classbsta__spherical__histogram.html#ae2f39598c5fa9fc8ec0c3673ed5d6702" title="elevation bounds.">elevation_start</a>, T <a class="code" href="classbsta__spherical__histogram.html#a5b6898b7d29e2e16ae177ccaef7e49ab">elevation_range</a>,
<a name="l00056"></a>00056                            <a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051">ang_units</a> <a class="code" href="classbsta__spherical__histogram.html#a6f16a288dc63da14c42f693a04adc717" title="angle units e.g. RADIANS, DEG.">units</a> = <a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051aab583fb4bc276f1f8fa9f5b291ee9490">DEG</a>,
<a name="l00057"></a>00057                            <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> az_branch_cut = <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31bad44f0c0447b36153aa8eda0d88876c11">B_180_180</a>,
<a name="l00058"></a>00058                            <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> el_poles = <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31ba495f6ea4a42ce23d2f032a6f8f0b69b0">B_90_90</a>);
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classbsta__spherical__histogram.html#aa574cb18f1e82a774bea68e8f58c2644">00060</a>   <a class="code" href="classbsta__spherical__histogram.html#aa574cb18f1e82a774bea68e8f58c2644">~bsta_spherical_histogram</a>() {}
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <span class="comment">//: angle units e.g. RADIANS, DEG</span>
<a name="l00063"></a><a class="code" href="classbsta__spherical__histogram.html#a6f16a288dc63da14c42f693a04adc717">00063</a>   <a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051">ang_units</a> <a class="code" href="classbsta__spherical__histogram.html#a6f16a288dc63da14c42f693a04adc717" title="angle units e.g. RADIANS, DEG.">units</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#aecb5917f272296926d46e7c6c8de6761">units_</a>;}
<a name="l00064"></a>00064   <span class="comment">//: discontinuity azimuthal angle coordinates</span>
<a name="l00065"></a><a class="code" href="classbsta__spherical__histogram.html#acbb54811e51e58f2e3d1e16ddadb3681">00065</a>   <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> <a class="code" href="classbsta__spherical__histogram.html#acbb54811e51e58f2e3d1e16ddadb3681" title="discontinuity azimuthal angle coordinates.">azimuth_branch_cut</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#a9f137bed8fd24d9f1d82228ad603d8d1">az_branch_cut_</a>;}
<a name="l00066"></a>00066   <span class="comment">//: location of north and south poles on the sphere</span>
<a name="l00067"></a><a class="code" href="classbsta__spherical__histogram.html#ad2de530b487a2986da582a6ec69663c5">00067</a>   <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> <a class="code" href="classbsta__spherical__histogram.html#ad2de530b487a2986da582a6ec69663c5" title="location of north and south poles on the sphere.">elevation_poles</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#ae33ce1b2ca4ffb32257dbdd8b932ffac">el_poles_</a>;}
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="comment">//: number of bins allowed</span>
<a name="l00070"></a><a class="code" href="classbsta__spherical__histogram.html#a6d267866e0efab0bf072baa07b156bf7">00070</a>   <span class="keywordtype">unsigned</span> <a class="code" href="classbsta__spherical__histogram.html#a6d267866e0efab0bf072baa07b156bf7" title="number of bins allowed.">n_azimuth</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#a3051803ef66a762efc861dfbc3838b56" title="members.">n_azimuth_</a>;}
<a name="l00071"></a><a class="code" href="classbsta__spherical__histogram.html#a528716f42ef0a0a29c6fbba212ca0c9f">00071</a>   <span class="keywordtype">unsigned</span> <a class="code" href="classbsta__spherical__histogram.html#a528716f42ef0a0a29c6fbba212ca0c9f">n_elevation</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#aef2c1edf1f78e6161f0b0857f90e6e05">n_elevation_</a>;}
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <span class="comment">//: indices for individual spherical coordinates</span>
<a name="l00074"></a>00074   <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>(T azimuth) <span class="keyword">const</span>;
<a name="l00075"></a>00075   <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>(T elevation) <span class="keyword">const</span>;
<a name="l00076"></a>00076   <span class="comment">//: 1-d linear indices</span>
<a name="l00077"></a><a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561">00077</a>   <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561" title="1-d linear indices.">linear_index</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>, <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>)<span class="keyword"> const</span>
<a name="l00078"></a>00078 <span class="keyword">    </span>{<span class="keywordflow">return</span> elevation_index*<a class="code" href="classbsta__spherical__histogram.html#a3051803ef66a762efc861dfbc3838b56" title="members.">n_azimuth_</a> + <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>;}
<a name="l00079"></a>00079   <span class="comment">//: function name different since T could be int</span>
<a name="l00080"></a><a class="code" href="classbsta__spherical__histogram.html#af3e446547801718d46ad143d61dafa7b">00080</a>   <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#af3e446547801718d46ad143d61dafa7b" title="function name different since T could be int.">lin_index</a>(T azimuth, T elevation)
<a name="l00081"></a>00081     {<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561" title="1-d linear indices.">linear_index</a>(<a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>(azimuth), <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>(elevation));}
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   <span class="comment">//: azimuth bounds</span>
<a name="l00084"></a>00084   T <a class="code" href="classbsta__spherical__histogram.html#a2742b1a3fdfc7c509023dccbc27a41bc" title="azimuth bounds.">azimuth_start</a>() <span class="keyword">const</span>;
<a name="l00085"></a>00085   T <a class="code" href="classbsta__spherical__histogram.html#a237eb1b791307b3e4c52272eaefb52d0">azimuth_range</a>() <span class="keyword">const</span>;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <span class="comment">//: elevation bounds</span>
<a name="l00088"></a>00088   T <a class="code" href="classbsta__spherical__histogram.html#ae2f39598c5fa9fc8ec0c3673ed5d6702" title="elevation bounds.">elevation_start</a>() <span class="keyword">const</span>;
<a name="l00089"></a>00089   T <a class="code" href="classbsta__spherical__histogram.html#a5b6898b7d29e2e16ae177ccaef7e49ab">elevation_range</a>() <span class="keyword">const</span>;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a34936b95208f11c0188280781be8e6f4">azimuth_interval</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>, T&amp; <a class="code" href="classbsta__spherical__histogram.html#a2742b1a3fdfc7c509023dccbc27a41bc" title="azimuth bounds.">azimuth_start</a>, T&amp; <a class="code" href="classbsta__spherical__histogram.html#a237eb1b791307b3e4c52272eaefb52d0">azimuth_range</a>) <span class="keyword">const</span>;
<a name="l00092"></a><a class="code" href="classbsta__spherical__histogram.html#a9f7445bc4d401a62a42d06dac21ba842">00092</a>   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a9f7445bc4d401a62a42d06dac21ba842">azimuth_interval</a>(T azimuth, T&amp; <a class="code" href="classbsta__spherical__histogram.html#a2742b1a3fdfc7c509023dccbc27a41bc" title="azimuth bounds.">azimuth_start</a>, T&amp; <a class="code" href="classbsta__spherical__histogram.html#a237eb1b791307b3e4c52272eaefb52d0">azimuth_range</a>)<span class="keyword"> const </span>{
<a name="l00093"></a>00093     <span class="keywordtype">int</span> az_ind = <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>(azimuth);
<a name="l00094"></a>00094     <a class="code" href="classbsta__spherical__histogram.html#a34936b95208f11c0188280781be8e6f4">azimuth_interval</a>(az_ind, azimuth_start, azimuth_range);}
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#ac38a50270309271fae7ad009db0bfb08">elevation_interval</a>(<span class="keywordtype">int</span>  <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>,
<a name="l00097"></a>00097                           T&amp; <a class="code" href="classbsta__spherical__histogram.html#ae2f39598c5fa9fc8ec0c3673ed5d6702" title="elevation bounds.">elevation_start</a>, T&amp; <a class="code" href="classbsta__spherical__histogram.html#a5b6898b7d29e2e16ae177ccaef7e49ab">elevation_range</a>) <span class="keyword">const</span>;
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classbsta__spherical__histogram.html#a812a013e4272ee43b9a5b710859566a7">00099</a>   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a812a013e4272ee43b9a5b710859566a7">elevation_interval</a>(T elevation, T&amp; <a class="code" href="classbsta__spherical__histogram.html#ae2f39598c5fa9fc8ec0c3673ed5d6702" title="elevation bounds.">elevation_start</a>, T&amp; <a class="code" href="classbsta__spherical__histogram.html#a5b6898b7d29e2e16ae177ccaef7e49ab">elevation_range</a>)<span class="keyword"> const</span>{
<a name="l00100"></a>00100   <span class="keywordtype">int</span> el_ind = <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>(elevation);
<a name="l00101"></a>00101   <a class="code" href="classbsta__spherical__histogram.html#ac38a50270309271fae7ad009db0bfb08">elevation_interval</a>(el_ind, elevation_start, elevation_range);}
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   T <a class="code" href="classbsta__spherical__histogram.html#a1f8474ab0c851ab1e1657e811feb3168">azimuth_center</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>) <span class="keyword">const</span>;
<a name="l00104"></a>00104   T <a class="code" href="classbsta__spherical__histogram.html#a23bbcbddcb9adb18df356a45352e0df4">elevation_center</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>) <span class="keyword">const</span>;
<a name="l00105"></a>00105   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#ab659b1799e917c37f865415b176afda3">center</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561" title="1-d linear indices.">linear_index</a>, T&amp; az_center, T&amp; el_center);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="comment">//: increment the count in a given bin by mag</span>
<a name="l00108"></a>00108   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#aa0488310d1460f3051a99aea32aa7a09" title="increment the count in a given bin by mag.">upcount</a>(T azimuth, T elevation, T mag = T(1.0));
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="comment">//: weight the increment by spherical area of the bin, i.e. mag/sin(el)</span>
<a name="l00111"></a>00111   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a926e279b6ab9f57f3cbaadb40fd4299f" title="weight the increment by spherical area of the bin, i.e. mag/sin(el).">upcount_weighted_by_area</a>(T azimuth, T elevation, T mag = T(1.0));
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <span class="comment">//: counts in a specified bin</span>
<a name="l00114"></a><a class="code" href="classbsta__spherical__histogram.html#a9c146f1235f8553316dd381c434f21ce">00114</a>   T <a class="code" href="classbsta__spherical__histogram.html#a9c146f1235f8553316dd381c434f21ce" title="counts in a specified bin.">counts</a> (<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>, <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>) {
<a name="l00115"></a>00115     <span class="keywordflow">if</span> (azimuth_index&gt;=0&amp;&amp;azimuth_index&lt;=static_cast&lt;int&gt;(<a class="code" href="classbsta__spherical__histogram.html#a6d267866e0efab0bf072baa07b156bf7" title="number of bins allowed.">n_azimuth</a>())&amp;&amp;
<a name="l00116"></a>00116        elevation_index&gt;=0&amp;&amp;elevation_index&lt;=static_cast&lt;int&gt;(<a class="code" href="classbsta__spherical__histogram.html#a528716f42ef0a0a29c6fbba212ca0c9f">n_elevation</a>())) {
<a name="l00117"></a>00117       <span class="keywordtype">int</span> lidx = <a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561" title="1-d linear indices.">linear_index</a>(azimuth_index,elevation_index);
<a name="l00118"></a>00118       <span class="keywordflow">if</span> (<a class="code" href="classbsta__spherical__histogram.html#a54ef2bb915743dbb03336af21c6ad82e">counts_</a>[lidx])
<a name="l00119"></a>00119         <span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#a54ef2bb915743dbb03336af21c6ad82e">counts_</a>[lidx];
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121  <span class="keywordflow">return</span> T(0);
<a name="l00122"></a>00122   }
<a name="l00123"></a><a class="code" href="classbsta__spherical__histogram.html#a85473fc7558e5313e414633c26bde6ca">00123</a>   T <a class="code" href="classbsta__spherical__histogram.html#a85473fc7558e5313e414633c26bde6ca">counts</a>(T azimuth, T elevation)  {
<a name="l00124"></a>00124     <span class="keywordtype">int</span> az_ind = <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>(azimuth);
<a name="l00125"></a>00125     <span class="keywordtype">int</span> el_ind = <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>(elevation);
<a name="l00126"></a>00126     <span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#a9c146f1235f8553316dd381c434f21ce" title="counts in a specified bin.">counts</a>(az_ind, el_ind);
<a name="l00127"></a>00127   }
<a name="l00128"></a>00128 
<a name="l00129"></a><a class="code" href="classbsta__spherical__histogram.html#a220816dda77f6fe76bc127e15fe6e4a8">00129</a>   T <a class="code" href="classbsta__spherical__histogram.html#a220816dda77f6fe76bc127e15fe6e4a8">counts</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561" title="1-d linear indices.">linear_index</a>) {<span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#a54ef2bb915743dbb03336af21c6ad82e">counts_</a>[<a class="code" href="classbsta__spherical__histogram.html#ac73564a5af506262bf3edff58e349561" title="1-d linear indices.">linear_index</a>];}
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <span class="comment">//:total number of counts, cached so non-const</span>
<a name="l00132"></a>00132   T <a class="code" href="classbsta__spherical__histogram.html#a02ce4f9fe67af4198470551a848ccdf4" title="total number of counts, cached so non-const.">total_counts</a>();
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="comment">//: probability of a bin</span>
<a name="l00135"></a>00135   T <a class="code" href="classbsta__spherical__histogram.html#ac1af7b41faadcd79748707ebad9e2003" title="probability of a bin.">p</a>(<span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>, <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>) ;
<a name="l00136"></a><a class="code" href="classbsta__spherical__histogram.html#ade04922ecd271cea1c878292ee08e011">00136</a>   T <a class="code" href="classbsta__spherical__histogram.html#ac1af7b41faadcd79748707ebad9e2003" title="probability of a bin.">p</a>(T azimuth, T elevation)
<a name="l00137"></a>00137   {
<a name="l00138"></a>00138     <span class="keywordtype">int</span> az_ind = <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>(azimuth),el_ind = <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>(elevation);
<a name="l00139"></a>00139     <span class="keywordflow">return</span> <a class="code" href="classbsta__spherical__histogram.html#ac1af7b41faadcd79748707ebad9e2003" title="probability of a bin.">p</a>(az_ind, el_ind);
<a name="l00140"></a>00140   }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <span class="comment">//: mean of histogram distribution</span>
<a name="l00143"></a>00143   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a4091289c1c7b4be189c21e9e648a979a" title="mean of histogram distribution.">mean</a>(T&amp; mean_az, T&amp; mean_el);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <span class="comment">//: covariance matrix of histogram cvar = [(az-mu_az)][(az-mu_az) (el-mu_el)]</span>
<a name="l00146"></a>00146   <span class="comment">//                                        [(el-mu_el)]</span>
<a name="l00147"></a>00147   vnl_matrix_fixed&lt;T, 2, 2&gt; <a class="code" href="classbsta__spherical__histogram.html#ab5116c1963a5a69d8759841c7fdcffd4" title="covariance matrix of histogram cvar = [(az-mu_az)][(az-mu_az) (el-mu_el)].">covariance_matrix</a>();
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="comment">//: marginal standard deviations</span>
<a name="l00150"></a>00150   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a4c822c45f0f30ed866d8a11c26703a0e" title="marginal standard deviations.">std_dev</a>(T&amp; std_dev_az, T&amp; std_dev_el);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">//: linear index of bins which have centers lying inside the cone</span>
<a name="l00153"></a>00153   vcl_vector&lt;int&gt; <a class="code" href="classbsta__spherical__histogram.html#ab708d581ec54e5d4e501a7cf659e0ed5" title="linear index of bins which have centers lying inside the cone.">bins_intersecting_cone</a>(T center_az, T center_el,
<a name="l00154"></a>00154                                          T cone_half_angle);
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 
<a name="l00157"></a>00157   <span class="comment">//:unit conversions</span>
<a name="l00158"></a><a class="code" href="classbsta__spherical__histogram.html#a0df8d00d8bc87bfd864b2a1fd98e0c00">00158</a>   <span class="keyword">static</span> T <a class="code" href="classbsta__spherical__histogram.html#a0df8d00d8bc87bfd864b2a1fd98e0c00" title="unit conversions.">deg_to_rad</a>(T ang) {<span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(vnl_math::pi_over_180*ang);}
<a name="l00159"></a><a class="code" href="classbsta__spherical__histogram.html#a97de1b589f997b565b929d059e5e125b">00159</a>   <span class="keyword">static</span> T <a class="code" href="classbsta__spherical__histogram.html#a97de1b589f997b565b929d059e5e125b">rad_to_deg</a>(T ang) {<span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(vnl_math::deg_per_rad*ang);}
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <span class="comment">//:output of bin ranges and counts (zero counts not output)</span>
<a name="l00162"></a>00162   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a2313a985166ed72897a0fe05c2a48352" title="output of bin ranges and counts (zero counts not output).">write_counts_with_interval</a>(vcl_ostream&amp; os, <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>,
<a name="l00163"></a>00163                                   <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>);
<a name="l00164"></a>00164   <span class="comment">//:output of bin center and counts (zero counts not output)</span>
<a name="l00165"></a>00165   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#ab6b23c656b5eb93088279df623b126d4" title="output of bin center and counts (zero counts not output).">write_counts_with_center</a>(vcl_ostream&amp; os, <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a89c3119a6c464bce58a1625bd89027e9" title="indices for individual spherical coordinates.">azimuth_index</a>,
<a name="l00166"></a>00166                                 <span class="keywordtype">int</span> <a class="code" href="classbsta__spherical__histogram.html#a1ceb1664735c482336324f92fe09e2ae">elevation_index</a>);
<a name="l00167"></a>00167   <span class="comment">//: write bin centers (azimuth elevation) and non_zero counts to stream</span>
<a name="l00168"></a>00168   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a50cbe87a95fc3f136e0b4e0235cb9c58" title="write bin centers (azimuth elevation) and non_zero counts to stream.">print_to_text</a>(vcl_ostream&amp; os);
<a name="l00169"></a>00169 
<a name="l00170"></a>00170   <span class="comment">//: display counts in vrml with reference sphere</span>
<a name="l00171"></a>00171   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a2831d1d1842c691d295889476e134bd3" title="display counts in vrml with reference sphere.">print_to_vrml</a>(vcl_ostream&amp; os, T transparency = T(0));
<a name="l00172"></a>00172 
<a name="l00173"></a>00173   <span class="comment">//: convenient utilities</span>
<a name="l00174"></a>00174   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a6aa759c0f40435e3568dd5999717efeb" title="convenient utilities.">convert_to_cartesian</a>(T azimuth, T elevation, T&amp; x, T&amp; y, T&amp; z) <span class="keyword">const</span>;
<a name="l00175"></a>00175   <span class="keywordtype">void</span> <a class="code" href="classbsta__spherical__histogram.html#a6ab3d20df72a9618e3dfe879ad858bdf">convert_to_spherical</a>(T x, T y, T z, T&amp; azimuth, T&amp; elevation) <span class="keyword">const</span>;
<a name="l00176"></a>00176  <span class="keyword">private</span>:
<a name="l00177"></a>00177   <span class="comment">//: members</span>
<a name="l00178"></a><a class="code" href="classbsta__spherical__histogram.html#a3051803ef66a762efc861dfbc3838b56">00178</a>   <span class="keywordtype">unsigned</span> <a class="code" href="classbsta__spherical__histogram.html#a3051803ef66a762efc861dfbc3838b56" title="members.">n_azimuth_</a>;
<a name="l00179"></a><a class="code" href="classbsta__spherical__histogram.html#aef2c1edf1f78e6161f0b0857f90e6e05">00179</a>   <span class="keywordtype">unsigned</span> <a class="code" href="classbsta__spherical__histogram.html#aef2c1edf1f78e6161f0b0857f90e6e05">n_elevation_</a>;
<a name="l00180"></a><a class="code" href="classbsta__spherical__histogram.html#aa7a97178f329fb65e5c56b71d097ca57">00180</a>   T <a class="code" href="classbsta__spherical__histogram.html#aa7a97178f329fb65e5c56b71d097ca57">azimuth_start_</a>;
<a name="l00181"></a><a class="code" href="classbsta__spherical__histogram.html#a266aa3ea3ce75e16ba6eec32bac71277">00181</a>   T <a class="code" href="classbsta__spherical__histogram.html#a266aa3ea3ce75e16ba6eec32bac71277">azimuth_range_</a>;
<a name="l00182"></a><a class="code" href="classbsta__spherical__histogram.html#a4c78cd728bbc6a852e31f04bc599f3f5">00182</a>   T <a class="code" href="classbsta__spherical__histogram.html#a4c78cd728bbc6a852e31f04bc599f3f5">elevation_start_</a>;
<a name="l00183"></a><a class="code" href="classbsta__spherical__histogram.html#a908e8d5e77ed0a32aa5ba3e12745db77">00183</a>   T <a class="code" href="classbsta__spherical__histogram.html#a908e8d5e77ed0a32aa5ba3e12745db77">elevation_range_</a>;
<a name="l00184"></a><a class="code" href="classbsta__spherical__histogram.html#a22397508e037e81a927ff4d528133567">00184</a>   T <a class="code" href="classbsta__spherical__histogram.html#a22397508e037e81a927ff4d528133567">delta_az_</a>;
<a name="l00185"></a><a class="code" href="classbsta__spherical__histogram.html#a9e81bf7aa9b541ab006eafe12908eb91">00185</a>   T <a class="code" href="classbsta__spherical__histogram.html#a9e81bf7aa9b541ab006eafe12908eb91">delta_el_</a>;
<a name="l00186"></a><a class="code" href="classbsta__spherical__histogram.html#a9f137bed8fd24d9f1d82228ad603d8d1">00186</a>   <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> <a class="code" href="classbsta__spherical__histogram.html#a9f137bed8fd24d9f1d82228ad603d8d1">az_branch_cut_</a>;
<a name="l00187"></a><a class="code" href="classbsta__spherical__histogram.html#ae33ce1b2ca4ffb32257dbdd8b932ffac">00187</a>   <a class="code" href="classbsta__spherical__histogram.html#a77736dea340c597af1a80e43fed8d31b">angle_bounds</a> <a class="code" href="classbsta__spherical__histogram.html#ae33ce1b2ca4ffb32257dbdd8b932ffac">el_poles_</a>;
<a name="l00188"></a><a class="code" href="classbsta__spherical__histogram.html#aecb5917f272296926d46e7c6c8de6761">00188</a>   <a class="code" href="classbsta__spherical__histogram.html#a500546eb56ea9a41486362b88cf51051">ang_units</a> <a class="code" href="classbsta__spherical__histogram.html#aecb5917f272296926d46e7c6c8de6761">units_</a>;
<a name="l00189"></a><a class="code" href="classbsta__spherical__histogram.html#a1e2758347aeca3e1c74b708764e776e7">00189</a>   <span class="keywordtype">bool</span> <a class="code" href="classbsta__spherical__histogram.html#a1e2758347aeca3e1c74b708764e776e7">total_counts_valid_</a>;
<a name="l00190"></a><a class="code" href="classbsta__spherical__histogram.html#a73df1b3c9e29babdf44be36a8a161b3d">00190</a>   T <a class="code" href="classbsta__spherical__histogram.html#a73df1b3c9e29babdf44be36a8a161b3d">total_counts_</a>;
<a name="l00191"></a><a class="code" href="classbsta__spherical__histogram.html#a54ef2bb915743dbb03336af21c6ad82e">00191</a>   vcl_map&lt;int, T&gt; <a class="code" href="classbsta__spherical__histogram.html#a54ef2bb915743dbb03336af21c6ad82e">counts_</a>;
<a name="l00192"></a>00192 };
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">//: Write histogram to stream</span>
<a name="l00195"></a>00195 <span class="comment">// \relatesalso bsta_spherical_histogram</span>
<a name="l00196"></a>00196 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00197"></a>00197 vcl_ostream&amp;  operator&lt;&lt;(vcl_ostream&amp; s, bsta_spherical_histogram&lt;T&gt; <span class="keyword">const</span>&amp; h);
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">//: Read histogram from stream</span>
<a name="l00200"></a>00200 <span class="comment">// \relatesalso bsta_spherical_histogram</span>
<a name="l00201"></a>00201 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00202"></a>00202 vcl_istream&amp;  <a class="code" href="classbsta__histogram.html#a010dd42fa4b1cee167105abf18551630" title="Read histogram from stream.">operator&gt;&gt;</a>(vcl_istream&amp; is,  <a class="code" href="classbsta__spherical__histogram.html" title="A histogram on the unit sphere.">bsta_spherical_histogram&lt;T&gt;</a>&amp; h);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <span class="preprocessor">#endif // bsta_spherical_histogram_h_</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:38:51 for contrib/brl/bbas/bsta by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
