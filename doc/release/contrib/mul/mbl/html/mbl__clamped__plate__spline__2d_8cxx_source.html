<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>contrib/mul/mbl/mbl_clamped_plate_spline_2d.cxx Source File</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>
<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">contrib/mul/mbl/mbl_clamped_plate_spline_2d.cxx</div>  </div>
</div>
<div class="contents">
<a href="mbl__clamped__plate__spline__2d_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is mul/mbl/mbl_clamped_plate_spline_2d.cxx</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &quot;<a class="code" href="mbl__clamped__plate__spline__2d_8h.html" title="Construct clamped plate spline to map 2D to 2D.">mbl_clamped_plate_spline_2d.h</a>&quot;</span>
<a name="l00003"></a>00003 <span class="comment">//:</span>
<a name="l00004"></a>00004 <span class="comment">// \file</span>
<a name="l00005"></a>00005 <span class="comment">// \brief Construct thin plate spline to map 2D to 2D</span>
<a name="l00006"></a>00006 <span class="comment">// \author Tim Cootes</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;vcl_cmath.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;vcl_cassert.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;vcl_cstdlib.h&gt;</span> <span class="comment">// for vcl_abort()</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/vsl__indent_8h.html">vsl/vsl_indent.h</a>&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/vsl__vector__io_8h.html">vsl/vsl_vector_io.h</a>&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__svd_8h.html">vnl/algo/vnl_svd.h</a>&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;<a class="code" href="mbl__matxvec_8h.html" title="Various specialised versions of simple linear algebra operators.">mbl/mbl_matxvec.h</a>&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__io__vector_8h.html">vnl/io/vnl_io_vector.h</a>&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__io__matrix_8h.html">vnl/io/vnl_io_matrix.h</a>&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/vgl__io__point__2d_8h.html">vgl/io/vgl_io_point_2d.h</a>&gt;</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">//=======================================================================</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="comment">//=======================================================================</span>
<a name="l00022"></a>00022 <span class="comment">// Dflt ctor</span>
<a name="l00023"></a>00023 <span class="comment">// Default constructor gives identity mapping</span>
<a name="l00024"></a>00024 <span class="comment">//=======================================================================</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a5278c37186d5e3a03fe9fde4d1652a02">00026</a> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a5278c37186d5e3a03fe9fde4d1652a02" title="Dflt ctor.">mbl_clamped_plate_spline_2d::mbl_clamped_plate_spline_2d</a>()
<a name="l00027"></a>00027   : Wx_(0),Wy_(0)
<a name="l00028"></a>00028 {
<a name="l00029"></a>00029 }
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">//=======================================================================</span>
<a name="l00032"></a>00032 <span class="comment">// Destructor</span>
<a name="l00033"></a>00033 <span class="comment">//=======================================================================</span>
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#aec34a3a5527e799d9ed9cb1c456fdaf1">00035</a> <a class="code" href="classmbl__clamped__plate__spline__2d.html#aec34a3a5527e799d9ed9cb1c456fdaf1" title="Destructor.">mbl_clamped_plate_spline_2d::~mbl_clamped_plate_spline_2d</a>()
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">//: Check that all points are inside unit circle</span>
<a name="l00040"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a6804490bfa11fd91e85fb7fa3075d1a2">00040</a> <span class="keywordtype">bool</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a6804490bfa11fd91e85fb7fa3075d1a2" title="Check that all points are inside unit circle.">mbl_clamped_plate_spline_2d::all_in_unit_circle</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; pts)
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042   <span class="keywordtype">int</span> n = pts.size();
<a name="l00043"></a>00043   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> *p = &amp;pts[0];
<a name="l00044"></a>00044   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;++i)
<a name="l00045"></a>00045   {
<a name="l00046"></a>00046     <span class="keywordflow">if</span> (p[i].x()*p[i].x()+p[i].y()*p[i].y()&gt;1.0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00047"></a>00047   }
<a name="l00048"></a>00048 
<a name="l00049"></a>00049   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">//: Green&#39;s function for the clamped plate spline</span>
<a name="l00053"></a>00053 <span class="comment">//  0.5*|x-y|^2(A2-log(A2)-1)  where A2 = (|x|^2|y|^2-2x.y+1)/|x-y|^2</span>
<a name="l00054"></a>00054 <span class="comment">//  If two points are x and y</span>
<a name="l00055"></a><a class="code" href="mbl__clamped__plate__spline__2d_8cxx.html#a8b156f1031fc55dc3d72f5a99c8a63b7">00055</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="mbl__clamped__plate__spline__2d_8cxx.html#a8b156f1031fc55dc3d72f5a99c8a63b7" title="Green&#39;s function for the clamped plate spline.">cps_green</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a>&amp;  p1, <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a>&amp; p2)
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057   <span class="keywordtype">double</span> dx = p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>()-p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>();
<a name="l00058"></a>00058   <span class="keywordtype">double</span> dy = p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>()-p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00059"></a>00059   <span class="keywordtype">double</span> d2 = (dx*dx+dy*dy);
<a name="l00060"></a>00060   <span class="keywordflow">if</span> (d2&lt;1e-8)   <span class="keywordflow">return</span> 0.5;  <span class="comment">// Avoid numeric instability near zero</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <span class="keywordtype">double</span> L1 = p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() * p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() + p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>() * p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00063"></a>00063   <span class="keywordtype">double</span> L2 = p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() + p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>() * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00064"></a>00064   <span class="keywordtype">double</span> d  = p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() + p1.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>() * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();  <span class="comment">// Dot product</span>
<a name="l00065"></a>00065   <span class="keywordtype">double</span> A2 = (L1*L2-2*d+1)/d2;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   <span class="keywordflow">return</span> 0.5*d2*(A2-vcl_log(A2)-1);
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">//: Green&#39;s function for the clamped plate spline</span>
<a name="l00071"></a>00071 <span class="comment">//  0.5*|x-y|^2(A2-log(A2)-1)  where A2 = (|x|^2|y|^2-2x.y+1)/|x-y|^2</span>
<a name="l00072"></a>00072 <span class="comment">//  If two points are x and y</span>
<a name="l00073"></a><a class="code" href="mbl__clamped__plate__spline__2d_8cxx.html#a7439681c84577922f5321c02840e3a07">00073</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="mbl__clamped__plate__spline__2d_8cxx.html#a8b156f1031fc55dc3d72f5a99c8a63b7" title="Green&#39;s function for the clamped plate spline.">cps_green</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a>&amp; p2)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075   <span class="keywordtype">double</span> dx = x-p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>();
<a name="l00076"></a>00076   <span class="keywordtype">double</span> dy = y-p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00077"></a>00077   <span class="keywordtype">double</span> d2 = (dx*dx+dy*dy);
<a name="l00078"></a>00078   <span class="keywordflow">if</span> (d2&lt;1e-8)   <span class="keywordflow">return</span> 0.5;  <span class="comment">// Avoid numeric instability near zero</span>
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordtype">double</span> L1 = x * x + y * y;
<a name="l00081"></a>00081   <span class="keywordtype">double</span> L2 = p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() + p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>() * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00082"></a>00082   <span class="keywordtype">double</span> d  = x * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>() + y * p2.<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();  <span class="comment">// Dot product</span>
<a name="l00083"></a>00083   <span class="keywordtype">double</span> A2 = (L1*L2-2*d+1)/d2;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085   <span class="keywordflow">return</span> 0.5*d2*(A2-vcl_log(A2)-1);
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="comment">// Sets L to be a symmetric square matrix of size n x n (n = pts.nelems)</span>
<a name="l00089"></a>00089 <span class="comment">// with L(i,j) = cps_green(pts[i],pts[j])</span>
<a name="l00090"></a>00090 <span class="keyword">static</span> <span class="keywordtype">void</span> build_L(<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a>&amp; L,
<a name="l00091"></a>00091                     <span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; pts)
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = pts.size();
<a name="l00094"></a>00094   <span class="keywordflow">if</span> ( (L.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html#a840b1c4c74689f19b0496d476c5cc2d7">rows</a>()!=n) || (L.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html#a4a7d869d8750ba5056f6c6551575fa23">columns</a>()!=n) ) L.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html#a1fa1949e6219d0db6e3ad50a32d7e1e0">set_size</a>(n,n);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> * pts_data = &amp;pts[0];
<a name="l00097"></a>00097   <span class="keywordtype">double</span>** K_data = L.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html#a389a842b86be1cad2876db394319f1de">data_array</a>();
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="comment">// Set the diagonal</span>
<a name="l00100"></a>00100   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l00101"></a>00101     K_data[i][i] = 0.5;
<a name="l00102"></a>00102     <span class="comment">// Now fill upper &amp; lower triangles</span>
<a name="l00103"></a>00103   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=1;i&lt;n;i++)
<a name="l00104"></a>00104     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0;j&lt;i;j++)
<a name="l00105"></a>00105     {
<a name="l00106"></a>00106       K_data[i][j] = K_data[j][i] = <a class="code" href="mbl__clamped__plate__spline__2d_8cxx.html#a8b156f1031fc55dc3d72f5a99c8a63b7" title="Green&#39;s function for the clamped plate spline.">cps_green</a>(pts_data[i],pts_data[j]);
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">//: Set parameters from vectors</span>
<a name="l00111"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a63275559124dad59b1536f4a48e03a6b">00111</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a63275559124dad59b1536f4a48e03a6b" title="Set parameters from vectors.">mbl_clamped_plate_spline_2d::set_params</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a>&amp; Wx,
<a name="l00112"></a>00112                                              <span class="keyword">const</span> <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a>&amp; Wy)
<a name="l00113"></a>00113 {
<a name="l00114"></a>00114   <a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a> = Wx;
<a name="l00115"></a>00115   <a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a> = Wy;
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#ae248678a42217137eb2b6cdbd42d3668">00118</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#ae248678a42217137eb2b6cdbd42d3668">mbl_clamped_plate_spline_2d::set_up_rhs</a>(<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a>&amp; Bx,
<a name="l00119"></a>00119                                              <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a>&amp; By,
<a name="l00120"></a>00120                                              <span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; src_pts,
<a name="l00121"></a>00121                                              <span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; dest_pts)
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123   <span class="keywordtype">int</span> n =dest_pts.size();
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   Bx.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#ae34b3cfb08e104f2ac81a74dc91537cc">set_size</a>(n);
<a name="l00126"></a>00126   By.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#ae34b3cfb08e104f2ac81a74dc91537cc">set_size</a>(n);
<a name="l00127"></a>00127   <span class="keywordtype">double</span>* Bx_data=Bx.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>();
<a name="l00128"></a>00128   <span class="keywordtype">double</span>* By_data=By.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>();
<a name="l00129"></a>00129   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a>  *d_pts_data=&amp;dest_pts[0];
<a name="l00130"></a>00130   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a>  *s_pts_data=&amp;src_pts[0];
<a name="l00131"></a>00131 
<a name="l00132"></a>00132   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l00133"></a>00133   {
<a name="l00134"></a>00134     Bx_data[i] = d_pts_data[i].<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>()-s_pts_data[i].<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a3d0455536dcb130f284c3eeaba1ae960">x</a>();
<a name="l00135"></a>00135     By_data[i] = d_pts_data[i].<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>()-s_pts_data[i].<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html#a25dfe52017f7614103d028639125ff91">y</a>();
<a name="l00136"></a>00136   }
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a60aaa4e347d9aae6a32723397d2da5db">00139</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a60aaa4e347d9aae6a32723397d2da5db" title="Sets up internal transformation to map source_pts onto dest_pts.">mbl_clamped_plate_spline_2d::build</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; source_pts,
<a name="l00140"></a>00140                                         <span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; dest_pts)
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142   assert(<a class="code" href="classmbl__clamped__plate__spline__2d.html#a6804490bfa11fd91e85fb7fa3075d1a2" title="Check that all points are inside unit circle.">all_in_unit_circle</a>(source_pts));
<a name="l00143"></a>00143   assert(<a class="code" href="classmbl__clamped__plate__spline__2d.html#a6804490bfa11fd91e85fb7fa3075d1a2" title="Check that all points are inside unit circle.">all_in_unit_circle</a>(dest_pts));
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=source_pts.size();
<a name="l00146"></a>00146   <span class="keywordflow">if</span> (dest_pts.size() != n)
<a name="l00147"></a>00147   {
<a name="l00148"></a>00148     vcl_cerr&lt;&lt;<span class="stringliteral">&quot;mbl_clamped_plate_spline_2d::build - incompatible number of points.\n&quot;</span>;
<a name="l00149"></a>00149     vcl_abort();
<a name="l00150"></a>00150   }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <a class="code" href="classmbl__clamped__plate__spline__2d.html#a691b36180974326452489835d8d3800f" title="Used to estimate weights in set_source_points().">L_inv_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html#a1fa1949e6219d0db6e3ad50a32d7e1e0">set_size</a>(0,0);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154   <a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a> = source_pts;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a> L;
<a name="l00157"></a>00157   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a> Bx(n);  <span class="comment">// Used to compute X parameters</span>
<a name="l00158"></a>00158   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a> By(n);  <span class="comment">// Used to compute Y parameters</span>
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#ae34b3cfb08e104f2ac81a74dc91537cc">set_size</a>(n);
<a name="l00161"></a>00161   <a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#ae34b3cfb08e104f2ac81a74dc91537cc">set_size</a>(n);
<a name="l00162"></a>00162 
<a name="l00163"></a>00163   build_L(L,source_pts);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165   <a class="code" href="classmbl__clamped__plate__spline__2d.html#ae248678a42217137eb2b6cdbd42d3668">set_up_rhs</a>(Bx,By,source_pts,dest_pts);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167   <span class="comment">// Solve LW = B for W1 and W2 :</span>
<a name="l00168"></a>00168   <span class="comment">// Note that both Cholesky and QR decompositions fail, apparently because of the</span>
<a name="l00169"></a>00169   <span class="comment">// zeroes on the diagonal.  Use SVD to be safe.</span>
<a name="l00170"></a>00170   {
<a name="l00171"></a>00171     <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html">vnl_svd&lt;double&gt;</a> svd(L);
<a name="l00172"></a>00172     svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#ac2cbab9e5659cebda7829337d285fbcc">solve</a>(Bx.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>(),<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>());
<a name="l00173"></a>00173     svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#ac2cbab9e5659cebda7829337d285fbcc">solve</a>(By.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>(),<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>());
<a name="l00174"></a>00174   }
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">//: Define source point positions</span>
<a name="l00178"></a>00178 <span class="comment">//  Performs pre-computations so that build(dest_points) can be</span>
<a name="l00179"></a>00179 <span class="comment">//  called multiple times efficiently</span>
<a name="l00180"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a23997c0f4a49347d762d96645a417e20">00180</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a23997c0f4a49347d762d96645a417e20" title="Define source point positions.">mbl_clamped_plate_spline_2d::set_source_pts</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; source_pts)
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182   assert(<a class="code" href="classmbl__clamped__plate__spline__2d.html#a6804490bfa11fd91e85fb7fa3075d1a2" title="Check that all points are inside unit circle.">all_in_unit_circle</a>(source_pts));
<a name="l00183"></a>00183 
<a name="l00184"></a>00184   <a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a> = source_pts;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__matrix.html">vnl_matrix&lt;double&gt;</a> L;
<a name="l00187"></a>00187   build_L(L,source_pts);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189   <span class="comment">// Compute inverse of L</span>
<a name="l00190"></a>00190   <span class="comment">// Note that both Cholesky and QR decompositions fail, apparently because of the</span>
<a name="l00191"></a>00191   <span class="comment">// zeroes on the diagonal.  Use SVD to be safe.</span>
<a name="l00192"></a>00192   {
<a name="l00193"></a>00193     <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html">vnl_svd&lt;double&gt;</a> svd(L);
<a name="l00194"></a>00194     <a class="code" href="classmbl__clamped__plate__spline__2d.html#a691b36180974326452489835d8d3800f" title="Used to estimate weights in set_source_points().">L_inv_</a> = svd.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__svd.html#aca07308f7241e6a981813dddb8a8d3cb">inverse</a>();
<a name="l00195"></a>00195   }
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="comment">//: Sets up internal transformation to map source_pts onto dest_pts</span>
<a name="l00199"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a3ca9378d2529365fbd8c4461cf1e97c3">00199</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a60aaa4e347d9aae6a32723397d2da5db" title="Sets up internal transformation to map source_pts onto dest_pts.">mbl_clamped_plate_spline_2d::build</a>(<span class="keyword">const</span> vcl_vector&lt;<a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> &gt;&amp; dest_pts)
<a name="l00200"></a>00200 {
<a name="l00201"></a>00201   assert(<a class="code" href="classmbl__clamped__plate__spline__2d.html#a6804490bfa11fd91e85fb7fa3075d1a2" title="Check that all points are inside unit circle.">all_in_unit_circle</a>(dest_pts));
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=<a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a>.size();
<a name="l00204"></a>00204   <span class="keywordflow">if</span> (dest_pts.size() != n)
<a name="l00205"></a>00205   {
<a name="l00206"></a>00206     vcl_cerr&lt;&lt;<span class="stringliteral">&quot;mbl_clamped_plate_spline_2d::build - incompatible number of points.\n&quot;</span>;
<a name="l00207"></a>00207     vcl_abort();
<a name="l00208"></a>00208   }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a> Bx(n);  <span class="comment">// Used to compute X parameters</span>
<a name="l00211"></a>00211   <a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html">vnl_vector&lt;double&gt;</a> By(n);  <span class="comment">// Used to compute Y parameters</span>
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#ae34b3cfb08e104f2ac81a74dc91537cc">set_size</a>(n);
<a name="l00214"></a>00214   <a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#ae34b3cfb08e104f2ac81a74dc91537cc">set_size</a>(n);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <a class="code" href="classmbl__clamped__plate__spline__2d.html#ae248678a42217137eb2b6cdbd42d3668">set_up_rhs</a>(Bx,By,<a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a>,dest_pts);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <a class="code" href="mbl__matxvec_8cxx.html#a42719819e30a38f9be50dff5f7006817" title="Compute R = M*V.">mbl_matxvec_prod_mv</a>(<a class="code" href="classmbl__clamped__plate__spline__2d.html#a691b36180974326452489835d8d3800f" title="Used to estimate weights in set_source_points().">L_inv_</a>,Bx,<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>);
<a name="l00219"></a>00219   <a class="code" href="mbl__matxvec_8cxx.html#a42719819e30a38f9be50dff5f7006817" title="Compute R = M*V.">mbl_matxvec_prod_mv</a>(<a class="code" href="classmbl__clamped__plate__spline__2d.html#a691b36180974326452489835d8d3800f" title="Used to estimate weights in set_source_points().">L_inv_</a>,By,<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>);
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a3939fe3cede937eb1229cc6d397596d3">00223</a> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a3939fe3cede937eb1229cc6d397596d3" title="Return transformed version of (x,y).">mbl_clamped_plate_spline_2d::operator()</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)<span class="keyword"> const</span>
<a name="l00224"></a>00224 <span class="keyword"></span>{
<a name="l00225"></a>00225   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = <a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a>.size();
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="keywordtype">double</span> x_sum = x;
<a name="l00228"></a>00228   <span class="keywordtype">double</span> y_sum = y;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="keyword">const</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a> * pts_data = &amp;<a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a>[0];
<a name="l00231"></a>00231   <span class="keyword">const</span> <span class="keywordtype">double</span>* Wx_data = <a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>();
<a name="l00232"></a>00232   <span class="keyword">const</span> <span class="keywordtype">double</span>* Wy_data = <a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a672822d3a059ac09909cb32a7be004a9">data_block</a>();
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;n;i++)
<a name="l00235"></a>00235   {
<a name="l00236"></a>00236     <span class="keywordtype">double</span> Ui = <a class="code" href="mbl__clamped__plate__spline__2d_8cxx.html#a8b156f1031fc55dc3d72f5a99c8a63b7" title="Green&#39;s function for the clamped plate spline.">cps_green</a>(x,y,pts_data[i]);
<a name="l00237"></a>00237     x_sum += (Ui * Wx_data[i]);
<a name="l00238"></a>00238     y_sum += (Ui * Wy_data[i]);
<a name="l00239"></a>00239   }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="keywordflow">return</span> <a class="codeRef" doxygen="core_vgl.tag:../../../../core/vgl/html" href="../../../../core/vgl/html/classvgl__point__2d.html">vgl_point_2d&lt;double&gt;</a>(x_sum,y_sum);
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">//=======================================================================</span>
<a name="l00245"></a>00245 <span class="comment">// Method: version_no</span>
<a name="l00246"></a>00246 <span class="comment">//=======================================================================</span>
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a53e1fdce5d4f0668d24fc68a222013e4">00248</a> <span class="keywordtype">short</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a53e1fdce5d4f0668d24fc68a222013e4" title="Version number for I/O.">mbl_clamped_plate_spline_2d::version_no</a>()<span class="keyword"> const</span>
<a name="l00249"></a>00249 <span class="keyword"></span>{
<a name="l00250"></a>00250   <span class="keywordflow">return</span> 1;
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">//=======================================================================</span>
<a name="l00255"></a>00255 <span class="comment">// Method: print</span>
<a name="l00256"></a>00256 <span class="comment">//=======================================================================</span>
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="comment">// required if data is present in this class</span>
<a name="l00259"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a7d62a4b3f40489032c6442f8dfb0d19a">00259</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a7d62a4b3f40489032c6442f8dfb0d19a" title="Print class to os.">mbl_clamped_plate_spline_2d::print_summary</a>(vcl_ostream&amp; os)<span class="keyword"> const</span>
<a name="l00260"></a>00260 <span class="keyword"></span>{
<a name="l00261"></a>00261   os&lt;&lt;<span class="stringliteral">&quot;\nfx:&quot;</span>;
<a name="l00262"></a>00262   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a11191c91a1dbb4e1d8423dad8b110712">size</a>();++i)
<a name="l00263"></a>00263     os&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>[i];
<a name="l00264"></a>00264   os&lt;&lt;<span class="stringliteral">&quot;\nfy:&quot;</span>;
<a name="l00265"></a>00265   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>.<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/classvnl__vector.html#a11191c91a1dbb4e1d8423dad8b110712">size</a>();++i)
<a name="l00266"></a>00266     os&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>[i];
<a name="l00267"></a>00267   os&lt;&lt;<span class="charliteral">&#39;\n&#39;</span>;
<a name="l00268"></a>00268 }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="comment">//=======================================================================</span>
<a name="l00271"></a>00271 <span class="comment">// Method: save</span>
<a name="l00272"></a>00272 <span class="comment">//=======================================================================</span>
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="comment">// required if data is present in this class</span>
<a name="l00275"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a99700984451dcb51ef57527b5bdbdfeb">00275</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a99700984451dcb51ef57527b5bdbdfeb" title="Save class to binary file stream.">mbl_clamped_plate_spline_2d::b_write</a>(<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/classvsl__b__ostream.html">vsl_b_ostream</a>&amp; bfs)<span class="keyword"> const</span>
<a name="l00276"></a>00276 <span class="keyword"></span>{
<a name="l00277"></a>00277   <a class="code" href="mbl__ar__process_8h.html#a1afb81d06bfe191543cbf6d3dde1947e" title="Write to binary stream.">vsl_b_write</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#a53e1fdce5d4f0668d24fc68a222013e4" title="Version number for I/O.">version_no</a>());
<a name="l00278"></a>00278   <a class="code" href="mbl__ar__process_8h.html#a1afb81d06bfe191543cbf6d3dde1947e" title="Write to binary stream.">vsl_b_write</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>); <a class="code" href="mbl__ar__process_8h.html#a1afb81d06bfe191543cbf6d3dde1947e" title="Write to binary stream.">vsl_b_write</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>);
<a name="l00279"></a>00279   <a class="code" href="mbl__ar__process_8h.html#a1afb81d06bfe191543cbf6d3dde1947e" title="Write to binary stream.">vsl_b_write</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a>);
<a name="l00280"></a>00280   <a class="code" href="mbl__ar__process_8h.html#a1afb81d06bfe191543cbf6d3dde1947e" title="Write to binary stream.">vsl_b_write</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#a691b36180974326452489835d8d3800f" title="Used to estimate weights in set_source_points().">L_inv_</a>);
<a name="l00281"></a>00281 }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">//=======================================================================</span>
<a name="l00284"></a>00284 <span class="comment">// Method: load</span>
<a name="l00285"></a>00285 <span class="comment">//=======================================================================</span>
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="comment">// required if data is present in this class</span>
<a name="l00288"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a77f2dcc65632628603d29c22424281f1">00288</a> <span class="keywordtype">void</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a77f2dcc65632628603d29c22424281f1" title="Load class from binary file stream.">mbl_clamped_plate_spline_2d::b_read</a>(<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/classvsl__b__istream.html">vsl_b_istream</a>&amp; bfs)
<a name="l00289"></a>00289 {
<a name="l00290"></a>00290   <span class="keywordflow">if</span> (!bfs) <span class="keywordflow">return</span>;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292   <span class="keywordtype">short</span> version;
<a name="l00293"></a>00293   <a class="code" href="mbl__ar__process_8h.html#a72b0dbf646fdd067c816dcf41137ce8b" title="Read data from binary stream.">vsl_b_read</a>(bfs,version);
<a name="l00294"></a>00294   <span class="keywordflow">switch</span> (version)
<a name="l00295"></a>00295   {
<a name="l00296"></a>00296     <span class="keywordflow">case</span> (1):
<a name="l00297"></a>00297       <a class="code" href="mbl__ar__process_8h.html#a72b0dbf646fdd067c816dcf41137ce8b" title="Read data from binary stream.">vsl_b_read</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>);
<a name="l00298"></a>00298       <a class="code" href="mbl__ar__process_8h.html#a72b0dbf646fdd067c816dcf41137ce8b" title="Read data from binary stream.">vsl_b_read</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>);
<a name="l00299"></a>00299       <a class="code" href="mbl__ar__process_8h.html#a72b0dbf646fdd067c816dcf41137ce8b" title="Read data from binary stream.">vsl_b_read</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#a20ba68538286103b5fd94f567d245d96">src_pts_</a>);
<a name="l00300"></a>00300       <a class="code" href="mbl__ar__process_8h.html#a72b0dbf646fdd067c816dcf41137ce8b" title="Read data from binary stream.">vsl_b_read</a>(bfs,<a class="code" href="classmbl__clamped__plate__spline__2d.html#a691b36180974326452489835d8d3800f" title="Used to estimate weights in set_source_points().">L_inv_</a>);
<a name="l00301"></a>00301       <span class="keywordflow">break</span>;
<a name="l00302"></a>00302     <span class="keywordflow">default</span>:
<a name="l00303"></a>00303       vcl_cerr &lt;&lt; <span class="stringliteral">&quot;I/O ERROR: vsl_b_read(vsl_b_istream&amp;, mbl_clamped_plate_spline_2d &amp;)\n&quot;</span>
<a name="l00304"></a>00304                &lt;&lt; <span class="stringliteral">&quot;           Unknown version number &quot;</span>&lt;&lt; version &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00305"></a>00305       bfs.<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/classvsl__b__istream.html#a413bd96d4f02499d101f7e4f3724f051">is</a>().clear(vcl_ios::badbit); <span class="comment">// Set an unrecoverable IO error on stream</span>
<a name="l00306"></a>00306   }
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 <span class="comment">//: Comparison operator</span>
<a name="l00310"></a><a class="code" href="classmbl__clamped__plate__spline__2d.html#a0148bb55efb9a6af2a0c824bd8c970b7">00310</a> <span class="keywordtype">bool</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html#a0148bb55efb9a6af2a0c824bd8c970b7" title="Comparison operator.">mbl_clamped_plate_spline_2d::operator==</a>(<span class="keyword">const</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html" title="Construct clamped plate spline to map 2D points in unit disk.">mbl_clamped_plate_spline_2d</a>&amp; tps)<span class="keyword"> const</span>
<a name="l00311"></a>00311 <span class="keyword"></span>{
<a name="l00312"></a>00312   <span class="keywordflow">if</span> (&amp;tps==<span class="keyword">this</span>) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00313"></a>00313   <span class="keywordflow">if</span> (<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__vector_8h.html#ad0fc1fd5987e1d8bbb473553e747218e">vnl_vector_ssd</a>(<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>,tps.<a class="code" href="classmbl__clamped__plate__spline__2d.html#aca5ab01dfa4bfa04dddacbef6e56e265">Wx_</a>)&gt;1e-6) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00314"></a>00314   <span class="keywordflow">if</span> (<a class="codeRef" doxygen="core_vnl.tag:../../../../core/vnl/html" href="../../../../core/vnl/html/vnl__vector_8h.html#ad0fc1fd5987e1d8bbb473553e747218e">vnl_vector_ssd</a>(<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>,tps.<a class="code" href="classmbl__clamped__plate__spline__2d.html#aa5bb25bfbf6c5aa8bc9d34865e1c47e7">Wy_</a>)&gt;1e-6) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00315"></a>00315   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00316"></a>00316 }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">//=======================================================================</span>
<a name="l00319"></a>00319 <span class="comment">// Associated function: operator&lt;&lt;</span>
<a name="l00320"></a>00320 <span class="comment">//=======================================================================</span>
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="mbl__clamped__plate__spline__2d_8h.html#a95324219603b6e43308606540d76dc4e">00322</a> <span class="keywordtype">void</span> <a class="code" href="mbl__ar__process_8h.html#a1afb81d06bfe191543cbf6d3dde1947e" title="Write to binary stream.">vsl_b_write</a>(<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/classvsl__b__ostream.html">vsl_b_ostream</a>&amp; bfs, <span class="keyword">const</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html" title="Construct clamped plate spline to map 2D points in unit disk.">mbl_clamped_plate_spline_2d</a>&amp; b)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324     b.<a class="code" href="classmbl__clamped__plate__spline__2d.html#a99700984451dcb51ef57527b5bdbdfeb" title="Save class to binary file stream.">b_write</a>(bfs);
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 <span class="comment">//=======================================================================</span>
<a name="l00328"></a>00328 <span class="comment">// Associated function: operator&gt;&gt;</span>
<a name="l00329"></a>00329 <span class="comment">//=======================================================================</span>
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="mbl__clamped__plate__spline__2d_8h.html#a9d8cba34d5ed77ced81d91e9ec948274">00331</a> <span class="keywordtype">void</span> <a class="code" href="mbl__ar__process_8h.html#a72b0dbf646fdd067c816dcf41137ce8b" title="Read data from binary stream.">vsl_b_read</a>(<a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/classvsl__b__istream.html">vsl_b_istream</a>&amp; bfs, <a class="code" href="classmbl__clamped__plate__spline__2d.html" title="Construct clamped plate spline to map 2D points in unit disk.">mbl_clamped_plate_spline_2d</a>&amp; b)
<a name="l00332"></a>00332 {
<a name="l00333"></a>00333     b.<a class="code" href="classmbl__clamped__plate__spline__2d.html#a77f2dcc65632628603d29c22424281f1" title="Load class from binary file stream.">b_read</a>(bfs);
<a name="l00334"></a>00334 }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 <span class="comment">//=======================================================================</span>
<a name="l00337"></a>00337 <span class="comment">// Associated function: operator&lt;&lt;</span>
<a name="l00338"></a>00338 <span class="comment">//=======================================================================</span>
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="mbl__clamped__plate__spline__2d_8h.html#ac92ff3cb7074667b39ae7cd88db2e563">00340</a> vcl_ostream&amp; <a class="code" href="mbl__chord_8h.html#a0f668c81793e2f6897a3b8a54fc61dec" title="Print.">operator&lt;&lt;</a>(vcl_ostream&amp; os,<span class="keyword">const</span> <a class="code" href="classmbl__clamped__plate__spline__2d.html" title="Construct clamped plate spline to map 2D points in unit disk.">mbl_clamped_plate_spline_2d</a>&amp; b)
<a name="l00341"></a>00341 {
<a name="l00342"></a>00342   os &lt;&lt; <span class="stringliteral">&quot;mbl_clamped_plate_spline_2d: &quot;</span>;
<a name="l00343"></a>00343   <a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/vsl__indent_8cxx.html#a7752e120d8c66b368d428e1e3313662f">vsl_indent_inc</a>(os);
<a name="l00344"></a>00344   b.<a class="code" href="classmbl__clamped__plate__spline__2d.html#a7d62a4b3f40489032c6442f8dfb0d19a" title="Print class to os.">print_summary</a>(os);
<a name="l00345"></a>00345   <a class="codeRef" doxygen="core_vsl.tag:../../../../core/vsl/html" href="../../../../core/vsl/html/vsl__indent_8cxx.html#aabb0c2ec398423f6815a3b3ebc8f978b">vsl_indent_dec</a>(os);
<a name="l00346"></a>00346   <span class="keywordflow">return</span> os;
<a name="l00347"></a>00347 }
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 1 2013 17:33:12 for contrib/mul/mbl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
